!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,(e.Uncharted||(e.Uncharted={})).Thumbnails=t()}}(function(){var t,e,n;return function r(t,e,n){function i(s,a){if(!e[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=e[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return i(n?n:e)},u,u.exports,r,t,e,n)}return e[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,n,r){(function(e,i){!function(e){if("object"==typeof r&&"undefined"!=typeof n)n.exports=e();else if("function"==typeof t&&t.amd)t([],e);else{var o;"undefined"!=typeof window?o=window:"undefined"!=typeof i?o=i:"undefined"!=typeof self&&(o=self),o.Promise=e()}}(function(){var t,n,r;return function o(t,e,n){function r(s,a){if(!e[s]){if(!t[s]){var l="function"==typeof _dereq_&&_dereq_;if(!a&&l)return l(s,!0);if(i)return i(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=e[s]={exports:{}};t[s][0].call(u.exports,function(e){var n=t[s][1][e];return r(n?n:e)},u,u.exports,o,t,e,n)}return e[s].exports}for(var i="function"==typeof _dereq_&&_dereq_,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e,n){"use strict";e.exports=function(t){function e(t){var e=new n(t),r=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),r}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},{}],2:[function(t,e,n){"use strict";function r(){this._isTickUsed=!1,this._lateQueue=new u(16),this._normalQueue=new u(16),this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=c.isStatic?c(this.drainQueues):c}function i(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function o(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function s(t){this._normalQueue._pushOne(t),this._queueTick()}var a;try{throw new Error}catch(l){a=l}var c=t("./schedule.js"),u=t("./queue.js"),f=t("./util.js");r.prototype.disableTrampolineIfNecessary=function(){f.hasDevTools&&(this._trampolineEnabled=!1)},r.prototype.enableTrampoline=function(){this._trampolineEnabled||(this._trampolineEnabled=!0,this._schedule=function(t){setTimeout(t,0)})},r.prototype.haveItemsQueued=function(){return this._normalQueue.length()>0},r.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")}},f.hasDevTools?(c.isStatic&&(c=function(t){setTimeout(t,0)}),r.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?i.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},r.prototype.invoke=function(t,e,n){this._trampolineEnabled?o.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},r.prototype.settlePromises=function(t){this._trampolineEnabled?s.call(this,t):this._schedule(function(){t._settlePromises()})}):(r.prototype.invokeLater=i,r.prototype.invoke=o,r.prototype.settlePromises=s),r.prototype.invokeFirst=function(t,e,n){this._normalQueue.unshift(t,e,n),this._queueTick()},r.prototype._drainQueue=function(t){for(;t.length()>0;){var e=t.shift();if("function"==typeof e){var n=t.shift(),r=t.shift();e.call(n,r)}else e._settlePromises()}},r.prototype._drainQueues=function(){this._drainQueue(this._normalQueue),this._reset(),this._drainQueue(this._lateQueue)},r.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},r.prototype._reset=function(){this._isTickUsed=!1},e.exports=new r,e.exports.firstLineError=a},{"./queue.js":28,"./schedule.js":31,"./util.js":38}],3:[function(t,e,n){"use strict";e.exports=function(t,e,n){var r=function(t,e){this._reject(e)},i=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(r,r,null,this,t)},o=function(t,e){this._isPending()&&this._resolveCallback(e.target)},s=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(r){var a=n(r),l=new t(e);l._propagateFrom(this,1);var c=this._target();if(l._setBoundTo(a),a instanceof t){var u={promiseRejectionQueued:!1,promise:l,target:c,bindingPromise:a};c._then(e,i,l._progress,l,u),a._then(o,s,l._progress,l,u)}else l._resolveCallback(c);return l},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=131072|this._bitField,this._boundTo=t):this._bitField=-131073&this._bitField},t.prototype._isBound=function(){return 131072===(131072&this._bitField)},t.bind=function(r,i){var o=n(r),s=new t(e);return s._setBoundTo(o),o instanceof t?o._then(function(){s._resolveCallback(i)},s._reject,s._progress,s,null):s._resolveCallback(i),s}}},{}],4:[function(t,e,n){"use strict";function r(){try{Promise===o&&(Promise=i)}catch(t){}return o}var i;"undefined"!=typeof Promise&&(i=Promise);var o=t("./promise.js")();o.noConflict=r,e.exports=o},{"./promise.js":23}],5:[function(t,e,n){"use strict";var r=Object.create;if(r){var i=r(null),o=r(null);i[" size"]=o[" size"]=0}e.exports=function(e){function n(t,n){var r;if(null!=t&&(r=t[n]),"function"!=typeof r){var i="Object "+a.classString(t)+" has no method '"+a.toString(n)+"'";throw new e.TypeError(i)}return r}function r(t){var e=this.pop(),r=n(t,e);return r.apply(t,this)}function i(t){return t[this]}function o(t){var e=+this;return 0>e&&(e=Math.max(0,e+t.length)),t[e]}var s,a=t("./util.js"),l=a.canEvaluate;a.isIdentifier;e.prototype.call=function(t){for(var e=arguments.length,n=new Array(e-1),i=1;e>i;++i)n[i-1]=arguments[i];return n.push(t),this._then(r,void 0,void 0,n,void 0)},e.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=o;else if(l){var r=s(t);e=null!==r?r:i}else e=i;return this._then(e,void 0,void 0,t,void 0)}}},{"./util.js":38}],6:[function(t,e,n){"use strict";e.exports=function(e){var n=t("./errors.js"),r=t("./async.js"),i=n.CancellationError;e.prototype._cancel=function(t){if(!this.isCancellable())return this;for(var e,n=this;void 0!==(e=n._cancellationParent)&&e.isCancellable();)n=e;this._unsetCancellable(),n._target()._rejectCallback(t,!1,!0)},e.prototype.cancel=function(t){return this.isCancellable()?(void 0===t&&(t=new i),r.invokeLater(this._cancel,this,t),this):this},e.prototype.cancellable=function(){return this._cancellable()?this:(r.enableTrampoline(),this._setCancellable(),this._cancellationParent=void 0,this)},e.prototype.uncancellable=function(){var t=this.then();return t._unsetCancellable(),t},e.prototype.fork=function(t,e,n){var r=this._then(t,e,n,void 0,void 0);return r._setCancellable(),r._cancellationParent=void 0,r}}},{"./async.js":2,"./errors.js":13}],7:[function(t,n,r){"use strict";n.exports=function(){function n(t){this._parent=t;var e=this._length=1+(void 0===t?0:t._length);j(this,n),e>32&&this.uncycle()}function r(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function i(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function o(t){for(var e=t[0],n=1;n<t.length;++n){for(var r=t[n],i=e.length-1,o=e[i],s=-1,a=r.length-1;a>=0;--a)if(r[a]===o){s=a;break}for(var a=s;a>=0;--a){var l=r[a];if(e[i]!==l)break;e.pop(),i--}e=r}}function s(t){for(var e=[],n=0;n<t.length;++n){var r=t[n],i=g.test(r)||"    (No stack trace)"===r,o=i&&y(r);i&&!o&&(m&&" "!==r.charAt(0)&&(r="    "+r),e.push(r))}return e}function a(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var r=e[n];if("    (No stack trace)"===r||g.test(r))break}return n>0&&(e=e.slice(n)),e}function l(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t.toString();var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var r=JSON.stringify(t);e=r}catch(i){}0===e.length&&(e="(empty array)")}return"(<"+c(e)+">, no stack trace)"}function c(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function u(t){var e=t.match(_);return e?{fileName:e[1],line:parseInt(e[2],10)}:void 0}var f,d=t("./async.js"),p=t("./util.js"),h=/[\\\/]bluebird[\\\/]js[\\\/](main|debug|zalgo|instrumented)/,g=null,v=null,m=!1;p.inherits(n,Error),n.prototype.uncycle=function(){var t=this._length;if(!(2>t)){for(var e=[],n={},r=0,i=this;void 0!==i;++r)e.push(i),i=i._parent;t=this._length=r;for(var r=t-1;r>=0;--r){var o=e[r].stack;void 0===n[o]&&(n[o]=r)}for(var r=0;t>r;++r){var s=e[r].stack,a=n[s];if(void 0!==a&&a!==r){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[r]._parent=void 0,e[r]._length=1;var l=r>0?e[r-1]:this;t-1>a?(l._parent=e[a+1],l._parent.uncycle(),l._length=l._parent._length+1):(l._parent=void 0,l._length=1);for(var c=l._length+1,u=r-2;u>=0;--u)e[u]._length=c,c++;return}}}},n.prototype.parent=function(){return this._parent},n.prototype.hasParent=function(){return void 0!==this._parent},n.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=n.parseStackAndMessage(t),a=e.message,l=[e.stack],c=this;void 0!==c;)l.push(s(c.stack.split("\n"))),c=c._parent;o(l),i(l),p.notEnumerableProp(t,"stack",r(a,l)),p.notEnumerableProp(t,"__stackCleaned__",!0)}},n.parseStackAndMessage=function(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?a(t):["    (No stack trace)"],{message:n,stack:s(e)}},n.formatAndLogError=function(t,e){if("undefined"!=typeof console){var n;if("object"==typeof t||"function"==typeof t){var r=t.stack;n=e+v(r,t)}else n=e+String(t);"function"==typeof f?f(n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(n)}},n.unhandledRejection=function(t){n.formatAndLogError(t,"^--- With additional stack trace: ")},n.isSupported=function(){return"function"==typeof j},n.fireRejectionEvent=function(t,e,r,i){var o=!1;try{"function"==typeof e&&(o=!0,"rejectionHandled"===t?e(i):e(r,i))}catch(s){d.throwLater(s)}var a=!1;try{a=x(t,r,i)}catch(s){a=!0,d.throwLater(s)}var l=!1;if(b)try{l=b(t.toLowerCase(),{reason:r,promise:i})}catch(s){l=!0,d.throwLater(s)}a||o||l||"unhandledRejection"!==t||n.formatAndLogError(r,"Unhandled rejection ")};var y=function(){return!1},_=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;n.setBounds=function(t,e){if(n.isSupported()){for(var r,i,o=t.stack.split("\n"),s=e.stack.split("\n"),a=-1,l=-1,c=0;c<o.length;++c){var f=u(o[c]);if(f){r=f.fileName,a=f.line;break}}for(var c=0;c<s.length;++c){var f=u(s[c]);if(f){i=f.fileName,l=f.line;break}}0>a||0>l||!r||!i||r!==i||a>=l||(y=function(t){if(h.test(t))return!0;var e=u(t);return!!(e&&e.fileName===r&&a<=e.line&&e.line<=l)})}};var b,j=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():l(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit=Error.stackTraceLimit+6,g=t,v=e;var n=Error.captureStackTrace;return y=function(t){return h.test(t)},function(t,e){Error.stackTraceLimit=Error.stackTraceLimit+6,n(t,e),Error.stackTraceLimit=Error.stackTraceLimit-6}}var r=new Error;if("string"==typeof r.stack&&r.stack.split("\n")[0].indexOf("stackDetection@")>=0)return g=/@/,v=e,m=!0,function(t){t.stack=(new Error).stack};var i;try{throw new Error}catch(o){i="stack"in o}return"stack"in r||!i||"number"!=typeof Error.stackTraceLimit?(v=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?l(e):e.toString()},null):(g=t,v=e,function(t){Error.stackTraceLimit=Error.stackTraceLimit+6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit=Error.stackTraceLimit-6})}([]),x=function(){if(p.isNode)return function(t,n,r){return"rejectionHandled"===t?e.emit(t,r):e.emit(t,n,r)};var t=!1,n=!0;try{var r=new self.CustomEvent("test");t=r instanceof CustomEvent}catch(i){}if(!t)try{var o=document.createEvent("CustomEvent");o.initCustomEvent("testingtheevent",!1,!0,{}),self.dispatchEvent(o)}catch(i){n=!1}n&&(b=function(e,n){var r;return t?r=new self.CustomEvent(e,{detail:n,bubbles:!1,cancelable:!0}):self.dispatchEvent&&(r=document.createEvent("CustomEvent"),r.initCustomEvent(e,!1,!0,n)),r?!self.dispatchEvent(r):!1});var s={};return s.unhandledRejection="onunhandledRejection".toLowerCase(),s.rejectionHandled="onrejectionHandled".toLowerCase(),function(t,e,n){var r=s[t],i=self[r];return i?("rejectionHandled"===t?i.call(self,n):i.call(self,e,n),!0):!1}}();return"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(f=function(t){console.warn(t)},p.isNode&&e.stderr.isTTY?f=function(t){e.stderr.write("[31m"+t+"[39m\n")}:p.isNode||"string"!=typeof(new Error).stack||(f=function(t){console.warn("%c"+t,"color: red")})),n}},{"./async.js":2,"./util.js":38}],8:[function(t,e,n){"use strict";e.exports=function(e){function n(t,e,n){this._instances=t,this._callback=e,this._promise=n}function r(t,e){var n={},r=s(t).call(n,e);if(r===a)return r;var i=l(n);return i.length?(a.e=new c("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"),a):r}var i=t("./util.js"),o=t("./errors.js"),s=i.tryCatch,a=i.errorObj,l=t("./es5.js").keys,c=o.TypeError;return n.prototype.doFilter=function(t){for(var n=this._callback,i=this._promise,o=i._boundValue(),l=0,c=this._instances.length;c>l;++l){var u=this._instances[l],f=u===Error||null!=u&&u.prototype instanceof Error;if(f&&t instanceof u){var d=s(n).call(o,t);return d===a?(e.e=d.e,e):d}if("function"==typeof u&&!f){var p=r(u,t);if(p===a){t=a.e;break}if(p){var d=s(n).call(o,t);return d===a?(e.e=d.e,e):d}}}return e.e=t,e},n}},{"./errors.js":13,"./es5.js":14,"./util.js":38}],9:[function(t,e,n){"use strict";e.exports=function(t,e,n){function r(){this._trace=new e(o())}function i(){return n()?new r:void 0}function o(){var t=s.length-1;return t>=0?s[t]:void 0}var s=[];return r.prototype._pushContext=function(){n()&&void 0!==this._trace&&s.push(this._trace)},r.prototype._popContext=function(){n()&&void 0!==this._trace&&s.pop()},t.prototype._peekContext=o,t.prototype._pushContext=r.prototype._pushContext,t.prototype._popContext=r.prototype._popContext,i}},{}],10:[function(t,n,r){"use strict";n.exports=function(n,r){var i,o,s=n._getDomain,a=t("./async.js"),l=t("./errors.js").Warning,c=t("./util.js"),u=c.canAttachTrace,f=c.isNode&&(!!e.env.BLUEBIRD_DEBUG||"development"===e.env.NODE_ENV);return c.isNode&&0==e.env.BLUEBIRD_DEBUG&&(f=!1),f&&a.disableTrampolineIfNecessary(),n.prototype._ignoreRejections=function(){this._unsetRejectionIsUnhandled(),this._bitField=16777216|this._bitField},n.prototype._ensurePossibleRejectionHandled=function(){0===(16777216&this._bitField)&&(this._setRejectionIsUnhandled(),a.invokeLater(this._notifyUnhandledRejection,this,void 0))},n.prototype._notifyUnhandledRejectionIsHandled=function(){r.fireRejectionEvent("rejectionHandled",i,void 0,this)},n.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._getCarriedStackTrace()||this._settledValue;this._setUnhandledRejectionIsNotified(),r.fireRejectionEvent("unhandledRejection",o,t,this)}},n.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=524288|this._bitField},n.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=-524289&this._bitField},n.prototype._isUnhandledRejectionNotified=function(){return(524288&this._bitField)>0},n.prototype._setRejectionIsUnhandled=function(){this._bitField=2097152|this._bitField},n.prototype._unsetRejectionIsUnhandled=function(){this._bitField=-2097153&this._bitField,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},n.prototype._isRejectionUnhandled=function(){return(2097152&this._bitField)>0},n.prototype._setCarriedStackTrace=function(t){this._bitField=1048576|this._bitField,this._fulfillmentHandler0=t},n.prototype._isCarryingStackTrace=function(){return(1048576&this._bitField)>0},n.prototype._getCarriedStackTrace=function(){return this._isCarryingStackTrace()?this._fulfillmentHandler0:void 0},n.prototype._captureStackTrace=function(){return f&&(this._trace=new r(this._peekContext())),this},n.prototype._attachExtraTrace=function(t,e){if(f&&u(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var i=r.parseStackAndMessage(t);c.notEnumerableProp(t,"stack",i.message+"\n"+i.stack.join("\n")),c.notEnumerableProp(t,"__stackCleaned__",!0)}}},n.prototype._warn=function(t){var e=new l(t),n=this._peekContext();if(n)n.attachExtraTrace(e);else{var i=r.parseStackAndMessage(e);e.stack=i.message+"\n"+i.stack.join("\n")}r.formatAndLogError(e,"")},n.onPossiblyUnhandledRejection=function(t){var e=s();o="function"==typeof t?null===e?t:e.bind(t):void 0},n.onUnhandledRejectionHandled=function(t){var e=s();i="function"==typeof t?null===e?t:e.bind(t):void 0},n.longStackTraces=function(){if(a.haveItemsQueued()&&f===!1)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/DT1qyG\n");f=r.isSupported(),f&&a.disableTrampolineIfNecessary()},n.hasLongStackTraces=function(){return f&&r.isSupported()},r.isSupported()||(n.longStackTraces=function(){},f=!1),function(){return f}}},{"./async.js":2,"./errors.js":13,"./util.js":38}],11:[function(t,e,n){"use strict";var r=t("./util.js"),i=r.isPrimitive;e.exports=function(t){var e=function(){return this},n=function(){throw this},r=function(){},o=function(){throw void 0},s=function(t,e){return 1===e?function(){throw t}:2===e?function(){return t}:void 0};t.prototype["return"]=t.prototype.thenReturn=function(n){return void 0===n?this.then(r):i(n)?this._then(s(n,2),void 0,void 0,void 0,void 0):(n instanceof t&&n._ignoreRejections(),this._then(e,void 0,void 0,n,void 0))},t.prototype["throw"]=t.prototype.thenThrow=function(t){return void 0===t?this.then(o):i(t)?this._then(s(t,1),void 0,void 0,void 0,void 0):this._then(n,void 0,void 0,t,void 0)}}},{"./util.js":38}],12:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.reduce;t.prototype.each=function(t){return n(this,t,null,e)},t.each=function(t,r){return n(t,r,null,e)}}},{}],13:[function(t,e,n){"use strict";function r(t,e){function n(r){return this instanceof n?(f(this,"message","string"==typeof r?r:e),f(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(r)}return u(n,Error),n}function i(t){return this instanceof i?(f(this,"name","OperationalError"),f(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(f(this,"message",t.message),f(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new i(t)}var o,s,a=t("./es5.js"),l=a.freeze,c=t("./util.js"),u=c.inherits,f=c.notEnumerableProp,d=r("Warning","warning"),p=r("CancellationError","cancellation error"),h=r("TimeoutError","timeout error"),g=r("AggregateError","aggregate error");try{o=TypeError,s=RangeError}catch(v){o=r("TypeError","type error"),s=r("RangeError","range error")}for(var m="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),y=0;y<m.length;++y)"function"==typeof Array.prototype[m[y]]&&(g.prototype[m[y]]=Array.prototype[m[y]]);a.defineProperty(g.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),g.prototype.isOperational=!0;var _=0;g.prototype.toString=function(){var t=Array(4*_+1).join(" "),e="\n"+t+"AggregateError of:\n";_++,t=Array(4*_+1).join(" ");for(var n=0;n<this.length;++n){for(var r=this[n]===this?"[Circular AggregateError]":this[n]+"",i=r.split("\n"),o=0;o<i.length;++o)i[o]=t+i[o];r=i.join("\n"),e+=r+"\n"}return _--,e},u(i,Error);var b=Error.__BluebirdErrorTypes__;b||(b=l({CancellationError:p,TimeoutError:h,OperationalError:i,RejectionError:i,AggregateError:g}),f(Error,"__BluebirdErrorTypes__",b)),e.exports={Error:Error,TypeError:o,RangeError:s,CancellationError:b.CancellationError,OperationalError:b.OperationalError,TimeoutError:b.TimeoutError,AggregateError:b.AggregateError,Warning:d}},{"./es5.js":14,"./util.js":38}],14:[function(t,e,n){var r=function(){"use strict";return void 0===this}();if(r)e.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:r,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,o={}.toString,s={}.constructor.prototype,a=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e},l=function(t,e){return{value:t[e]}},c=function(t,e,n){return t[e]=n.value,t},u=function(t){return t},f=function(t){try{return Object(t).constructor.prototype}catch(e){return s}},d=function(t){try{return"[object Array]"===o.call(t)}catch(e){return!1}};e.exports={isArray:d,keys:a,names:a,defineProperty:c,getDescriptor:l,freeze:u,getPrototypeOf:f,isES5:r,propertyIsWritable:function(){return!0}}}},{}],15:[function(t,e,n){"use strict";e.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,r){return n(this,t,r,e)},t.filter=function(t,r,i){return n(t,r,i,e)}}},{}],16:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(){return this}function o(){throw this}function s(t){return function(){return t}}function a(t){return function(){throw t}}function l(t,e,n){var r;return r=d(e)?n?s(e):a(e):n?i:o,t._then(r,p,void 0,e,void 0)}function c(t){var i=this.promise,o=this.handler,s=i._isBound()?o.call(i._boundValue()):o();if(void 0!==s){var a=r(s,i);if(a instanceof e)return a=a._target(),l(a,t,i.isFulfilled())}return i.isRejected()?(n.e=t,n):t}function u(t){var n=this.promise,i=this.handler,o=n._isBound()?i.call(n._boundValue(),t):i(t);if(void 0!==o){var s=r(o,n);if(s instanceof e)return s=s._target(),l(s,t,!0)}return t}var f=t("./util.js"),d=f.isPrimitive,p=f.thrower;e.prototype._passThroughHandler=function(t,e){if("function"!=typeof t)return this.then();var n={promise:this,handler:t};return this._then(e?c:u,e?c:void 0,void 0,n,void 0)},e.prototype.lastly=e.prototype["finally"]=function(t){return this._passThroughHandler(t,!0)},e.prototype.tap=function(t){return this._passThroughHandler(t,!1)}}},{"./util.js":38}],17:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,n,r){for(var o=0;o<n.length;++o){r._pushContext();var s=f(n[o])(t);if(r._popContext(),s===u){r._pushContext();var a=e.reject(u.e);return r._popContext(),a}var l=i(s,r);if(l instanceof e)return l}return null}function s(t,n,i,o){var s=this._promise=new e(r);s._captureStackTrace(),this._stack=o,this._generatorFunction=t,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof i?[i].concat(d):d}var a=t("./errors.js"),l=a.TypeError,c=t("./util.js"),u=c.errorObj,f=c.tryCatch,d=[];s.prototype.promise=function(){return this._promise},s.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._next(void 0)},s.prototype._continue=function(t){if(t===u)return this._promise._rejectCallback(t.e,!1,!0);var n=t.value;if(t.done===!0)this._promise._resolveCallback(n);else{var r=i(n,this._promise);if(!(r instanceof e)&&(r=o(r,this._yieldHandlers,this._promise),null===r))return void this._throw(new l("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/4Y4pDk\n\n".replace("%s",n)+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));r._then(this._next,this._throw,void 0,this,null)}},s.prototype._throw=function(t){this._promise._attachExtraTrace(t),this._promise._pushContext();var e=f(this._generator["throw"]).call(this._generator,t);this._promise._popContext(),this._continue(e)},s.prototype._next=function(t){this._promise._pushContext();var e=f(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},e.coroutine=function(t,e){if("function"!=typeof t)throw new l("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var n=Object(e).yieldHandler,r=s,i=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new r(void 0,void 0,n,i);return o._generator=e,o._next(void 0),o.promise()}},e.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new l("fn must be a function\n\n    See http://goo.gl/916lJJ\n");d.push(t)},e.spawn=function(t){if("function"!=typeof t)return n("generatorFunction must be a function\n\n    See http://goo.gl/6Vqhm0\n");var r=new s(t,this),i=r.promise();return r._run(e.spawn),i}}},{"./errors.js":13,"./util.js":38}],18:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util.js");o.canEvaluate,o.tryCatch,o.errorObj;e.join=function(){var t,e=arguments.length-1;if(e>0&&"function"==typeof arguments[e]){t=arguments[e];var r}for(var i=arguments.length,o=new Array(i),s=0;i>s;++s)o[s]=arguments[s];t&&o.pop();var r=new n(o).promise();return void 0!==t?r.spread(t):r}}},{"./util.js":38}],19:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){function s(t,e,n,r){this.constructor$(t),this._promise._captureStackTrace();var i=c();this._callback=null===i?e:i.bind(e),this._preservedValues=r===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=n>=1?[]:g,u.invoke(a,this,void 0)}function a(){this._init$(void 0,-2)}function l(t,e,n,r){var i="object"==typeof n&&null!==n?n.concurrency:0;return i="number"==typeof i&&isFinite(i)&&i>=1?i:0,new s(t,e,i,r)}var c=e._getDomain,u=t("./async.js"),f=t("./util.js"),d=f.tryCatch,p=f.errorObj,h={},g=[];f.inherits(s,n),s.prototype._init=function(){},s.prototype._promiseFulfilled=function(t,n){var r=this._values,o=this.length(),s=this._preservedValues,a=this._limit;if(r[n]===h){if(r[n]=t,a>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return}else{if(a>=1&&this._inFlight>=a)return r[n]=t,void this._queue.push(n);null!==s&&(s[n]=t);var l=this._callback,c=this._promise._boundValue();this._promise._pushContext();var u=d(l).call(c,t,n,o);if(this._promise._popContext(),u===p)return this._reject(u.e);var f=i(u,this._promise);if(f instanceof e){if(f=f._target(),f._isPending())return a>=1&&this._inFlight++,r[n]=h,f._proxyPromiseArray(this,n);if(!f._isFulfilled())return this._reject(f._reason());u=f._value()}r[n]=u}var g=++this._totalResolved;g>=o&&(null!==s?this._filter(r,s):this._resolve(r))},s.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var r=t.pop();this._promiseFulfilled(n[r],r)}},s.prototype._filter=function(t,e){for(var n=e.length,r=new Array(n),i=0,o=0;n>o;++o)t[o]&&(r[i++]=e[o]);r.length=i,this._resolve(r)},s.prototype.preservedValues=function(){return this._preservedValues},e.prototype.map=function(t,e){return"function"!=typeof t?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):l(this,t,e,null).promise()},e.map=function(t,e,n,i){return"function"!=typeof e?r("fn must be a function\n\n    See http://goo.gl/916lJJ\n"):l(t,e,n,i).promise()}}},{"./async.js":2,"./util.js":38}],20:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){var o=t("./util.js"),s=o.tryCatch;e.method=function(t){if("function"!=typeof t)throw new e.TypeError("fn must be a function\n\n    See http://goo.gl/916lJJ\n");return function(){var r=new e(n);r._captureStackTrace(),r._pushContext();var i=s(t).apply(this,arguments);return r._popContext(),r._resolveFromSyncValue(i),r}},e.attempt=e["try"]=function(t,r,a){if("function"!=typeof t)return i("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var l=new e(n);l._captureStackTrace(),l._pushContext();var c=o.isArray(r)?s(t).apply(a,r):s(t).call(a,r);return l._popContext(),l._resolveFromSyncValue(c),l},e.prototype._resolveFromSyncValue=function(t){t===o.errorObj?this._rejectCallback(t.e,!1,!0):this._resolveCallback(t,!0)}}},{"./util.js":38}],21:[function(t,e,n){"use strict";e.exports=function(e){function n(t,e){var n=this;if(!o.isArray(t))return r.call(n,t,e);var i=a(e).apply(n._boundValue(),[null].concat(t));i===l&&s.throwLater(i.e)}function r(t,e){var n=this,r=n._boundValue(),i=void 0===t?a(e).call(r,null):a(e).call(r,null,t);i===l&&s.throwLater(i.e)}function i(t,e){var n=this;if(!t){var r=n._target(),i=r._getCarriedStackTrace();i.cause=t,t=i}var o=a(e).call(n._boundValue(),t);o===l&&s.throwLater(o.e)}var o=t("./util.js"),s=t("./async.js"),a=o.tryCatch,l=o.errorObj;e.prototype.asCallback=e.prototype.nodeify=function(t,e){if("function"==typeof t){var o=r;void 0!==e&&Object(e).spread&&(o=n),this._then(o,i,void 0,this,t)}return this}}},{"./async.js":2,"./util.js":38}],22:[function(t,e,n){"use strict";e.exports=function(e,n){var r=t("./util.js"),i=t("./async.js"),o=r.tryCatch,s=r.errorObj;e.prototype.progressed=function(t){return this._then(void 0,void 0,t,void 0,void 0)},e.prototype._progress=function(t){this._isFollowingOrFulfilledOrRejected()||this._target()._progressUnchecked(t)},e.prototype._progressHandlerAt=function(t){return 0===t?this._progressHandler0:this[(t<<2)+t-5+2]},e.prototype._doProgressWith=function(t){var n=t.value,i=t.handler,a=t.promise,l=t.receiver,c=o(i).call(l,n);if(c===s){if(null!=c.e&&"StopProgressPropagation"!==c.e.name){var u=r.canAttachTrace(c.e)?c.e:new Error(r.toString(c.e));a._attachExtraTrace(u),a._progress(c.e)}}else c instanceof e?c._then(a._progress,null,null,a,void 0):a._progress(c)},e.prototype._progressUnchecked=function(t){for(var r=this._length(),o=this._progress,s=0;r>s;s++){var a=this._progressHandlerAt(s),l=this._promiseAt(s);if(l instanceof e)"function"==typeof a?i.invoke(this._doProgressWith,this,{handler:a,promise:l,receiver:this._receiverAt(s),value:t}):i.invoke(o,l,t);else{var c=this._receiverAt(s);"function"==typeof a?a.call(c,t,l):c instanceof n&&!c._isResolved()&&c._promiseProgressed(t,l)}}}}},{"./async.js":2,"./util.js":38}],23:[function(t,n,r){"use strict";n.exports=function(){function n(t){if("function"!=typeof t)throw new d("the promise constructor requires a resolver function\n\n    See http://goo.gl/EC22Yn\n");if(this.constructor!==n)throw new d("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/KsIlge\n");this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._progressHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._settledValue=void 0,t!==p&&this._resolveFromResolver(t)}function r(t){var e=new n(p);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._progressHandler0=t,e._promise0=t,e._receiver0=t,e._settledValue=t}var i,o=function(){return new d("circular promise resolution chain\n\n    See http://goo.gl/LhFpo0\n")},s=function(){return new n.PromiseInspection(this._target())},a=function(t){return n.reject(new d(t))},l=t("./util.js");i=l.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},l.notEnumerableProp(n,"_getDomain",i);var c={},u=t("./async.js"),f=t("./errors.js"),d=n.TypeError=f.TypeError;n.RangeError=f.RangeError,n.CancellationError=f.CancellationError,n.TimeoutError=f.TimeoutError,n.OperationalError=f.OperationalError,n.RejectionError=f.OperationalError,n.AggregateError=f.AggregateError;var p=function(){},h={},g={e:null},v=t("./thenables.js")(n,p),m=t("./promise_array.js")(n,p,v,a),y=t("./captured_trace.js")(),_=t("./debuggability.js")(n,y),b=t("./context.js")(n,y,_),j=t("./catch_filter.js")(g),x=t("./promise_resolver.js"),w=x._nodebackForPromise,C=l.errorObj,$=l.tryCatch;return n.prototype.toString=function(){return"[object Promise]"},n.prototype.caught=n.prototype["catch"]=function(t){var e=arguments.length;
if(e>1){var r,i=new Array(e-1),o=0;for(r=0;e-1>r;++r){var s=arguments[r];if("function"!=typeof s)return n.reject(new d("Catch filter must inherit from Error or be a simple predicate function\n\n    See http://goo.gl/o84o68\n"));i[o++]=s}i.length=o,t=arguments[r];var a=new j(i,t,this);return this._then(void 0,a.doFilter,void 0,a,void 0)}return this._then(void 0,t,void 0,void 0,void 0)},n.prototype.reflect=function(){return this._then(s,s,void 0,this,void 0)},n.prototype.then=function(t,e,n){if(_()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var r=".then() only accepts functions but was passed: "+l.classString(t);arguments.length>1&&(r+=", "+l.classString(e)),this._warn(r)}return this._then(t,e,n,void 0,void 0)},n.prototype.done=function(t,e,n){var r=this._then(t,e,n,void 0,void 0);r._setIsFinal()},n.prototype.spread=function(t,e){return this.all()._then(t,e,void 0,h,void 0)},n.prototype.isCancellable=function(){return!this.isResolved()&&this._cancellable()},n.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},n.prototype.all=function(){return new m(this).promise()},n.prototype.error=function(t){return this.caught(l.originatesFromRejection,t)},n.is=function(t){return t instanceof n},n.fromNode=function(t){var e=new n(p),r=$(t)(w(e));return r===C&&e._rejectCallback(r.e,!0,!0),e},n.all=function(t){return new m(t).promise()},n.defer=n.pending=function(){var t=new n(p);return new x(t)},n.cast=function(t){var e=v(t);if(!(e instanceof n)){var r=e;e=new n(p),e._fulfillUnchecked(r)}return e},n.resolve=n.fulfilled=n.cast,n.reject=n.rejected=function(t){var e=new n(p);return e._captureStackTrace(),e._rejectCallback(t,!0),e},n.setScheduler=function(t){if("function"!=typeof t)throw new d("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var e=u._schedule;return u._schedule=t,e},n.prototype._then=function(t,e,r,o,s){var a=void 0!==s,l=a?s:new n(p);a||(l._propagateFrom(this,5),l._captureStackTrace());var c=this._target();c!==this&&(void 0===o&&(o=this._boundTo),a||l._setIsMigrated());var f=c._addCallbacks(t,e,r,l,o,i());return c._isResolved()&&!c._isSettlePromisesQueued()&&u.invoke(c._settlePromiseAtPostResolution,c,f),l},n.prototype._settlePromiseAtPostResolution=function(t){this._isRejectionUnhandled()&&this._unsetRejectionIsUnhandled(),this._settlePromiseAt(t)},n.prototype._length=function(){return 131071&this._bitField},n.prototype._isFollowingOrFulfilledOrRejected=function(){return(939524096&this._bitField)>0},n.prototype._isFollowing=function(){return 536870912===(536870912&this._bitField)},n.prototype._setLength=function(t){this._bitField=-131072&this._bitField|131071&t},n.prototype._setFulfilled=function(){this._bitField=268435456|this._bitField},n.prototype._setRejected=function(){this._bitField=134217728|this._bitField},n.prototype._setFollowing=function(){this._bitField=536870912|this._bitField},n.prototype._setIsFinal=function(){this._bitField=33554432|this._bitField},n.prototype._isFinal=function(){return(33554432&this._bitField)>0},n.prototype._cancellable=function(){return(67108864&this._bitField)>0},n.prototype._setCancellable=function(){this._bitField=67108864|this._bitField},n.prototype._unsetCancellable=function(){this._bitField=-67108865&this._bitField},n.prototype._setIsMigrated=function(){this._bitField=4194304|this._bitField},n.prototype._unsetIsMigrated=function(){this._bitField=-4194305&this._bitField},n.prototype._isMigrated=function(){return(4194304&this._bitField)>0},n.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[5*t-5+4];if(e!==c)return void 0===e&&this._isBound()?this._boundValue():e},n.prototype._promiseAt=function(t){return 0===t?this._promise0:this[5*t-5+3]},n.prototype._fulfillmentHandlerAt=function(t){return 0===t?this._fulfillmentHandler0:this[5*t-5+0]},n.prototype._rejectionHandlerAt=function(t){return 0===t?this._rejectionHandler0:this[5*t-5+1]},n.prototype._boundValue=function(){var t=this._boundTo;return void 0!==t&&t instanceof n?t.isFulfilled()?t.value():void 0:t},n.prototype._migrateCallbacks=function(t,e){var r=t._fulfillmentHandlerAt(e),i=t._rejectionHandlerAt(e),o=t._progressHandlerAt(e),s=t._promiseAt(e),a=t._receiverAt(e);s instanceof n&&s._setIsMigrated(),void 0===a&&(a=c),this._addCallbacks(r,i,o,s,a,null)},n.prototype._addCallbacks=function(t,e,n,r,i,o){var s=this._length();if(s>=131066&&(s=0,this._setLength(0)),0===s)this._promise0=r,void 0!==i&&(this._receiver0=i),"function"!=typeof t||this._isCarryingStackTrace()||(this._fulfillmentHandler0=null===o?t:o.bind(t)),"function"==typeof e&&(this._rejectionHandler0=null===o?e:o.bind(e)),"function"==typeof n&&(this._progressHandler0=null===o?n:o.bind(n));else{var a=5*s-5;this[a+3]=r,this[a+4]=i,"function"==typeof t&&(this[a+0]=null===o?t:o.bind(t)),"function"==typeof e&&(this[a+1]=null===o?e:o.bind(e)),"function"==typeof n&&(this[a+2]=null===o?n:o.bind(n))}return this._setLength(s+1),s},n.prototype._setProxyHandlers=function(t,e){var n=this._length();if(n>=131066&&(n=0,this._setLength(0)),0===n)this._promise0=e,this._receiver0=t;else{var r=5*n-5;this[r+3]=e,this[r+4]=t}this._setLength(n+1)},n.prototype._proxyPromiseArray=function(t,e){this._setProxyHandlers(t,e)},n.prototype._resolveCallback=function(t,e){if(!this._isFollowingOrFulfilledOrRejected()){if(t===this)return this._rejectCallback(o(),!1,!0);var r=v(t,this);if(!(r instanceof n))return this._fulfill(t);var i=1|(e?4:0);this._propagateFrom(r,i);var s=r._target();if(s._isPending()){for(var a=this._length(),l=0;a>l;++l)s._migrateCallbacks(this,l);this._setFollowing(),this._setLength(0),this._setFollowee(s)}else s._isFulfilled()?this._fulfillUnchecked(s._value()):this._rejectUnchecked(s._reason(),s._getCarriedStackTrace())}},n.prototype._rejectCallback=function(t,e,n){n||l.markAsOriginatingFromRejection(t);var r=l.ensureErrorObject(t),i=r===t;this._attachExtraTrace(r,e?i:!1),this._reject(t,i?void 0:r)},n.prototype._resolveFromResolver=function(t){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,r=$(t)(function(t){null!==e&&(e._resolveCallback(t),e=null)},function(t){null!==e&&(e._rejectCallback(t,n),e=null)});n=!1,this._popContext(),void 0!==r&&r===C&&null!==e&&(e._rejectCallback(r.e,!0,!0),e=null)},n.prototype._settlePromiseFromHandler=function(t,e,n,r){if(!r._isRejected()){r._pushContext();var i;if(i=e!==h||this._isRejected()?$(t).call(e,n):$(t).apply(this._boundValue(),n),r._popContext(),i===C||i===r||i===g){var s=i===r?o():i.e;r._rejectCallback(s,!1,!0)}else r._resolveCallback(i)}},n.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},n.prototype._followee=function(){return this._rejectionHandler0},n.prototype._setFollowee=function(t){this._rejectionHandler0=t},n.prototype._cleanValues=function(){this._cancellable()&&(this._cancellationParent=void 0)},n.prototype._propagateFrom=function(t,e){(1&e)>0&&t._cancellable()&&(this._setCancellable(),this._cancellationParent=t),(4&e)>0&&t._isBound()&&this._setBoundTo(t._boundTo)},n.prototype._fulfill=function(t){this._isFollowingOrFulfilledOrRejected()||this._fulfillUnchecked(t)},n.prototype._reject=function(t,e){this._isFollowingOrFulfilledOrRejected()||this._rejectUnchecked(t,e)},n.prototype._settlePromiseAt=function(t){var e=this._promiseAt(t),r=e instanceof n;if(r&&e._isMigrated())return e._unsetIsMigrated(),u.invoke(this._settlePromiseAt,this,t);var i=this._isFulfilled()?this._fulfillmentHandlerAt(t):this._rejectionHandlerAt(t),o=this._isCarryingStackTrace()?this._getCarriedStackTrace():void 0,s=this._settledValue,a=this._receiverAt(t);this._clearCallbackDataAtIndex(t),"function"==typeof i?r?this._settlePromiseFromHandler(i,a,s,e):i.call(a,s,e):a instanceof m?a._isResolved()||(this._isFulfilled()?a._promiseFulfilled(s,e):a._promiseRejected(s,e)):r&&(this._isFulfilled()?e._fulfill(s):e._reject(s,o)),t>=4&&4===(31&t)&&u.invokeLater(this._setLength,this,0)},n.prototype._clearCallbackDataAtIndex=function(t){if(0===t)this._isCarryingStackTrace()||(this._fulfillmentHandler0=void 0),this._rejectionHandler0=this._progressHandler0=this._receiver0=this._promise0=void 0;else{var e=5*t-5;this[e+3]=this[e+4]=this[e+0]=this[e+1]=this[e+2]=void 0}},n.prototype._isSettlePromisesQueued=function(){return-1073741824===(-1073741824&this._bitField)},n.prototype._setSettlePromisesQueued=function(){this._bitField=-1073741824|this._bitField},n.prototype._unsetSettlePromisesQueued=function(){this._bitField=1073741823&this._bitField},n.prototype._queueSettlePromises=function(){u.settlePromises(this),this._setSettlePromisesQueued()},n.prototype._fulfillUnchecked=function(t){if(t===this){var e=o();return this._attachExtraTrace(e),this._rejectUnchecked(e,void 0)}this._setFulfilled(),this._settledValue=t,this._cleanValues(),this._length()>0&&this._queueSettlePromises()},n.prototype._rejectUncheckedCheckError=function(t){var e=l.ensureErrorObject(t);this._rejectUnchecked(t,e===t?void 0:e)},n.prototype._rejectUnchecked=function(t,e){if(t===this){var n=o();return this._attachExtraTrace(n),this._rejectUnchecked(n)}return this._setRejected(),this._settledValue=t,this._cleanValues(),this._isFinal()?void u.throwLater(function(t){throw"stack"in t&&u.invokeFirst(y.unhandledRejection,void 0,t),t},void 0===e?t:e):(void 0!==e&&e!==t&&this._setCarriedStackTrace(e),void(this._length()>0?this._queueSettlePromises():this._ensurePossibleRejectionHandled()))},n.prototype._settlePromises=function(){this._unsetSettlePromisesQueued();for(var t=this._length(),e=0;t>e;e++)this._settlePromiseAt(e)},l.notEnumerableProp(n,"_makeSelfResolutionError",o),t("./progress.js")(n,m),t("./method.js")(n,p,v,a),t("./bind.js")(n,p,v),t("./finally.js")(n,g,v),t("./direct_resolve.js")(n),t("./synchronous_inspection.js")(n),t("./join.js")(n,m,v,p),n.Promise=n,t("./map.js")(n,m,a,v,p),t("./cancel.js")(n),t("./using.js")(n,a,v,b),t("./generators.js")(n,a,p,v),t("./nodeify.js")(n),t("./call_get.js")(n),t("./props.js")(n,m,v,a),t("./race.js")(n,p,v,a),t("./reduce.js")(n,m,a,v,p),t("./settle.js")(n,m),t("./some.js")(n,m,a),t("./promisify.js")(n,p),t("./any.js")(n),t("./each.js")(n,p),t("./timers.js")(n,p),t("./filter.js")(n,p),l.toFastProperties(n),l.toFastProperties(n.prototype),r({a:1}),r({b:2}),r({c:3}),r(1),r(function(){}),r(void 0),r(!1),r(new n(p)),y.setBounds(u.firstLineError,l.lastLineError),n}},{"./any.js":1,"./async.js":2,"./bind.js":3,"./call_get.js":5,"./cancel.js":6,"./captured_trace.js":7,"./catch_filter.js":8,"./context.js":9,"./debuggability.js":10,"./direct_resolve.js":11,"./each.js":12,"./errors.js":13,"./filter.js":15,"./finally.js":16,"./generators.js":17,"./join.js":18,"./map.js":19,"./method.js":20,"./nodeify.js":21,"./progress.js":22,"./promise_array.js":24,"./promise_resolver.js":25,"./promisify.js":26,"./props.js":27,"./race.js":29,"./reduce.js":30,"./settle.js":32,"./some.js":33,"./synchronous_inspection.js":34,"./thenables.js":35,"./timers.js":36,"./using.js":37,"./util.js":38}],24:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t){switch(t){case-2:return[];case-3:return{}}}function s(t){var r,i=this._promise=new e(n);t instanceof e&&(r=t,i._propagateFrom(r,5)),this._values=t,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var a=t("./util.js"),l=a.isArray;return s.prototype.length=function(){return this._length},s.prototype.promise=function(){return this._promise},s.prototype._init=function c(t,n){var s=r(this._values,this._promise);if(s instanceof e){if(s=s._target(),this._values=s,!s._isFulfilled())return s._isPending()?void s._then(c,this._reject,void 0,this,n):void this._reject(s._reason());if(s=s._value(),!l(s)){var a=new e.TypeError("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");return void this.__hardReject__(a)}}else if(!l(s))return void this._promise._reject(i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n")._reason());if(0===s.length)return void(-5===n?this._resolveEmptyArray():this._resolve(o(n)));var u=this.getActualLength(s.length);this._length=u,this._values=this.shouldCopyValues()?new Array(u):this._values;for(var f=this._promise,d=0;u>d;++d){var p=this._isResolved(),h=r(s[d],f);h instanceof e?(h=h._target(),p?h._ignoreRejections():h._isPending()?h._proxyPromiseArray(this,d):h._isFulfilled()?this._promiseFulfilled(h._value(),d):this._promiseRejected(h._reason(),d)):p||this._promiseFulfilled(h,d)}},s.prototype._isResolved=function(){return null===this._values},s.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},s.prototype.__hardReject__=s.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1,!0)},s.prototype._promiseProgressed=function(t,e){this._promise._progress({index:e,value:t})},s.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},s.prototype._promiseRejected=function(t,e){this._totalResolved++,this._reject(t)},s.prototype.shouldCopyValues=function(){return!0},s.prototype.getActualLength=function(t){return t},s}},{"./util.js":38}],25:[function(t,e,n){"use strict";function r(t){return t instanceof Error&&p.getPrototypeOf(t)===Error.prototype}function i(t){var e;if(r(t)){e=new f(t),e.name=t.name,e.message=t.message,e.stack=t.stack;for(var n=p.keys(t),i=0;i<n.length;++i){var o=n[i];h.test(o)||(e[o]=t[o])}return e}return a.markAsOriginatingFromRejection(t),t}function o(t){return function(e,n){if(null!==t){if(e){var r=i(l(e));t._attachExtraTrace(r),t._reject(r)}else if(arguments.length>2){for(var o=arguments.length,s=new Array(o-1),a=1;o>a;++a)s[a-1]=arguments[a];t._fulfill(s)}else t._fulfill(n);t=null}}}var s,a=t("./util.js"),l=a.maybeWrapAsError,c=t("./errors.js"),u=c.TimeoutError,f=c.OperationalError,d=a.haveGetters,p=t("./es5.js"),h=/^(?:name|message|stack|cause)$/;if(s=d?function(t){this.promise=t}:function(t){this.promise=t,this.asCallback=o(t),this.callback=this.asCallback},d){var g={get:function(){return o(this.promise)}};p.defineProperty(s.prototype,"asCallback",g),p.defineProperty(s.prototype,"callback",g)}s._nodebackForPromise=o,s.prototype.toString=function(){return"[object PromiseResolver]"},s.prototype.resolve=s.prototype.fulfill=function(t){if(!(this instanceof s))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._resolveCallback(t)},s.prototype.reject=function(t){if(!(this instanceof s))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._rejectCallback(t)},s.prototype.progress=function(t){if(!(this instanceof s))throw new TypeError("Illegal invocation, resolver resolve/reject must be called within a resolver context. Consider using the promise constructor instead.\n\n    See http://goo.gl/sdkXL9\n");this.promise._progress(t)},s.prototype.cancel=function(t){this.promise.cancel(t)},s.prototype.timeout=function(){this.reject(new u("timeout"))},s.prototype.isResolved=function(){return this.promise.isResolved()},s.prototype.toJSON=function(){return this.promise.toJSON()},e.exports=s},{"./errors.js":13,"./es5.js":14,"./util.js":38}],26:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){return!x.test(t)}function i(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,n){var r=p.getDataPropertyOrDefault(t,e+n,b);return r?i(r):!1}function s(t,e,n){for(var r=0;r<t.length;r+=2){var i=t[r];if(n.test(i))for(var o=i.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new y("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/iWrZbw\n".replace("%s",e))}}function a(t,e,n,r){for(var a=p.inheritedDataKeys(t),l=[],c=0;c<a.length;++c){var u=a[c],f=t[u],d=r===w?!0:w(u,f,t);"function"!=typeof f||i(f)||o(t,u,e)||!r(u,f,t,d)||l.push(u,f)}return s(l,e,n),l}function l(t,r,i,o){function s(){var i=r;r===d&&(i=this);var o=new e(n);o._captureStackTrace();var s="string"==typeof l&&this!==a?this[l]:t,c=h(o);try{s.apply(i,g(arguments,c))}catch(u){o._rejectCallback(v(u),!0,!0)}return o}var a=function(){return this}(),l=t;return"string"==typeof l&&(t=o),p.notEnumerableProp(s,"__isPromisified__",!0),s}function c(t,e,n,r){for(var i=new RegExp(C(e)+"$"),o=a(t,e,i,n),s=0,l=o.length;l>s;s+=2){var c=o[s],u=o[s+1],f=c+e;if(r===$)t[f]=$(c,d,c,u,e);else{var h=r(u,function(){return $(c,d,c,u,e)});p.notEnumerableProp(h,"__isPromisified__",!0),t[f]=h}}return p.toFastProperties(t),t}function u(t,e){return $(t,e,void 0,t)}var f,d={},p=t("./util.js"),h=t("./promise_resolver.js")._nodebackForPromise,g=p.withAppended,v=p.maybeWrapAsError,m=p.canEvaluate,y=t("./errors").TypeError,_="Async",b={__isPromisified__:!0},j=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],x=new RegExp("^(?:"+j.join("|")+")$"),w=function(t){return p.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},C=function(t){return t.replace(/([$])/,"\\$")},$=m?f:l;e.promisify=function(t,e){if("function"!=typeof t)throw new y("fn must be a function\n\n    See http://goo.gl/916lJJ\n");if(i(t))return t;var n=u(t,arguments.length<2?d:e);return p.copyDescriptors(t,n,r),n},e.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new y("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/9ITlV0\n");e=Object(e);var n=e.suffix;"string"!=typeof n&&(n=_);var r=e.filter;"function"!=typeof r&&(r=w);var i=e.promisifier;if("function"!=typeof i&&(i=$),!p.isIdentifier(n))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/8FZo5V\n");for(var o=p.inheritedDataKeys(t),s=0;s<o.length;++s){var a=t[o[s]];"constructor"!==o[s]&&p.isClass(a)&&(c(a.prototype,n,r,i),c(a,n,r,i))}return c(t,n,r,i)}}},{"./errors":13,"./promise_resolver.js":25,"./util.js":38}],27:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t){for(var e=c.keys(t),n=e.length,r=new Array(2*n),i=0;n>i;++i){var o=e[i];r[i]=t[o],r[i+n]=o}this.constructor$(r)}function s(t){var n,s=r(t);return l(s)?(n=s instanceof e?s._then(e.props,void 0,void 0,void 0,void 0):new o(s).promise(),s instanceof e&&n._propagateFrom(s,4),n):i("cannot await properties of a non-object\n\n    See http://goo.gl/OsFKC8\n")}var a=t("./util.js"),l=a.isObject,c=t("./es5.js");a.inherits(o,n),o.prototype._init=function(){this._init$(void 0,-3)},o.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){for(var r={},i=this.length(),o=0,s=this.length();s>o;++o)r[this._values[o+i]]=this._values[o];this._resolve(r)}},o.prototype._promiseProgressed=function(t,e){this._promise._progress({key:this._values[e+this.length()],value:t})},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},e.prototype.props=function(){return s(this)},e.props=function(t){return s(t)}}},{"./es5.js":14,"./util.js":38}],28:[function(t,e,n){"use strict";function r(t,e,n,r,i){for(var o=0;i>o;++o)n[o+r]=t[o+e],t[o+e]=void 0}function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},i.prototype._unshiftOne=function(t){var e=this._capacity;this._checkCapacity(this.length()+1);var n=this._front,r=(n-1&e-1^e)-e;this[r]=t,this._front=r,this._length=this.length()+1},i.prototype.unshift=function(t,e,n){this._unshiftOne(n),this._unshiftOne(e),this._unshiftOne(t)},i.prototype.push=function(t,e,n){var r=this.length()+3;if(this._willBeOverCapacity(r))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var i=this._front+r-3;this._checkCapacity(r);var o=this._capacity-1;this[i+0&o]=t,this[i+1&o]=e,this[i+2&o]=n,this._length=r},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var n=this._front,i=this._length,o=n+i&e-1;r(this,0,this,e,o)},e.exports=i},{}],29:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t,o){var l=r(t);if(l instanceof e)return a(l);if(!s(t))return i("expecting an array, a promise or a thenable\n\n    See http://goo.gl/s8MMhc\n");var c=new e(n);void 0!==o&&c._propagateFrom(o,5);for(var u=c._fulfill,f=c._reject,d=0,p=t.length;p>d;++d){var h=t[d];(void 0!==h||d in t)&&e.cast(h)._then(u,f,void 0,c,null)}return c}var s=t("./util.js").isArray,a=function(t){return t.then(function(e){return o(e,t)})};e.race=function(t){return o(t,void 0)},e.prototype.race=function(){return o(this,void 0)}}},{"./util.js":38}],30:[function(t,e,n){"use strict";e.exports=function(e,n,r,i,o){function s(t,n,r,s){this.constructor$(t),this._promise._captureStackTrace(),this._preservedValues=s===o?[]:null,this._zerothIsAccum=void 0===r,this._gotAccum=!1,this._reducingIndex=this._zerothIsAccum?1:0,this._valuesPhase=void 0;var l=i(r,this._promise),f=!1,d=l instanceof e;d&&(l=l._target(),l._isPending()?l._proxyPromiseArray(this,-1):l._isFulfilled()?(r=l._value(),this._gotAccum=!0):(this._reject(l._reason()),f=!0)),d||this._zerothIsAccum||(this._gotAccum=!0);var p=c();this._callback=null===p?n:p.bind(n),this._accum=r,f||u.invoke(a,this,void 0)}function a(){this._init$(void 0,-5)}function l(t,e,n,i){if("function"!=typeof e)return r("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var o=new s(t,e,n,i);return o.promise()}var c=e._getDomain,u=t("./async.js"),f=t("./util.js"),d=f.tryCatch,p=f.errorObj;f.inherits(s,n),s.prototype._init=function(){},s.prototype._resolveEmptyArray=function(){(this._gotAccum||this._zerothIsAccum)&&this._resolve(null!==this._preservedValues?[]:this._accum)},s.prototype._promiseFulfilled=function(t,n){var r=this._values;r[n]=t;var o,s=this.length(),a=this._preservedValues,l=null!==a,c=this._gotAccum,u=this._valuesPhase;if(!u)for(u=this._valuesPhase=new Array(s),o=0;s>o;++o)u[o]=0;if(o=u[n],0===n&&this._zerothIsAccum?(this._accum=t,this._gotAccum=c=!0,u[n]=0===o?1:2):-1===n?(this._accum=t,this._gotAccum=c=!0):0===o?u[n]=1:(u[n]=2,this._accum=t),c){for(var f,h=this._callback,g=this._promise._boundValue(),v=this._reducingIndex;s>v;++v)if(o=u[v],2!==o){if(1!==o)return;if(t=r[v],this._promise._pushContext(),l?(a.push(t),f=d(h).call(g,t,v,s)):f=d(h).call(g,this._accum,t,v,s),this._promise._popContext(),f===p)return this._reject(f.e);var m=i(f,this._promise);if(m instanceof e){if(m=m._target(),m._isPending())return u[v]=4,m._proxyPromiseArray(this,v);if(!m._isFulfilled())return this._reject(m._reason());f=m._value()}this._reducingIndex=v+1,this._accum=f}else this._reducingIndex=v+1;this._resolve(l?a:this._accum)}},e.prototype.reduce=function(t,e){return l(this,t,e,null)},e.reduce=function(t,e,n,r){return l(t,e,n,r)}}},{"./async.js":2,"./util.js":38}],31:[function(t,n,r){"use strict";var o,s=t("./util"),a=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/m3OTXk\n")};if(s.isNode&&"undefined"==typeof MutationObserver){var l=i.setImmediate,c=e.nextTick;o=s.isRecentNode?function(t){l.call(i,t)}:function(t){c.call(e,t)}}else"undefined"==typeof MutationObserver||"undefined"!=typeof window&&window.navigator&&window.navigator.standalone?o="undefined"!=typeof setImmediate?function(t){setImmediate(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:a:(o=function(t){var e=document.createElement("div"),n=new MutationObserver(t);return n.observe(e,{attributes:!0}),function(){e.classList.toggle("foo")}},o.isStatic=!0);n.exports=o},{"./util":38}],32:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){this.constructor$(t)}var i=e.PromiseInspection,o=t("./util.js");o.inherits(r,n),r.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;n>=this._length&&this._resolve(this._values)},r.prototype._promiseFulfilled=function(t,e){var n=new i;n._bitField=268435456,n._settledValue=t,this._promiseResolved(e,n)},r.prototype._promiseRejected=function(t,e){var n=new i;n._bitField=134217728,n._settledValue=t,this._promiseResolved(e,n)},e.settle=function(t){return new r(t).promise()},e.prototype.settle=function(){return new r(this).promise()}}},{"./util.js":38}],33:[function(t,e,n){"use strict";e.exports=function(e,n,r){function i(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||0>e)return r("expecting a positive integer\n\n    See http://goo.gl/1wAmHx\n");var n=new i(t),o=n.promise();return n.setHowMany(e),n.init(),o}var s=t("./util.js"),a=t("./errors.js").RangeError,l=t("./errors.js").AggregateError,c=s.isArray;s.inherits(i,n),i.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=c(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},i.prototype.init=function(){this._initialized=!0,this._init()},i.prototype.setUnwrap=function(){this._unwrap=!0},i.prototype.howMany=function(){return this._howMany},i.prototype.setHowMany=function(t){this._howMany=t},i.prototype._promiseFulfilled=function(t){this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values))},i.prototype._promiseRejected=function(t){if(this._addRejected(t),this.howMany()>this._canPossiblyFulfill()){for(var e=new l,n=this.length();n<this._values.length;++n)e.push(this._values[n]);this._reject(e)}},i.prototype._fulfilled=function(){return this._totalResolved},i.prototype._rejected=function(){return this._values.length-this.length()},i.prototype._addRejected=function(t){this._values.push(t)},i.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},i.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},i.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},i.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},e.some=function(t,e){return o(t,e)},e.prototype.some=function(t){return o(this,t)},e._SomePromiseArray=i}},{"./errors.js":13,"./util.js":38}],34:[function(t,e,n){"use strict";e.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValue=t._settledValue):(this._bitField=0,this._settledValue=void 0)}e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return this._settledValue},e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return this._settledValue},e.prototype.isFulfilled=t.prototype._isFulfilled=function(){return(268435456&this._bitField)>0},e.prototype.isRejected=t.prototype._isRejected=function(){return(134217728&this._bitField)>0},e.prototype.isPending=t.prototype._isPending=function(){return 0===(402653184&this._bitField)},e.prototype.isResolved=t.prototype._isResolved=function(){return(402653184&this._bitField)>0},t.prototype.isPending=function(){return this._target()._isPending()},t.prototype.isRejected=function(){return this._target()._isRejected()},t.prototype.isFulfilled=function(){return this._target()._isFulfilled()},t.prototype.isResolved=function(){return this._target()._isResolved()},t.prototype._value=function(){return this._settledValue},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue},t.prototype.value=function(){var t=this._target();if(!t.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/hc1DLj\n");return t._settledValue},t.prototype.reason=function(){var t=this._target();if(!t.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/hPuiwB\n");return t._unsetRejectionIsUnhandled(),t._settledValue},t.PromiseInspection=e}},{}],35:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t,r){if(c(t)){if(t instanceof e)return t;if(o(t)){var u=new e(n);return t._then(u._fulfillUnchecked,u._rejectUncheckedCheckError,u._progressUnchecked,u,null),u}var f=a.tryCatch(i)(t);if(f===l){r&&r._pushContext();var u=e.reject(f.e);return r&&r._popContext(),u}if("function"==typeof f)return s(t,f,r)}return t}function i(t){return t.then}function o(t){return u.call(t,"_promise0")}function s(t,r,i){function o(t){u&&(u._resolveCallback(t),u=null)}function s(t){u&&(u._rejectCallback(t,d,!0),u=null)}function c(t){u&&"function"==typeof u._progress&&u._progress(t)}var u=new e(n),f=u;i&&i._pushContext(),u._captureStackTrace(),i&&i._popContext();var d=!0,p=a.tryCatch(r).call(t,o,s,c);return d=!1,u&&p===l&&(u._rejectCallback(p.e,!0,!0),u=null),f}var a=t("./util.js"),l=a.errorObj,c=a.isObject,u={}.hasOwnProperty;return r}},{"./util.js":38}],36:[function(t,e,n){"use strict";e.exports=function(e,n){function r(t){var e=this;return e instanceof Number&&(e=+e),clearTimeout(e),t}function i(t){var e=this;throw e instanceof Number&&(e=+e),clearTimeout(e),t}var o=t("./util.js"),s=e.TimeoutError,a=function(t,e){if(t.isPending()){var n;!o.isPrimitive(e)&&e instanceof Error?n=e:("string"!=typeof e&&(e="operation timed out"),n=new s(e)),o.markAsOriginatingFromRejection(n),t._attachExtraTrace(n),t._cancel(n)}},l=function(t){return c(+this).thenReturn(t)},c=e.delay=function(t,r){if(void 0===r){r=t,t=void 0;var i=new e(n);return setTimeout(function(){i._fulfill()},r),i}return r=+r,e.resolve(t)._then(l,null,null,r,void 0)};e.prototype.delay=function(t){return c(this,t)},e.prototype.timeout=function(t,e){t=+t;var n=this.then().cancellable();n._cancellationParent=this;var o=setTimeout(function(){a(n,e)},t);return n._then(r,i,void 0,o,void 0)}}},{"./util.js":38}],37:[function(t,e,n){"use strict";e.exports=function(e,n,r,i){function o(t){for(var n=t.length,r=0;n>r;++r){var i=t[r];if(i.isRejected())return e.reject(i.error());t[r]=i._settledValue}return t}function s(t){setTimeout(function(){throw t},0)}function a(t){var e=r(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function l(t,n){function i(){if(o>=l)return c.resolve();var u=a(t[o++]);if(u instanceof e&&u._isDisposable()){try{u=r(u._getDisposer().tryDispose(n),t.promise)}catch(f){return s(f)}if(u instanceof e)return u._then(i,s,null,null,null)}i()}var o=0,l=t.length,c=e.defer();return i(),c.promise}function c(t){var e=new v;return e._settledValue=t,e._bitField=268435456,l(this,e).thenReturn(t)}function u(t){var e=new v;return e._settledValue=t,e._bitField=134217728,l(this,e).thenThrow(t)}function f(t,e,n){this._data=t,this._promise=e,this._context=n}function d(t,e,n){this.constructor$(t,e,n)}function p(t){return f.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}var h=t("./errors.js").TypeError,g=t("./util.js").inherits,v=e.PromiseInspection;f.prototype.data=function(){return this._data},f.prototype.promise=function(){return this._promise},f.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():null},f.prototype.tryDispose=function(t){
var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var r=null!==e?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,r},f.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},g(d,f),d.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},e.using=function(){var t=arguments.length;if(2>t)return n("you must pass at least 2 arguments to Promise.using");var i=arguments[t-1];if("function"!=typeof i)return n("fn must be a function\n\n    See http://goo.gl/916lJJ\n");var s,a=!0;2===t&&Array.isArray(arguments[0])?(s=arguments[0],t=s.length,a=!1):(s=arguments,t--);for(var l=new Array(t),d=0;t>d;++d){var h=s[d];if(f.isDisposer(h)){var g=h;h=h.promise(),h._setDisposable(g)}else{var v=r(h);v instanceof e&&(h=v._then(p,null,null,{resources:l,index:d},void 0))}l[d]=h}var m=e.settle(l).then(o).then(function(t){m._pushContext();var e;try{e=a?i.apply(void 0,t):i.call(void 0,t)}finally{m._popContext()}return e})._then(c,u,void 0,l,void 0);return l.promise=m,m},e.prototype._setDisposable=function(t){this._bitField=262144|this._bitField,this._disposer=t},e.prototype._isDisposable=function(){return(262144&this._bitField)>0},e.prototype._getDisposer=function(){return this._disposer},e.prototype._unsetDisposable=function(){this._bitField=-262145&this._bitField,this._disposer=void 0},e.prototype.disposer=function(t){if("function"==typeof t)return new d(t,this,i());throw new h}}},{"./errors.js":13,"./util.js":38}],38:[function(t,n,r){"use strict";function i(){try{var t=k;return k=null,t.apply(this,arguments)}catch(e){return S.e=e,S}}function o(t){return k=t,i}function s(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function a(t){return!s(t)}function l(t){return s(t)?new Error(m(t)):t}function c(t,e){var n,r=t.length,i=new Array(r+1);for(n=0;r>n;++n)i[n]=t[n];return i[n]=e,i}function u(t,e,n){if(!w.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var r=Object.getOwnPropertyDescriptor(t,e);return null!=r?null==r.get&&null==r.set?r.value:n:void 0}function f(t,e,n){if(s(t))return t;var r={value:n,configurable:!0,enumerable:!1,writable:!0};return w.defineProperty(t,e,r),t}function d(t){throw t}function p(t){try{if("function"==typeof t){var e=w.names(t.prototype),n=w.isES5&&e.length>1,r=e.length>0&&!(1===e.length&&"constructor"===e[0]),i=P.test(t+"")&&w.names(t).length>0;if(n||r||i)return!0}return!1}catch(o){return!1}}function h(t){function e(){}e.prototype=t;for(var n=8;n--;)new e;return t}function g(t){return F.test(t)}function v(t,e,n){for(var r=new Array(t),i=0;t>i;++i)r[i]=e+i+n;return r}function m(t){try{return t+""}catch(e){return"[no string representation]"}}function y(t){try{f(t,"isOperational",!0)}catch(e){}}function _(t){return null==t?!1:t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0}function b(t){return t instanceof Error&&w.propertyIsWritable(t,"stack")}function j(t){return{}.toString.call(t)}function x(t,e,n){for(var r=w.names(t),i=0;i<r.length;++i){var o=r[i];if(n(o))try{w.defineProperty(e,o,w.getDescriptor(t,o))}catch(s){}}}var w=t("./es5.js"),C="undefined"==typeof navigator,$=function(){try{var t={};return w.defineProperty(t,"f",{get:function(){return 3}}),3===t.f}catch(e){return!1}}(),S={e:{}},k,T=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)r.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var r={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},E=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(w.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var r=[],i=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(s){return r}for(var a=0;a<o.length;++a){var l=o[a];if(!i[l]){i[l]=!0;var c=Object.getOwnPropertyDescriptor(t,l);null!=c&&null==c.get&&null==c.set&&r.push(l)}}t=w.getPrototypeOf(t)}return r}}var r={}.hasOwnProperty;return function(n){if(e(n))return[];var i=[];t:for(var o in n)if(r.call(n,o))i.push(o);else{for(var s=0;s<t.length;++s)if(r.call(t[s],o))continue t;i.push(o)}return i}}(),P=/this\s*\.\s*\S+\s*=/,F=/^[a-z$_][a-z$_0-9]*$/i,M=function(){return"stack"in new Error?function(t){return b(t)?t:new Error(m(t))}:function(t){if(b(t))return t;try{throw new Error(m(t))}catch(e){return e}}}(),I={isClass:p,isIdentifier:g,inheritedDataKeys:E,getDataPropertyOrDefault:u,thrower:d,isArray:w.isArray,haveGetters:$,notEnumerableProp:f,isPrimitive:s,isObject:a,canEvaluate:C,errorObj:S,tryCatch:o,inherits:T,withAppended:c,maybeWrapAsError:l,toFastProperties:h,filledRange:v,toString:m,canAttachTrace:b,ensureErrorObject:M,originatesFromRejection:_,markAsOriginatingFromRejection:y,classString:j,copyDescriptors:x,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:"undefined"!=typeof e&&"[object process]"===j(e).toLowerCase()};I.isRecentNode=I.isNode&&function(){var t=e.versions.node.split(".").map(Number);return 0===t[0]&&t[1]>10||t[0]>0}(),I.isNode&&I.toFastProperties(e);try{throw new Error}catch(A){I.lastLineError=A}n.exports=I},{"./es5.js":14}]},{},[4])(4)}),"undefined"!=typeof window&&null!==window?window.P=window.Promise:"undefined"!=typeof self&&null!==self&&(self.P=self.Promise)}).call(this,e("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:2}],2:[function(t,e,n){function r(){u=!1,a.length?c=a.concat(c):f=-1,c.length&&i()}function i(){if(!u){var t=setTimeout(r);u=!0;for(var e=c.length;e;){for(a=c,c=[];++f<e;)a&&a[f].run();f=-1,e=c.length}a=null,u=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var a,l=e.exports={},c=[],u=!1,f=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new o(t,e)),1!==c.length||u||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=s,l.addListener=s,l.once=s,l.off=s,l.removeListener=s,l.removeAllListeners=s,l.emit=s,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],3:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(){var t=new a.HandlebarsEnvironment;return p.extend(t,a),t.SafeString=c["default"],t.Exception=f["default"],t.Utils=p,t.escapeExpression=p.escapeExpression,t.VM=g,t.template=function(e){return g.template(e,t)},t}n.__esModule=!0;var s=t("./handlebars/base"),a=i(s),l=t("./handlebars/safe-string"),c=r(l),u=t("./handlebars/exception"),f=r(u),d=t("./handlebars/utils"),p=i(d),h=t("./handlebars/runtime"),g=i(h),v=t("./handlebars/no-conflict"),m=r(v),y=o();y.create=o,m["default"](y),y["default"]=y,n["default"]=y,e.exports=n["default"]},{"./handlebars/base":4,"./handlebars/exception":7,"./handlebars/no-conflict":17,"./handlebars/runtime":18,"./handlebars/safe-string":19,"./handlebars/utils":20}],4:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t,e,n){this.helpers=t||{},this.partials=e||{},this.decorators=n||{},l.registerDefaultHelpers(this),c.registerDefaultDecorators(this)}n.__esModule=!0,n.HandlebarsEnvironment=i;var o=t("./utils"),s=t("./exception"),a=r(s),l=t("./helpers"),c=t("./decorators"),u=t("./logger"),f=r(u),d="4.0.5";n.VERSION=d;var p=7;n.COMPILER_REVISION=p;var h={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0"};n.REVISION_CHANGES=h;var g="[object Object]";i.prototype={constructor:i,logger:f["default"],log:f["default"].log,registerHelper:function(t,e){if(o.toString.call(t)===g){if(e)throw new a["default"]("Arg not supported with multiple helpers");o.extend(this.helpers,t)}else this.helpers[t]=e},unregisterHelper:function(t){delete this.helpers[t]},registerPartial:function(t,e){if(o.toString.call(t)===g)o.extend(this.partials,t);else{if("undefined"==typeof e)throw new a["default"]('Attempting to register a partial called "'+t+'" as undefined');this.partials[t]=e}},unregisterPartial:function(t){delete this.partials[t]},registerDecorator:function(t,e){if(o.toString.call(t)===g){if(e)throw new a["default"]("Arg not supported with multiple decorators");o.extend(this.decorators,t)}else this.decorators[t]=e},unregisterDecorator:function(t){delete this.decorators[t]}};var v=f["default"].log;n.log=v,n.createFrame=o.createFrame,n.logger=f["default"]},{"./decorators":5,"./exception":7,"./helpers":8,"./logger":16,"./utils":20}],5:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){s["default"](t)}n.__esModule=!0,n.registerDefaultDecorators=i;var o=t("./decorators/inline"),s=r(o)},{"./decorators/inline":6}],6:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("../utils");n["default"]=function(t){t.registerDecorator("inline",function(t,e,n,i){var o=t;return e.partials||(e.partials={},o=function(i,o){var s=n.partials;n.partials=r.extend({},s,e.partials);var a=t(i,o);return n.partials=s,a}),e.partials[i.args[0]]=i.fn,o})},e.exports=n["default"]},{"../utils":20}],7:[function(t,e,n){"use strict";function r(t,e){var n=e&&e.loc,o=void 0,s=void 0;n&&(o=n.start.line,s=n.start.column,t+=" - "+o+":"+s);for(var a=Error.prototype.constructor.call(this,t),l=0;l<i.length;l++)this[i[l]]=a[i[l]];Error.captureStackTrace&&Error.captureStackTrace(this,r),n&&(this.lineNumber=o,this.column=s)}n.__esModule=!0;var i=["description","fileName","lineNumber","message","name","number","stack"];r.prototype=new Error,n["default"]=r,e.exports=n["default"]},{}],8:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){s["default"](t),l["default"](t),u["default"](t),d["default"](t),h["default"](t),v["default"](t),y["default"](t)}n.__esModule=!0,n.registerDefaultHelpers=i;var o=t("./helpers/block-helper-missing"),s=r(o),a=t("./helpers/each"),l=r(a),c=t("./helpers/helper-missing"),u=r(c),f=t("./helpers/if"),d=r(f),p=t("./helpers/log"),h=r(p),g=t("./helpers/lookup"),v=r(g),m=t("./helpers/with"),y=r(m)},{"./helpers/block-helper-missing":9,"./helpers/each":10,"./helpers/helper-missing":11,"./helpers/if":12,"./helpers/log":13,"./helpers/lookup":14,"./helpers/with":15}],9:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("../utils");n["default"]=function(t){t.registerHelper("blockHelperMissing",function(e,n){var i=n.inverse,o=n.fn;if(e===!0)return o(this);if(e===!1||null==e)return i(this);if(r.isArray(e))return e.length>0?(n.ids&&(n.ids=[n.name]),t.helpers.each(e,n)):i(this);if(n.data&&n.ids){var s=r.createFrame(n.data);s.contextPath=r.appendContextPath(n.data.contextPath,n.name),n={data:s}}return o(e,n)})},e.exports=n["default"]},{"../utils":20}],10:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}n.__esModule=!0;var i=t("../utils"),o=t("../exception"),s=r(o);n["default"]=function(t){t.registerHelper("each",function(t,e){function n(e,n,o){c&&(c.key=e,c.index=n,c.first=0===n,c.last=!!o,u&&(c.contextPath=u+e)),l+=r(t[e],{data:c,blockParams:i.blockParams([t[e],e],[u+e,null])})}if(!e)throw new s["default"]("Must pass iterator to #each");var r=e.fn,o=e.inverse,a=0,l="",c=void 0,u=void 0;if(e.data&&e.ids&&(u=i.appendContextPath(e.data.contextPath,e.ids[0])+"."),i.isFunction(t)&&(t=t.call(this)),e.data&&(c=i.createFrame(e.data)),t&&"object"==typeof t)if(i.isArray(t))for(var f=t.length;f>a;a++)a in t&&n(a,a,a===t.length-1);else{var d=void 0;for(var p in t)t.hasOwnProperty(p)&&(void 0!==d&&n(d,a-1),d=p,a++);void 0!==d&&n(d,a-1,!0)}return 0===a&&(l=o(this)),l})},e.exports=n["default"]},{"../exception":7,"../utils":20}],11:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}n.__esModule=!0;var i=t("../exception"),o=r(i);n["default"]=function(t){t.registerHelper("helperMissing",function(){if(1!==arguments.length)throw new o["default"]('Missing helper: "'+arguments[arguments.length-1].name+'"')})},e.exports=n["default"]},{"../exception":7}],12:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("../utils");n["default"]=function(t){t.registerHelper("if",function(t,e){return r.isFunction(t)&&(t=t.call(this)),!e.hash.includeZero&&!t||r.isEmpty(t)?e.inverse(this):e.fn(this)}),t.registerHelper("unless",function(e,n){return t.helpers["if"].call(this,e,{fn:n.inverse,inverse:n.fn,hash:n.hash})})},e.exports=n["default"]},{"../utils":20}],13:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]=function(t){t.registerHelper("log",function(){for(var e=[void 0],n=arguments[arguments.length-1],r=0;r<arguments.length-1;r++)e.push(arguments[r]);var i=1;null!=n.hash.level?i=n.hash.level:n.data&&null!=n.data.level&&(i=n.data.level),e[0]=i,t.log.apply(t,e)})},e.exports=n["default"]},{}],14:[function(t,e,n){"use strict";n.__esModule=!0,n["default"]=function(t){t.registerHelper("lookup",function(t,e){return t&&t[e]})},e.exports=n["default"]},{}],15:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("../utils");n["default"]=function(t){t.registerHelper("with",function(t,e){r.isFunction(t)&&(t=t.call(this));var n=e.fn;if(r.isEmpty(t))return e.inverse(this);var i=e.data;return e.data&&e.ids&&(i=r.createFrame(e.data),i.contextPath=r.appendContextPath(e.data.contextPath,e.ids[0])),n(t,{data:i,blockParams:r.blockParams([t],[i&&i.contextPath])})})},e.exports=n["default"]},{"../utils":20}],16:[function(t,e,n){"use strict";n.__esModule=!0;var r=t("./utils"),i={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function(t){if("string"==typeof t){var e=r.indexOf(i.methodMap,t.toLowerCase());t=e>=0?e:parseInt(t,10)}return t},log:function(t){if(t=i.lookupLevel(t),"undefined"!=typeof console&&i.lookupLevel(i.level)<=t){var e=i.methodMap[t];console[e]||(e="log");for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;n>o;o++)r[o-1]=arguments[o];console[e].apply(console,r)}}};n["default"]=i,e.exports=n["default"]},{"./utils":20}],17:[function(t,e,n){(function(t){"use strict";n.__esModule=!0,n["default"]=function(e){var n="undefined"!=typeof t?t:window,r=n.Handlebars;e.noConflict=function(){return n.Handlebars===e&&(n.Handlebars=r),e}},e.exports=n["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],18:[function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function i(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e["default"]=t,e}function o(t){var e=t&&t[0]||1,n=m.COMPILER_REVISION;if(e!==n){if(n>e){var r=m.REVISION_CHANGES[n],i=m.REVISION_CHANGES[e];throw new v["default"]("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new v["default"]("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+t[1]+").")}}function s(t,e){function n(n,r,i){i.hash&&(r=h.extend({},r,i.hash),i.ids&&(i.ids[0]=!0)),n=e.VM.resolvePartial.call(this,n,r,i);var o=e.VM.invokePartial.call(this,n,r,i);if(null==o&&e.compile&&(i.partials[i.name]=e.compile(n,t.compilerOptions,e),o=i.partials[i.name](r,i)),null!=o){if(i.indent){for(var s=o.split("\n"),a=0,l=s.length;l>a&&(s[a]||a+1!==l);a++)s[a]=i.indent+s[a];o=s.join("\n")}return o}throw new v["default"]("The partial "+i.name+" could not be compiled when running in runtime-only mode")}function r(e){function n(e){return""+t.main(i,e,i.helpers,i.partials,s,l,a)}var o=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],s=o.data;r._setup(o),!o.partial&&t.useData&&(s=f(e,s));var a=void 0,l=t.useBlockParams?[]:void 0;return t.useDepths&&(a=o.depths?e!==o.depths[0]?[e].concat(o.depths):o.depths:[e]),(n=d(t.main,n,i,o.depths||[],s,l))(e,o)}if(!e)throw new v["default"]("No environment passed to template");if(!t||!t.main)throw new v["default"]("Unknown template object: "+typeof t);t.main.decorator=t.main_d,e.VM.checkRevision(t.compiler);var i={strict:function(t,e){if(!(e in t))throw new v["default"]('"'+e+'" not defined in '+t);return t[e]},lookup:function(t,e){for(var n=t.length,r=0;n>r;r++)if(t[r]&&null!=t[r][e])return t[r][e]},lambda:function(t,e){return"function"==typeof t?t.call(e):t},escapeExpression:h.escapeExpression,invokePartial:n,fn:function(e){var n=t[e];return n.decorator=t[e+"_d"],n},programs:[],program:function(t,e,n,r,i){var o=this.programs[t],s=this.fn(t);return e||i||r||n?o=a(this,t,s,e,n,r,i):o||(o=this.programs[t]=a(this,t,s)),o},data:function(t,e){for(;t&&e--;)t=t._parent;return t},merge:function(t,e){var n=t||e;return t&&e&&t!==e&&(n=h.extend({},e,t)),n},noop:e.VM.noop,compilerInfo:t.compiler};return r.isTop=!0,r._setup=function(n){n.partial?(i.helpers=n.helpers,i.partials=n.partials,i.decorators=n.decorators):(i.helpers=i.merge(n.helpers,e.helpers),t.usePartial&&(i.partials=i.merge(n.partials,e.partials)),(t.usePartial||t.useDecorators)&&(i.decorators=i.merge(n.decorators,e.decorators)))},r._child=function(e,n,r,o){if(t.useBlockParams&&!r)throw new v["default"]("must pass block params");if(t.useDepths&&!o)throw new v["default"]("must pass parent depths");return a(i,e,t[e],n,0,r,o)},r}function a(t,e,n,r,i,o,s){function a(e){var i=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],a=s;return s&&e!==s[0]&&(a=[e].concat(s)),n(t,e,t.helpers,t.partials,i.data||r,o&&[i.blockParams].concat(o),a)}return a=d(n,a,t,s,r,o),a.program=e,a.depth=s?s.length:0,a.blockParams=i||0,a}function l(t,e,n){return t?t.call||n.name||(n.name=t,t=n.partials[t]):t="@partial-block"===n.name?n.data["partial-block"]:n.partials[n.name],t}function c(t,e,n){n.partial=!0,n.ids&&(n.data.contextPath=n.ids[0]||n.data.contextPath);var r=void 0;if(n.fn&&n.fn!==u&&(n.data=m.createFrame(n.data),r=n.data["partial-block"]=n.fn,r.partials&&(n.partials=h.extend({},n.partials,r.partials))),void 0===t&&r&&(t=r),void 0===t)throw new v["default"]("The partial "+n.name+" could not be found");return t instanceof Function?t(e,n):void 0}function u(){return""}function f(t,e){return e&&"root"in e||(e=e?m.createFrame(e):{},e.root=t),e}function d(t,e,n,r,i,o){if(t.decorator){var s={};e=t.decorator(e,s,n,r&&r[0],i,o,r),h.extend(e,s)}return e}n.__esModule=!0,n.checkRevision=o,n.template=s,n.wrapProgram=a,n.resolvePartial=l,n.invokePartial=c,n.noop=u;var p=t("./utils"),h=i(p),g=t("./exception"),v=r(g),m=t("./base")},{"./base":4,"./exception":7,"./utils":20}],19:[function(t,e,n){"use strict";function r(t){this.string=t}n.__esModule=!0,r.prototype.toString=r.prototype.toHTML=function(){return""+this.string},n["default"]=r,e.exports=n["default"]},{}],20:[function(t,e,n){"use strict";function r(t){return f[t]}function i(t){for(var e=1;e<arguments.length;e++)for(var n in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],n)&&(t[n]=arguments[e][n]);return t}function o(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}function s(t){if("string"!=typeof t){if(t&&t.toHTML)return t.toHTML();if(null==t)return"";if(!t)return t+"";t=""+t}return p.test(t)?t.replace(d,r):t}function a(t){return t||0===t?!(!v(t)||0!==t.length):!0}function l(t){var e=i({},t);return e._parent=t,e}function c(t,e){return t.path=e,t}function u(t,e){return(t?t+".":"")+e}n.__esModule=!0,n.extend=i,n.indexOf=o,n.escapeExpression=s,n.isEmpty=a,n.createFrame=l,n.blockParams=c,n.appendContextPath=u;var f={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"},d=/[&<>"'`=]/g,p=/[&<>"'`=]/,h=Object.prototype.toString;n.toString=h;var g=function(t){return"function"==typeof t};g(/x/)&&(n.isFunction=g=function(t){return"function"==typeof t&&"[object Function]"===h.call(t)}),n.isFunction=g;var v=Array.isArray||function(t){return t&&"object"==typeof t?"[object Array]"===h.call(t):!1};n.isArray=v},{}],21:[function(t,e,n){e.exports=t("./dist/cjs/handlebars.runtime")["default"]},{"./dist/cjs/handlebars.runtime":3}],22:[function(t,e,n){(function(n){e.exports=t(n.env.MEDIATOR_JS_COV?"./lib-cov/mediator":"./lib/mediator")}).call(this,t("_process"))},{"./lib-cov/mediator":23,"./lib/mediator":24,_process:2}],23:[function(t,e,n){try{"object"==typeof top&&null!==top&&"object"==typeof top.opener&&null!==top.opener&&(top.opener._$jscoverage||(top.opener._$jscoverage={}))}catch(r){}try{if("object"==typeof top&&null!==top){try{"object"==typeof top.opener&&null!==top.opener&&top.opener._$jscoverage&&(top._$jscoverage=top.opener._$jscoverage)}catch(r){}top._$jscoverage||(top._$jscoverage={})}}catch(r){}try{"object"==typeof top&&null!==top&&top._$jscoverage&&(_$jscoverage=top._$jscoverage)}catch(r){}"object"!=typeof _$jscoverage&&(_$jscoverage={}),_$jscoverage["mediator.js"]||(_$jscoverage["mediator.js"]=[],_$jscoverage["mediator.js"][16]=0,_$jscoverage["mediator.js"][17]=0,_$jscoverage["mediator.js"][19]=0,_$jscoverage["mediator.js"][21]=0,_$jscoverage["mediator.js"][22]=0,_$jscoverage["mediator.js"][24]=0,_$jscoverage["mediator.js"][26]=0,_$jscoverage["mediator.js"][30]=0,_$jscoverage["mediator.js"][33]=0,_$jscoverage["mediator.js"][39]=0,_$jscoverage["mediator.js"][40]=0,_$jscoverage["mediator.js"][41]=0,_$jscoverage["mediator.js"][44]=0,_$jscoverage["mediator.js"][52]=0,_$jscoverage["mediator.js"][53]=0,_$jscoverage["mediator.js"][54]=0,_$jscoverage["mediator.js"][57]=0,_$jscoverage["mediator.js"][58]=0,_$jscoverage["mediator.js"][59]=0,_$jscoverage["mediator.js"][60]=0,_$jscoverage["mediator.js"][61]=0,_$jscoverage["mediator.js"][64]=0,_$jscoverage["mediator.js"][70]=0,_$jscoverage["mediator.js"][71]=0,_$jscoverage["mediator.js"][72]=0,_$jscoverage["mediator.js"][73]=0,_$jscoverage["mediator.js"][74]=0,_$jscoverage["mediator.js"][75]=0,_$jscoverage["mediator.js"][82]=0,_$jscoverage["mediator.js"][83]=0,_$jscoverage["mediator.js"][84]=0,_$jscoverage["mediator.js"][87]=0,_$jscoverage["mediator.js"][88]=0,_$jscoverage["mediator.js"][89]=0,_$jscoverage["mediator.js"][90]=0,_$jscoverage["mediator.js"][91]=0,_$jscoverage["mediator.js"][100]=0,_$jscoverage["mediator.js"][102]=0,_$jscoverage["mediator.js"][104]=0,_$jscoverage["mediator.js"][108]=0,_$jscoverage["mediator.js"][110]=0,_$jscoverage["mediator.js"][111]=0,_$jscoverage["mediator.js"][113]=0,_$jscoverage["mediator.js"][115]=0,_$jscoverage["mediator.js"][118]=0,_$jscoverage["mediator.js"][120]=0,_$jscoverage["mediator.js"][127]=0,_$jscoverage["mediator.js"][131]=0,_$jscoverage["mediator.js"][134]=0,_$jscoverage["mediator.js"][135]=0,_$jscoverage["mediator.js"][136]=0,_$jscoverage["mediator.js"][146]=0,_$jscoverage["mediator.js"][150]=0,_$jscoverage["mediator.js"][151]=0,_$jscoverage["mediator.js"][152]=0,_$jscoverage["mediator.js"][154]=0,_$jscoverage["mediator.js"][157]=0,_$jscoverage["mediator.js"][158]=0,_$jscoverage["mediator.js"][159]=0,_$jscoverage["mediator.js"][161]=0,_$jscoverage["mediator.js"][162]=0,_$jscoverage["mediator.js"][166]=0,_$jscoverage["mediator.js"][170]=0,_$jscoverage["mediator.js"][174]=0,_$jscoverage["mediator.js"][178]=0,_$jscoverage["mediator.js"][180]=0,_$jscoverage["mediator.js"][183]=0,_$jscoverage["mediator.js"][184]=0,_$jscoverage["mediator.js"][185]=0,_$jscoverage["mediator.js"][189]=0,_$jscoverage["mediator.js"][190]=0,_$jscoverage["mediator.js"][191]=0,_$jscoverage["mediator.js"][192]=0,_$jscoverage["mediator.js"][201]=0,_$jscoverage["mediator.js"][207]=0,_$jscoverage["mediator.js"][208]=0,_$jscoverage["mediator.js"][209]=0,_$jscoverage["mediator.js"][210]=0,_$jscoverage["mediator.js"][211]=0,_$jscoverage["mediator.js"][212]=0,_$jscoverage["mediator.js"][213]=0,_$jscoverage["mediator.js"][216]=0,_$jscoverage["mediator.js"][217]=0,_$jscoverage["mediator.js"][221]=0,_$jscoverage["mediator.js"][222]=0,_$jscoverage["mediator.js"][224]=0,_$jscoverage["mediator.js"][225]=0,_$jscoverage["mediator.js"][227]=0,_$jscoverage["mediator.js"][232]=0,_$jscoverage["mediator.js"][233]=0,_$jscoverage["mediator.js"][236]=0,_$jscoverage["mediator.js"][240]=0,_$jscoverage["mediator.js"][241]=0,_$jscoverage["mediator.js"][242]=0,_$jscoverage["mediator.js"][245]=0,_$jscoverage["mediator.js"][251]=0,_$jscoverage["mediator.js"][257]=0,_$jscoverage["mediator.js"][262]=0,_$jscoverage["mediator.js"][263]=0,_$jscoverage["mediator.js"][266]=0,_$jscoverage["mediator.js"][267]=0,_$jscoverage["mediator.js"][269]=0,_$jscoverage["mediator.js"][270]=0,_$jscoverage["mediator.js"][273]=0,_$jscoverage["mediator.js"][277]=0,_$jscoverage["mediator.js"][287]=0,_$jscoverage["mediator.js"][289]=0,_$jscoverage["mediator.js"][290]=0,_$jscoverage["mediator.js"][292]=0,_$jscoverage["mediator.js"][302]=0,_$jscoverage["mediator.js"][303]=0,_$jscoverage["mediator.js"][305]=0,_$jscoverage["mediator.js"][312]=0,_$jscoverage["mediator.js"][319]=0,_$jscoverage["mediator.js"][328]=0,_$jscoverage["mediator.js"][331]=0,_$jscoverage["mediator.js"][333]=0,_$jscoverage["mediator.js"][338]=0,_$jscoverage["mediator.js"][339]=0,_$jscoverage["mediator.js"][340]=0,_$jscoverage["mediator.js"][341]=0,_$jscoverage["mediator.js"][342]=0,_$jscoverage["mediator.js"][346]=0,_$jscoverage["mediator.js"][347]=0,_$jscoverage["mediator.js"][348]=0),_$jscoverage["mediator.js"].source=["/*jslint bitwise: true, nomen: true, plusplus: true, white: true */","","/*!","* Mediator.js Library v0.9.0","* https://github.com/ajacksified/Mediator.js","*","* Copyright 2013, Jack Lawson","* MIT Licensed (http://www.opensource.org/licenses/mit-license.php)","*","* For more information: http://thejacklawson.com/2011/06/mediators-for-modularized-asynchronous-programming-in-javascript/index.html","* Project on GitHub: https://github.com/ajacksified/Mediator.js","*","* Last update: Jan 04 2013","*/","","(function(root, factory) {","  'use strict';","","  if(typeof root.exports === 'function') {","    // Node/CommonJS","    root.exports.Mediator = factory();","  } else if(typeof root.define === 'function' &amp;&amp; root.define.amd) {","    // AMD","    root.define([], function() {","      // Export to global too, for backward compatiblity","      root.Mediator = factory();","    });","  } else {","    // Browser global","    root.Mediator = factory();","  }","}(this, function() {","  'use strict';","","  // We'll generate guids for class instances for easy referencing later on.","  // Subscriber instances will have an id that can be refernced for quick","  // lookups.","","  function guidGenerator() {","    var S4 = function() {","       return (((1+Math.random())*0x10000)|0).toString(16).substring(1);","    };","",'    return (S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4());',"  }","","  // Subscribers are instances of Mediator Channel registrations. We generate","  // an object instance so that it can be updated later on without having to","  // unregister and re-register. Subscribers are constructed with a function","  // to be called, options object, and context.","","  function Subscriber(fn, options, context){","    if(!(this instanceof Subscriber)) {","      return new Subscriber(fn, options, context);","    }","","    this.id = guidGenerator();","    this.fn = fn;","    this.options = options;","    this.context = context;","    this.channel = null;","  }","","  Subscriber.prototype = {","    // Mediator.update on a subscriber instance can update its function,context,","    // or options object. It takes in an object and looks for fn, context, or","    // options keys.","","    update: function(options){","      if(options){","        this.fn = options.fn || this.fn;","        this.context = options.context || this.context;","        this.options = options.options || this.options;","        if(this.channel &amp;&amp; this.options &amp;&amp; this.options.priority !== undefined) {","            this.channel.setPriority(this.id, this.options.priority);","        }","      }","    }","  };","","","  function Channel(namespace, parent){","    if(!(this instanceof Channel)) {","      return new Channel(namespace);","    }","",'    this.namespace = namespace || "";',"    this._subscribers = [];","    this._channels = [];","    this._parent = parent;","    this.stopped = false;","  }","","  // A Mediator channel holds a list of sub-channels and subscribers to be fired","  // when Mediator.publish is called on the Mediator instance. It also contains","  // some methods to manipulate its lists of data; only setPriority and","  // StopPropagation are meant to be used. The other methods should be accessed","  // through the Mediator instance.","","  Channel.prototype = {","    addSubscriber: function(fn, options, context){","      var subscriber = new Subscriber(fn, options, context);","","      if(options &amp;&amp; options.priority !== undefined){","        // Cheap hack to either parse as an int or turn it into 0. Runs faster","        // in many browsers than parseInt with the benefit that it won't","        // return a NaN.","        options.priority = options.priority &gt;&gt; 0;","","        if(options.priority &lt; 0){ options.priority = 0; }","        if(options.priority &gt;= this._subscribers.length){ options.priority = this._subscribers.length-1; }","","        this._subscribers.splice(options.priority, 0, subscriber);","      }else{","        this._subscribers.push(subscriber);","      }","","      subscriber.channel = this;","","      return subscriber;","    },","","    // The channel instance is passed as an argument to the mediator subscriber,","    // and further subscriber propagation can be called with","    // channel.StopPropagation().","    stopPropagation: function(){","      this.stopped = true;","    },","","    getSubscriber: function(identifier){","      var x = 0,","          y = this._subscribers.length;","","      for(x, y; x &lt; y; x++){","        if(this._subscribers[x].id === identifier || this._subscribers[x].fn === identifier){","          return this._subscribers[x];","        }","      }","    },","","    // Channel.setPriority is useful in updating the order in which Subscribers","    // are called, and takes an identifier (subscriber id or named function) and","    // an array index. It will not search recursively through subchannels.","","    setPriority: function(identifier, priority){","      var oldIndex = 0,","          x = 0,","          sub, firstHalf, lastHalf, y;","","      for(x = 0, y = this._subscribers.length; x &lt; y; x++){","        if(this._subscribers[x].id === identifier || this._subscribers[x].fn === identifier){","          break;","        }","        oldIndex ++;","      }","","      sub = this._subscribers[oldIndex];","      firstHalf = this._subscribers.slice(0, oldIndex);","      lastHalf = this._subscribers.slice(oldIndex+1);","","      this._subscribers = firstHalf.concat(lastHalf);","      this._subscribers.splice(priority, 0, sub);","    },","","    addChannel: function(channel){","      this._channels[channel] = new Channel((this.namespace ? this.namespace + ':' : '') + channel, this);","    },","","    hasChannel: function(channel){","      return this._channels.hasOwnProperty(channel);","    },","","    returnChannel: function(channel){","      return this._channels[channel];","    },","","    removeSubscriber: function(identifier){","      var x = 0,","          y;","          y = this._subscribers.length;","","      // If we don't pass in an id, we're clearing all","      if(!identifier){","        this._subscribers = [];","        return;","      }","","      // Going backwards makes splicing a whole lot easier.","      for(x, y; y &gt; x; y--) {","        if(this._subscribers[x].fn === identifier || this._subscribers[x].id === identifier){","          this._subscribers[x].channel = null;","          this._subscribers.splice(x,1);","        }","      }","    },","","    // This will publish arbitrary arguments to a subscriber and then to parent","    // channels.","","    publish: function(data){","      var x = 0,","          y = this._subscribers.length,","          called = false,","          subscriber, l;","","      // Priority is preserved in the _subscribers index.","      for(x, y; x &lt; y; x++) {","        if(!this.stopped){","          subscriber = this._subscribers[x];",'          if(subscriber.options !== undefined &amp;&amp; typeof subscriber.options.predicate === "function"){',"            if(subscriber.options.predicate.apply(subscriber.context, data)){","              subscriber.fn.apply(subscriber.context, data);","              called = true;","            }","          }else{","            subscriber.fn.apply(subscriber.context, data);","            called = true;","          }","        }","","        if(called &amp;&amp; subscriber.options &amp;&amp; subscriber.options !== undefined){","          subscriber.options.calls--;","","          if(subscriber.options.calls &lt; 1){","            this.removeSubscriber(subscriber.id);","          }else{","            subscriber.update(subscriber.options);","          }","        }","      }","","      if(this._parent){","        this._parent.publish(data);","      }","","      this.stopped = false;","    }","  };","","  function Mediator() {","    if(!(this instanceof Mediator)) {","      return new Mediator();","    }","","    this._channels = new Channel('');","  }","","  // A Mediator instance is the interface through which events are registered","  // and removed from publish channels.","","  Mediator.prototype = {","","    // Returns a channel instance based on namespace, for example","    // application:chat:message:received","","    getChannel: function(namespace){","      var channel = this._channels,","          namespaceHierarchy = namespace.split(':'),","          x = 0, ","          y = namespaceHierarchy.length;","","      if(namespace === ''){","        return channel;","      }","","      if(namespaceHierarchy.length &gt; 0){","        for(x, y; x &lt; y; x++){","","          if(!channel.hasChannel(namespaceHierarchy[x])){","            channel.addChannel(namespaceHierarchy[x]);","          }","","          channel = channel.returnChannel(namespaceHierarchy[x]);","        }","      }","","      return channel;","    },","","    // Pass in a channel namespace, function to be called, options, and context","    // to call the function in to Subscribe. It will create a channel if one","    // does not exist. Options can include a predicate to determine if it","    // should be called (based on the data published to it) and a priority","    // index.","","    subscribe: function(channelName, fn, options, context){","      var channel = this.getChannel(channelName);","","      options = options || {};","      context = context || {};","","      return channel.addSubscriber(fn, options, context);","    },","","    // Pass in a channel namespace, function to be called, options, and context","    // to call the function in to Subscribe. It will create a channel if one","    // does not exist. Options can include a predicate to determine if it","    // should be called (based on the data published to it) and a priority","    // index.","","    once: function(channelName, fn, options, context){","      options = options || {};","      options.calls = 1;","","      return this.subscribe(channelName, fn, options, context);","    },","","    // Returns a subscriber for a given subscriber id / named function and","    // channel namespace","","    getSubscriber: function(identifier, channel){",'      return this.getChannel(channel || "").getSubscriber(identifier);',"    },","","    // Remove a subscriber from a given channel namespace recursively based on","    // a passed-in subscriber id or named function.","","    remove: function(channelName, identifier){","      this.getChannel(channelName).removeSubscriber(identifier);","    },","","    // Publishes arbitrary data to a given channel namespace. Channels are","    // called recursively downwards; a post to application:chat will post to","    // application:chat:receive and application:chat:derp:test:beta:bananas.",'    // Called using Mediator.publish("application:chat", [ args ]);',"","    publish: function(channelName){","      var args = Array.prototype.slice.call(arguments, 1),","          channel = this.getChannel(channelName);","","      args.push(channel);","","      this.getChannel(channelName).publish(args);","    }","  };","","  // Alias some common names for easy interop","  Mediator.prototype.on = Mediator.prototype.subscribe;","  Mediator.prototype.bind = Mediator.prototype.subscribe;","  Mediator.prototype.emit = Mediator.prototype.publish;","  Mediator.prototype.trigger = Mediator.prototype.publish;","  Mediator.prototype.off = Mediator.prototype.remove;","","  // Finally, expose it all.","","  Mediator.Channel = Channel;","  Mediator.Subscriber = Subscriber;","  return Mediator;","}));"],
_$jscoverage["mediator.js"][16]++,function(t,e){_$jscoverage["mediator.js"][17]++,_$jscoverage["mediator.js"][19]++,"function"==typeof t.exports?(_$jscoverage["mediator.js"][21]++,t.exports.Mediator=e()):(_$jscoverage["mediator.js"][22]++,"function"==typeof t.define&&t.define.amd?(_$jscoverage["mediator.js"][24]++,t.define([],function(){_$jscoverage["mediator.js"][26]++,t.Mediator=e()})):(_$jscoverage["mediator.js"][30]++,t.Mediator=e()))}(this,function(){function t(){_$jscoverage["mediator.js"][40]++;var t=function(){return _$jscoverage["mediator.js"][41]++,(65536*(1+Math.random())|0).toString(16).substring(1)};return _$jscoverage["mediator.js"][44]++,t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function e(n,r,i){return _$jscoverage["mediator.js"][53]++,this instanceof e?(_$jscoverage["mediator.js"][57]++,this.id=t(),_$jscoverage["mediator.js"][58]++,this.fn=n,_$jscoverage["mediator.js"][59]++,this.options=r,_$jscoverage["mediator.js"][60]++,this.context=i,_$jscoverage["mediator.js"][61]++,void(this.channel=null)):(_$jscoverage["mediator.js"][54]++,new e(n,r,i))}function n(t,e){return _$jscoverage["mediator.js"][83]++,this instanceof n?(_$jscoverage["mediator.js"][87]++,this.namespace=t||"",_$jscoverage["mediator.js"][88]++,this._subscribers=[],_$jscoverage["mediator.js"][89]++,this._channels=[],_$jscoverage["mediator.js"][90]++,this._parent=e,_$jscoverage["mediator.js"][91]++,void(this.stopped=!1)):(_$jscoverage["mediator.js"][84]++,new n(t))}function r(){return _$jscoverage["mediator.js"][241]++,this instanceof r?(_$jscoverage["mediator.js"][245]++,void(this._channels=new n(""))):(_$jscoverage["mediator.js"][242]++,new r)}return _$jscoverage["mediator.js"][33]++,_$jscoverage["mediator.js"][39]++,_$jscoverage["mediator.js"][52]++,_$jscoverage["mediator.js"][64]++,e.prototype={update:function(t){_$jscoverage["mediator.js"][70]++,t&&(_$jscoverage["mediator.js"][71]++,this.fn=t.fn||this.fn,_$jscoverage["mediator.js"][72]++,this.context=t.context||this.context,_$jscoverage["mediator.js"][73]++,this.options=t.options||this.options,_$jscoverage["mediator.js"][74]++,this.channel&&this.options&&void 0!==this.options.priority&&(_$jscoverage["mediator.js"][75]++,this.channel.setPriority(this.id,this.options.priority)))}},_$jscoverage["mediator.js"][82]++,_$jscoverage["mediator.js"][100]++,n.prototype={addSubscriber:function(t,n,r){_$jscoverage["mediator.js"][102]++;var i=new e(t,n,r);return _$jscoverage["mediator.js"][104]++,n&&void 0!==n.priority?(_$jscoverage["mediator.js"][108]++,n.priority=n.priority>>0,_$jscoverage["mediator.js"][110]++,n.priority<0&&(_$jscoverage["mediator.js"][110]++,n.priority=0),_$jscoverage["mediator.js"][111]++,n.priority>=this._subscribers.length&&(_$jscoverage["mediator.js"][111]++,n.priority=this._subscribers.length-1),_$jscoverage["mediator.js"][113]++,this._subscribers.splice(n.priority,0,i)):(_$jscoverage["mediator.js"][115]++,this._subscribers.push(i)),_$jscoverage["mediator.js"][118]++,i.channel=this,_$jscoverage["mediator.js"][120]++,i},stopPropagation:function(){_$jscoverage["mediator.js"][127]++,this.stopped=!0},getSubscriber:function(t){_$jscoverage["mediator.js"][131]++;var e=0,n=this._subscribers.length;for(_$jscoverage["mediator.js"][134]++,n;n>e;e++)if(_$jscoverage["mediator.js"][135]++,this._subscribers[e].id===t||this._subscribers[e].fn===t)return _$jscoverage["mediator.js"][136]++,this._subscribers[e]},setPriority:function(t,e){_$jscoverage["mediator.js"][146]++;var n,r,i,o,s=0,a=0;for(_$jscoverage["mediator.js"][150]++,a=0,o=this._subscribers.length;o>a;a++){if(_$jscoverage["mediator.js"][151]++,this._subscribers[a].id===t||this._subscribers[a].fn===t){_$jscoverage["mediator.js"][152]++;break}_$jscoverage["mediator.js"][154]++,s++}_$jscoverage["mediator.js"][157]++,n=this._subscribers[s],_$jscoverage["mediator.js"][158]++,r=this._subscribers.slice(0,s),_$jscoverage["mediator.js"][159]++,i=this._subscribers.slice(s+1),_$jscoverage["mediator.js"][161]++,this._subscribers=r.concat(i),_$jscoverage["mediator.js"][162]++,this._subscribers.splice(e,0,n)},addChannel:function(t){_$jscoverage["mediator.js"][166]++,this._channels[t]=new n((this.namespace?this.namespace+":":"")+t,this)},hasChannel:function(t){return _$jscoverage["mediator.js"][170]++,this._channels.hasOwnProperty(t)},returnChannel:function(t){return _$jscoverage["mediator.js"][174]++,this._channels[t]},removeSubscriber:function(t){_$jscoverage["mediator.js"][178]++;var e,n=0;if(_$jscoverage["mediator.js"][180]++,e=this._subscribers.length,_$jscoverage["mediator.js"][183]++,!t)return _$jscoverage["mediator.js"][184]++,this._subscribers=[],void _$jscoverage["mediator.js"][185]++;for(_$jscoverage["mediator.js"][189]++,e;e>n;e--)_$jscoverage["mediator.js"][190]++,this._subscribers[n].fn!==t&&this._subscribers[n].id!==t||(_$jscoverage["mediator.js"][191]++,this._subscribers[n].channel=null,_$jscoverage["mediator.js"][192]++,this._subscribers.splice(n,1))},publish:function(t){_$jscoverage["mediator.js"][201]++;var e,n=0,r=this._subscribers.length,i=!1;for(_$jscoverage["mediator.js"][207]++,r;r>n;n++)_$jscoverage["mediator.js"][208]++,this.stopped||(_$jscoverage["mediator.js"][209]++,e=this._subscribers[n],_$jscoverage["mediator.js"][210]++,void 0!==e.options&&"function"==typeof e.options.predicate?(_$jscoverage["mediator.js"][211]++,e.options.predicate.apply(e.context,t)&&(_$jscoverage["mediator.js"][212]++,e.fn.apply(e.context,t),_$jscoverage["mediator.js"][213]++,i=!0)):(_$jscoverage["mediator.js"][216]++,e.fn.apply(e.context,t),_$jscoverage["mediator.js"][217]++,i=!0)),_$jscoverage["mediator.js"][221]++,i&&e.options&&void 0!==e.options&&(_$jscoverage["mediator.js"][222]++,e.options.calls--,_$jscoverage["mediator.js"][224]++,e.options.calls<1?(_$jscoverage["mediator.js"][225]++,this.removeSubscriber(e.id)):(_$jscoverage["mediator.js"][227]++,e.update(e.options)));_$jscoverage["mediator.js"][232]++,this._parent&&(_$jscoverage["mediator.js"][233]++,this._parent.publish(t)),_$jscoverage["mediator.js"][236]++,this.stopped=!1}},_$jscoverage["mediator.js"][240]++,_$jscoverage["mediator.js"][251]++,r.prototype={getChannel:function(t){_$jscoverage["mediator.js"][257]++;var e=this._channels,n=t.split(":"),r=0,i=n.length;if(_$jscoverage["mediator.js"][262]++,""===t)return _$jscoverage["mediator.js"][263]++,e;if(_$jscoverage["mediator.js"][266]++,n.length>0)for(_$jscoverage["mediator.js"][267]++,i;i>r;r++)_$jscoverage["mediator.js"][269]++,e.hasChannel(n[r])||(_$jscoverage["mediator.js"][270]++,e.addChannel(n[r])),_$jscoverage["mediator.js"][273]++,e=e.returnChannel(n[r]);return _$jscoverage["mediator.js"][277]++,e},subscribe:function(t,e,n,r){_$jscoverage["mediator.js"][287]++;var i=this.getChannel(t);return _$jscoverage["mediator.js"][289]++,n=n||{},_$jscoverage["mediator.js"][290]++,r=r||{},_$jscoverage["mediator.js"][292]++,i.addSubscriber(e,n,r)},once:function(t,e,n,r){return _$jscoverage["mediator.js"][302]++,n=n||{},_$jscoverage["mediator.js"][303]++,n.calls=1,_$jscoverage["mediator.js"][305]++,this.subscribe(t,e,n,r)},getSubscriber:function(t,e){return _$jscoverage["mediator.js"][312]++,this.getChannel(e||"").getSubscriber(t)},remove:function(t,e){_$jscoverage["mediator.js"][319]++,this.getChannel(t).removeSubscriber(e)},publish:function(t){_$jscoverage["mediator.js"][328]++;var e=Array.prototype.slice.call(arguments,1),n=this.getChannel(t);_$jscoverage["mediator.js"][331]++,e.push(n),_$jscoverage["mediator.js"][333]++,this.getChannel(t).publish(e)}},_$jscoverage["mediator.js"][338]++,r.prototype.on=r.prototype.subscribe,_$jscoverage["mediator.js"][339]++,r.prototype.bind=r.prototype.subscribe,_$jscoverage["mediator.js"][340]++,r.prototype.emit=r.prototype.publish,_$jscoverage["mediator.js"][341]++,r.prototype.trigger=r.prototype.publish,_$jscoverage["mediator.js"][342]++,r.prototype.off=r.prototype.remove,_$jscoverage["mediator.js"][346]++,r.Channel=n,_$jscoverage["mediator.js"][347]++,r.Subscriber=e,_$jscoverage["mediator.js"][348]++,r})},{}],24:[function(e,n,r){!function(e,n){"use strict";"function"==typeof t&&t.amd?t("mediator-js",[],function(){return e.Mediator=n(),e.Mediator}):"undefined"!=typeof r?r.Mediator=n():e.Mediator=n()}(this,function(){"use strict";function t(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function e(n,r,i){return this instanceof e?(this.id=t(),this.fn=n,this.options=r,this.context=i,void(this.channel=null)):new e(n,r,i)}function n(t,e){return this instanceof n?(this.namespace=t||"",this._subscribers=[],this._channels={},this._parent=e,void(this.stopped=!1)):new n(t)}function r(){return this instanceof r?void(this._channels=new n("")):new r}return e.prototype.update=function(t){t&&(this.fn=t.fn||this.fn,this.context=t.context||this.context,this.options=t.options||this.options,this.channel&&this.options&&void 0!==this.options.priority&&this.channel.setPriority(this.id,this.options.priority))},n.prototype.addSubscriber=function(t,n,r){var i=new e(t,n,r);return n&&void 0!==n.priority?(n.priority=n.priority>>0,n.priority<0&&(n.priority=0),n.priority>=this._subscribers.length&&(n.priority=this._subscribers.length-1),this._subscribers.splice(n.priority,0,i)):this._subscribers.push(i),i.channel=this,i},n.prototype.stopPropagation=function(){this.stopped=!0},n.prototype.getSubscriber=function(t){var e=0,n=this._subscribers.length;for(n;n>e;e++)if(this._subscribers[e].id===t||this._subscribers[e].fn===t)return this._subscribers[e]},n.prototype.setPriority=function(t,e){var n,r,i,o,s=0,a=0;for(a=0,o=this._subscribers.length;o>a&&(this._subscribers[a].id!==t&&this._subscribers[a].fn!==t);a++)s++;n=this._subscribers[s],r=this._subscribers.slice(0,s),i=this._subscribers.slice(s+1),this._subscribers=r.concat(i),this._subscribers.splice(e,0,n)},n.prototype.addChannel=function(t){this._channels[t]=new n((this.namespace?this.namespace+":":"")+t,this)},n.prototype.hasChannel=function(t){return this._channels.hasOwnProperty(t)},n.prototype.returnChannel=function(t){return this._channels[t]},n.prototype.removeSubscriber=function(t){var e=this._subscribers.length-1;if(!t)return void(this._subscribers=[]);for(e;e>=0;e--)this._subscribers[e].fn!==t&&this._subscribers[e].id!==t||(this._subscribers[e].channel=null,this._subscribers.splice(e,1))},n.prototype.publish=function(t){var e,n,r,i=0,o=this._subscribers.length,s=!1;for(o;o>i;i++)s=!1,e=this._subscribers[i],this.stopped||(n=this._subscribers.length,void 0!==e.options&&"function"==typeof e.options.predicate?e.options.predicate.apply(e.context,t)&&(s=!0):s=!0),s&&(e.options&&void 0!==e.options.calls&&(e.options.calls--,e.options.calls<1&&this.removeSubscriber(e.id)),e.fn.apply(e.context,t),r=this._subscribers.length,o=r,r===n-1&&i--);this._parent&&this._parent.publish(t),this.stopped=!1},r.prototype.getChannel=function(t,e){var n=this._channels,r=t.split(":"),i=0,o=r.length;if(""===t)return n;if(r.length>0)for(o;o>i;i++){if(!n.hasChannel(r[i])){if(e)break;n.addChannel(r[i])}n=n.returnChannel(r[i])}return n},r.prototype.subscribe=function(t,e,n,r){var i=this.getChannel(t||"",!1);return n=n||{},r=r||{},i.addSubscriber(e,n,r)},r.prototype.once=function(t,e,n,r){return n=n||{},n.calls=1,this.subscribe(t,e,n,r)},r.prototype.getSubscriber=function(t,e){var n=this.getChannel(e||"",!0);return n.namespace!==e?null:n.getSubscriber(t)},r.prototype.remove=function(t,e){var n=this.getChannel(t||"",!0);return n.namespace!==t?!1:void n.removeSubscriber(e)},r.prototype.publish=function(t){var e=this.getChannel(t||"",!0);if(e.namespace!==t)return null;var n=Array.prototype.slice.call(arguments,1);n.push(e),e.publish(n)},r.prototype.on=r.prototype.subscribe,r.prototype.bind=r.prototype.subscribe,r.prototype.emit=r.prototype.publish,r.prototype.trigger=r.prototype.publish,r.prototype.off=r.prototype.remove,r.Channel=n,r.Subscriber=e,r.version="0.9.8",r})},{}],25:[function(e,n,r){!function(e){var r,i,o="0.4.2",s="hasOwnProperty",a=/[\.\/]/,l=/\s*,\s*/,c="*",u=function(t,e){return t-e},f={n:{}},d=function(){for(var t=0,e=this.length;e>t;t++)if("undefined"!=typeof this[t])return this[t]},p=function(){for(var t=this.length;--t;)if("undefined"!=typeof this[t])return this[t]},h=function(t,e){t=String(t);var n,o=i,s=Array.prototype.slice.call(arguments,2),a=h.listeners(t),l=0,c=[],f={},g=[],v=r;g.firstDefined=d,g.lastDefined=p,r=t,i=0;for(var m=0,y=a.length;y>m;m++)"zIndex"in a[m]&&(c.push(a[m].zIndex),a[m].zIndex<0&&(f[a[m].zIndex]=a[m]));for(c.sort(u);c[l]<0;)if(n=f[c[l++]],g.push(n.apply(e,s)),i)return i=o,g;for(m=0;y>m;m++)if(n=a[m],"zIndex"in n)if(n.zIndex==c[l]){if(g.push(n.apply(e,s)),i)break;do if(l++,n=f[c[l]],n&&g.push(n.apply(e,s)),i)break;while(n)}else f[n.zIndex]=n;else if(g.push(n.apply(e,s)),i)break;return i=o,r=v,g};h._events=f,h.listeners=function(t){var e,n,r,i,o,s,l,u,d=t.split(a),p=f,h=[p],g=[];for(i=0,o=d.length;o>i;i++){for(u=[],s=0,l=h.length;l>s;s++)for(p=h[s].n,n=[p[d[i]],p[c]],r=2;r--;)e=n[r],e&&(u.push(e),g=g.concat(e.f||[]));h=u}return g},h.on=function(t,e){if(t=String(t),"function"!=typeof e)return function(){};for(var n=t.split(l),r=0,i=n.length;i>r;r++)!function(t){for(var n,r=t.split(a),i=f,o=0,s=r.length;s>o;o++)i=i.n,i=i.hasOwnProperty(r[o])&&i[r[o]]||(i[r[o]]={n:{}});for(i.f=i.f||[],o=0,s=i.f.length;s>o;o++)if(i.f[o]==e){n=!0;break}!n&&i.f.push(e)}(n[r]);return function(t){+t==+t&&(e.zIndex=+t)}},h.f=function(t){var e=[].slice.call(arguments,1);return function(){h.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},h.stop=function(){i=1},h.nt=function(t){return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(r):r},h.nts=function(){return r.split(a)},h.off=h.unbind=function(t,e){if(!t)return void(h._events=f={n:{}});var n=t.split(l);if(n.length>1)for(var r=0,i=n.length;i>r;r++)h.off(n[r],e);else{n=t.split(a);var o,u,d,r,i,p,g,v=[f];for(r=0,i=n.length;i>r;r++)for(p=0;p<v.length;p+=d.length-2){if(d=[p,1],o=v[p].n,n[r]!=c)o[n[r]]&&d.push(o[n[r]]);else for(u in o)o[s](u)&&d.push(o[u]);v.splice.apply(v,d)}for(r=0,i=v.length;i>r;r++)for(o=v[r];o.n;){if(e){if(o.f){for(p=0,g=o.f.length;g>p;p++)if(o.f[p]==e){o.f.splice(p,1);break}!o.f.length&&delete o.f}for(u in o.n)if(o.n[s](u)&&o.n[u].f){var m=o.n[u].f;for(p=0,g=m.length;g>p;p++)if(m[p]==e){m.splice(p,1);break}!m.length&&delete o.n[u].f}}else{delete o.f;for(u in o.n)o.n[s](u)&&o.n[u].f&&delete o.n[u].f}o=o.n}}},h.once=function(t,e){var n=function(){return h.unbind(t,n),e.apply(this,arguments)};return h.on(t,n)},h.version=o,h.toString=function(){return"You are running Eve "+o},"undefined"!=typeof n&&n.exports?n.exports=h:"function"==typeof t&&t.amd?t("eve",[],function(){return h}):e.eve=h}(this),function(i,o){if("function"==typeof t&&t.amd)t(["eve"],function(t){return o(i,t)});else if("undefined"!=typeof r){var s=e("eve");n.exports=o(i,s)}else o(i,i.eve)}(window||this,function(t,e){var n=function(e){var n={},r=t.requestAnimationFrame||t.webkitRequestAnimationFrame||t.mozRequestAnimationFrame||t.oRequestAnimationFrame||t.msRequestAnimationFrame||function(t){setTimeout(t,16)},i=Array.isArray||function(t){return t instanceof Array||"[object Array]"==Object.prototype.toString.call(t)},o=0,s="M"+(+new Date).toString(36),a=function(){return s+(o++).toString(36)},l=Date.now||function(){return+new Date},c=function(t){var e=this;if(null==t)return e.s;var n=e.s-t;e.b+=e.dur*n,e.B+=e.dur*n,e.s=t},u=function(t){var e=this;return null==t?e.spd:void(e.spd=t)},f=function(t){var e=this;return null==t?e.dur:(e.s=e.s*t/e.dur,void(e.dur=t))},d=function(){var t=this;delete n[t.id],t.update(),e("mina.stop."+t.id,t)},p=function(){var t=this;t.pdif||(delete n[t.id],t.update(),t.pdif=t.get()-t.b)},h=function(){var t=this;t.pdif&&(t.b=t.get()-t.pdif,delete t.pdif,n[t.id]=t)},g=function(){var t,e=this;if(i(e.start)){t=[];for(var n=0,r=e.start.length;r>n;n++)t[n]=+e.start[n]+(e.end[n]-e.start[n])*e.easing(e.s)}else t=+e.start+(e.end-e.start)*e.easing(e.s);e.set(t)},v=function(){var t=0;for(var i in n)if(n.hasOwnProperty(i)){var o=n[i],s=o.get();t++,o.s=(s-o.b)/(o.dur/o.spd),o.s>=1&&(delete n[i],o.s=1,t--,function(t){setTimeout(function(){e("mina.finish."+t.id,t)})}(o)),o.update()}t&&r(v)},m=function(t,e,i,o,s,l,y){var _={id:a(),start:t,end:e,b:i,s:0,dur:o-i,spd:1,get:s,set:l,easing:y||m.linear,status:c,speed:u,duration:f,stop:d,pause:p,resume:h,update:g};n[_.id]=_;var b,j=0;for(b in n)if(n.hasOwnProperty(b)&&(j++,2==j))break;return 1==j&&r(v),_};return m.time=l,m.getById=function(t){return n[t]||null},m.linear=function(t){return t},m.easeout=function(t){return Math.pow(t,1.7)},m.easein=function(t){return Math.pow(t,.48)},m.easeinout=function(t){if(1==t)return 1;if(0==t)return 0;var e=.48-t/1.04,n=Math.sqrt(.1734+e*e),r=n-e,i=Math.pow(Math.abs(r),1/3)*(0>r?-1:1),o=-n-e,s=Math.pow(Math.abs(o),1/3)*(0>o?-1:1),a=i+s+.5;return 3*(1-a)*a*a+a*a*a},m.backin=function(t){if(1==t)return 1;var e=1.70158;return t*t*((e+1)*t-e)},m.backout=function(t){if(0==t)return 0;t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},m.elastic=function(t){return t==!!t?t:Math.pow(2,-10*t)*Math.sin((t-.075)*(2*Math.PI)/.3)+1},m.bounce=function(t){var e,n=7.5625,r=2.75;return 1/r>t?e=n*t*t:2/r>t?(t-=1.5/r,e=n*t*t+.75):2.5/r>t?(t-=2.25/r,e=n*t*t+.9375):(t-=2.625/r,e=n*t*t+.984375),e},t.mina=m,m}("undefined"==typeof e?function(){}:e),r=function(t){function n(t,e){if(t){if(t.nodeType)return x(t);if(i(t,"array")&&n.set)return n.set.apply(n,t);if(t instanceof y)return t;if(null==e)return t=C.doc.querySelector(String(t)),x(t)}return t=null==t?"100%":t,e=null==e?"100%":e,new j(t,e)}function r(t,e){if(e){if("#text"==t&&(t=C.doc.createTextNode(e.text||e["#text"]||"")),"#comment"==t&&(t=C.doc.createComment(e.text||e["#text"]||"")),"string"==typeof t&&(t=r(t)),"string"==typeof e)return 1==t.nodeType?"xlink:"==e.substring(0,6)?t.getAttributeNS(q,e.substring(6)):"xml:"==e.substring(0,4)?t.getAttributeNS(G,e.substring(4)):t.getAttribute(e):"text"==e?t.nodeValue:null;if(1==t.nodeType){for(var n in e)if(e[$](n)){var i=S(e[n]);i?"xlink:"==n.substring(0,6)?t.setAttributeNS(q,n.substring(6),i):"xml:"==n.substring(0,4)?t.setAttributeNS(G,n.substring(4),i):t.setAttribute(n,i):t.removeAttribute(n)}}else"text"in e&&(t.nodeValue=e.text)}else t=C.doc.createElementNS(G,t);return t}function i(t,e){return e=S.prototype.toLowerCase.call(e),"finite"==e?isFinite(t):"array"==e&&(t instanceof Array||Array.isArray&&Array.isArray(t))?!0:"null"==e&&null===t||e==typeof t&&null!==t||"object"==e&&t===Object(t)||O.call(t).slice(8,-1).toLowerCase()==e}function o(t){if("function"==typeof t||Object(t)!==t)return t;var e=new t.constructor;for(var n in t)t[$](n)&&(e[n]=o(t[n]));return e}function s(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return t.push(t.splice(n,1)[0])}function a(t,e,n){function r(){var i=Array.prototype.slice.call(arguments,0),o=i.join("␀"),a=r.cache=r.cache||{},l=r.count=r.count||[];return a[$](o)?(s(l,o),n?n(a[o]):a[o]):(l.length>=1e3&&delete a[l.shift()],l.push(o),a[o]=t.apply(e,i),n?n(a[o]):a[o])}return r}function l(t,e,n,r,i,o){if(null==i){var s=t-n,a=e-r;return s||a?(180+180*E.atan2(-a,-s)/I+360)%360:0}return l(t,e,i,o)-l(n,r,i,o)}function c(t){return t%360*I/180}function u(t){return 180*t/I%360}function f(t){var e=[];return t=t.replace(/(?:^|\s)(\w+)\(([^)]+)\)/g,function(t,n,r){return r=r.split(/\s*,\s*|\s+/),"rotate"==n&&1==r.length&&r.push(0,0),"scale"==n&&(r.length>2?r=r.slice(0,2):2==r.length&&r.push(0,0),1==r.length&&r.push(r[0],0,0)),"skewX"==n?e.push(["m",1,0,E.tan(c(r[0])),1,0,0]):"skewY"==n?e.push(["m",1,E.tan(c(r[0])),0,1,0,0]):e.push([n.charAt(0)].concat(r)),t}),e}function d(t,e){var r=tt(t),i=new n.Matrix;if(r)for(var o=0,s=r.length;s>o;o++){var a,l,c,u,f,d=r[o],p=d.length,h=S(d[0]).toLowerCase(),g=d[0]!=h,v=g?i.invert():0;"t"==h&&2==p?i.translate(d[1],0):"t"==h&&3==p?g?(a=v.x(0,0),l=v.y(0,0),c=v.x(d[1],d[2]),u=v.y(d[1],d[2]),i.translate(c-a,u-l)):i.translate(d[1],d[2]):"r"==h?2==p?(f=f||e,i.rotate(d[1],f.x+f.width/2,f.y+f.height/2)):4==p&&(g?(c=v.x(d[2],d[3]),u=v.y(d[2],d[3]),i.rotate(d[1],c,u)):i.rotate(d[1],d[2],d[3])):"s"==h?2==p||3==p?(f=f||e,i.scale(d[1],d[p-1],f.x+f.width/2,f.y+f.height/2)):4==p?g?(c=v.x(d[2],d[3]),u=v.y(d[2],d[3]),i.scale(d[1],d[1],c,u)):i.scale(d[1],d[1],d[2],d[3]):5==p&&(g?(c=v.x(d[3],d[4]),u=v.y(d[3],d[4]),i.scale(d[1],d[2],c,u)):i.scale(d[1],d[2],d[3],d[4])):"m"==h&&7==p&&i.add(d[1],d[2],d[3],d[4],d[5],d[6])}return i}function p(t){var e=t.node.ownerSVGElement&&x(t.node.ownerSVGElement)||t.node.parentNode&&x(t.node.parentNode)||n.select("svg")||n(0,0),r=e.select("defs"),i=null==r?!1:r.node;return i||(i=b("defs",e.node).node),i}function h(t){return t.node.ownerSVGElement&&x(t.node.ownerSVGElement)||n.select("svg")}function v(t,e,n){function i(t){if(null==t)return A;if(t==+t)return t;r(c,{width:t});try{return c.getBBox().width}catch(e){return 0}}function o(t){if(null==t)return A;if(t==+t)return t;r(c,{height:t});try{return c.getBBox().height}catch(e){return 0}}function s(r,i){null==e?l[r]=i(t.attr(r)||0):r==e&&(l=i(null==n?t.attr(r)||0:n))}var a=h(t).node,l={},c=a.querySelector(".svg---mgr");switch(c||(c=r("rect"),r(c,{x:-9e9,y:-9e9,width:10,height:10,"class":"svg---mgr",fill:"none"}),a.appendChild(c)),t.type){case"rect":s("rx",i),s("ry",o);case"image":s("width",i),s("height",o);case"text":s("x",i),s("y",o);break;case"circle":s("cx",i),s("cy",o),s("r",i);break;case"ellipse":s("cx",i),s("cy",o),s("rx",i),s("ry",o);break;case"line":s("x1",i),s("x2",i),s("y1",o),s("y2",o);break;case"marker":s("refX",i),s("markerWidth",i),s("refY",o),s("markerHeight",o);break;case"radialGradient":s("fx",i),s("fy",o);break;case"tspan":s("dx",i),s("dy",o);break;default:s(e,i)}return a.removeChild(c),l}function m(t){i(t,"array")||(t=Array.prototype.slice.call(arguments,0));for(var e=0,n=0,r=this.node;this[e];)delete this[e++];for(e=0;e<t.length;e++)"set"==t[e].type?t[e].forEach(function(t){r.appendChild(t.node)}):r.appendChild(t[e].node);var o=r.childNodes;for(e=0;e<o.length;e++)this[n++]=x(o[e]);return this}function y(t){if(t.snap in W)return W[t.snap];var e;try{e=t.ownerSVGElement}catch(n){}this.node=t,e&&(this.paper=new j(e)),this.type=t.tagName||t.nodeName;var r=this.id=U(this);if(this.anims={},this._={transform:[]},t.snap=r,W[r]=this,"g"==this.type&&(this.add=m),this.type in{g:1,mask:1,pattern:1,symbol:1})for(var i in j.prototype)j.prototype[$](i)&&(this[i]=j.prototype[i])}function _(t){this.node=t}function b(t,e){var n=r(t);e.appendChild(n);var i=x(n);return i}function j(t,e){var n,i,o,s=j.prototype;if(t&&"svg"==t.tagName){if(t.snap in W)return W[t.snap];var a=t.ownerDocument;n=new y(t),i=t.getElementsByTagName("desc")[0],o=t.getElementsByTagName("defs")[0],i||(i=r("desc"),i.appendChild(a.createTextNode("Created with Snap")),n.node.appendChild(i)),o||(o=r("defs"),n.node.appendChild(o)),n.defs=o;for(var l in s)s[$](l)&&(n[l]=s[l]);n.paper=n.root=n}else n=b("svg",C.doc.body),r(n.node,{height:e,version:1.1,width:t,xmlns:G});return n}function x(t){return t?t instanceof y||t instanceof _?t:t.tagName&&"svg"==t.tagName.toLowerCase()?new j(t):t.tagName&&"object"==t.tagName.toLowerCase()&&"image/svg+xml"==t.type?new j(t.contentDocument.getElementsByTagName("svg")[0]):new y(t):t}function w(t,e){for(var n=0,r=t.length;r>n;n++){var i={type:t[n].type,attr:t[n].attr()},o=t[n].children();e.push(i),o.length&&w(o,i.childNodes=[])}}n.version="0.4.0",n.toString=function(){return"Snap v"+this.version},n._={};var C={win:t.window,doc:t.window.document};n._.glob=C;var $="hasOwnProperty",S=String,k=parseFloat,T=parseInt,E=Math,P=E.max,F=E.min,M=E.abs,I=(E.pow,E.PI),A=(E.round,""),O=Object.prototype.toString,R=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?%?)\s*\))\s*$/i,D=(n._.separator=/[,\s]+/,/[\s]*,[\s]*/),L={hs:1,rg:1},N=/([a-z])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,B=/([rstm])[\s,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\s]*,?[\s]*)+)/gi,H=/(-?\d*\.?\d*(?:e[\-+]?\\d+)?)[\s]*,?[\s]*/gi,z=0,V="S"+(+new Date).toString(36),U=function(t){return(t&&t.type?t.type:A)+V+(z++).toString(36)},q="http://www.w3.org/1999/xlink",G="http://www.w3.org/2000/svg",W={};n.url=function(t){return"url('#"+t+"')"};n._.$=r,n._.id=U,n.format=function(){var t=/\{([^\}]+)\}/g,e=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,n=function(t,n,r){var i=r;return n.replace(e,function(t,e,n,r,o){e=e||r,i&&(e in i&&(i=i[e]),"function"==typeof i&&o&&(i=i()))}),i=(null==i||i==r?t:i)+""};return function(e,r){return S(e).replace(t,function(t,e){return n(t,e,r)})}}(),n._.clone=o,n._.cacher=a,n.rad=c,n.deg=u,n.sin=function(t){return E.sin(n.rad(t))},n.tan=function(t){return E.tan(n.rad(t))},n.cos=function(t){return E.cos(n.rad(t))},n.asin=function(t){return n.deg(E.asin(t))},n.acos=function(t){return n.deg(E.acos(t))},n.atan=function(t){return n.deg(E.atan(t))},n.atan2=function(t){return n.deg(E.atan2(t))},n.angle=l,n.len=function(t,e,r,i){return Math.sqrt(n.len2(t,e,r,i))},n.len2=function(t,e,n,r){return(t-n)*(t-n)+(e-r)*(e-r)},n.closestPoint=function(t,e,n){function r(t){var r=t.x-e,i=t.y-n;return r*r+i*i}for(var i,o,s,a,l=t.node,c=l.getTotalLength(),u=c/l.pathSegList.numberOfItems*.125,f=1/0,d=0;c>=d;d+=u)(a=r(s=l.getPointAtLength(d)))<f&&(i=s,o=d,f=a);for(u*=.5;u>.5;){var p,h,g,v,m,y;(g=o-u)>=0&&(m=r(p=l.getPointAtLength(g)))<f?(i=p,o=g,f=m):(v=o+u)<=c&&(y=r(h=l.getPointAtLength(v)))<f?(i=h,o=v,f=y):u*=.5}return i={x:i.x,y:i.y,length:o,distance:Math.sqrt(f)}},n.is=i,n.snapTo=function(t,e,n){if(n=i(n,"finite")?n:10,i(t,"array")){for(var r=t.length;r--;)if(M(t[r]-e)<=n)return t[r]}else{t=+t;var o=e%t;if(n>o)return e-o;if(o>t-n)return e-o+t}return e},n.getRGB=a(function(t){if(!t||(t=S(t)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Y};if("none"==t)return{r:-1,g:-1,b:-1,hex:"none",toString:Y};if(!(L[$](t.toLowerCase().substring(0,2))||"#"==t.charAt())&&(t=Q(t)),!t)return{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Y};var e,r,o,s,a,l,c=t.match(R);return c?(c[2]&&(o=T(c[2].substring(5),16),r=T(c[2].substring(3,5),16),e=T(c[2].substring(1,3),16)),c[3]&&(o=T((a=c[3].charAt(3))+a,16),r=T((a=c[3].charAt(2))+a,16),e=T((a=c[3].charAt(1))+a,16)),c[4]&&(l=c[4].split(D),e=k(l[0]),"%"==l[0].slice(-1)&&(e*=2.55),r=k(l[1]),"%"==l[1].slice(-1)&&(r*=2.55),o=k(l[2]),"%"==l[2].slice(-1)&&(o*=2.55),"rgba"==c[1].toLowerCase().slice(0,4)&&(s=k(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100)),c[5]?(l=c[5].split(D),e=k(l[0]),"%"==l[0].slice(-1)&&(e/=100),r=k(l[1]),"%"==l[1].slice(-1)&&(r/=100),o=k(l[2]),"%"==l[2].slice(-1)&&(o/=100),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(e/=360),"hsba"==c[1].toLowerCase().slice(0,4)&&(s=k(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100),n.hsb2rgb(e,r,o,s)):c[6]?(l=c[6].split(D),e=k(l[0]),"%"==l[0].slice(-1)&&(e/=100),r=k(l[1]),"%"==l[1].slice(-1)&&(r/=100),o=k(l[2]),"%"==l[2].slice(-1)&&(o/=100),("deg"==l[0].slice(-3)||"°"==l[0].slice(-1))&&(e/=360),"hsla"==c[1].toLowerCase().slice(0,4)&&(s=k(l[3])),l[3]&&"%"==l[3].slice(-1)&&(s/=100),n.hsl2rgb(e,r,o,s)):(e=F(E.round(e),255),r=F(E.round(r),255),o=F(E.round(o),255),s=F(P(s,0),1),c={r:e,g:r,b:o,toString:Y},c.hex="#"+(16777216|o|r<<8|e<<16).toString(16).slice(1),c.opacity=i(s,"finite")?s:1,c)):{r:-1,g:-1,b:-1,hex:"none",error:1,toString:Y}},n),n.hsb=a(function(t,e,r){return n.hsb2rgb(t,e,r).hex}),n.hsl=a(function(t,e,r){return n.hsl2rgb(t,e,r).hex}),n.rgb=a(function(t,e,n,r){if(i(r,"finite")){var o=E.round;return"rgba("+[o(t),o(e),o(n),+r.toFixed(2)]+")"}return"#"+(16777216|n|e<<8|t<<16).toString(16).slice(1)});var Q=function(t){var e=C.doc.getElementsByTagName("head")[0]||C.doc.getElementsByTagName("svg")[0],n="rgb(255, 0, 0)";return(Q=a(function(t){if("red"==t.toLowerCase())return n;e.style.color=n,e.style.color=t;var r=C.doc.defaultView.getComputedStyle(e,A).getPropertyValue("color");return r==n?null:r}))(t)},J=function(){return"hsb("+[this.h,this.s,this.b]+")"},X=function(){return"hsl("+[this.h,this.s,this.l]+")"},Y=function(){return 1==this.opacity||null==this.opacity?this.hex:"rgba("+[this.r,this.g,this.b,this.opacity]+")"},K=function(t,e,r){if(null==e&&i(t,"object")&&"r"in t&&"g"in t&&"b"in t&&(r=t.b,e=t.g,t=t.r),null==e&&i(t,string)){var o=n.getRGB(t);t=o.r,e=o.g,r=o.b}return(t>1||e>1||r>1)&&(t/=255,e/=255,r/=255),[t,e,r]},Z=function(t,e,r,o){t=E.round(255*t),e=E.round(255*e),r=E.round(255*r);var s={r:t,g:e,b:r,opacity:i(o,"finite")?o:1,hex:n.rgb(t,e,r),toString:Y};return i(o,"finite")&&(s.opacity=o),s};n.color=function(t){var e;return i(t,"object")&&"h"in t&&"s"in t&&"b"in t?(e=n.hsb2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.opacity=1,t.hex=e.hex):i(t,"object")&&"h"in t&&"s"in t&&"l"in t?(e=n.hsl2rgb(t),t.r=e.r,t.g=e.g,t.b=e.b,t.opacity=1,t.hex=e.hex):(i(t,"string")&&(t=n.getRGB(t)),i(t,"object")&&"r"in t&&"g"in t&&"b"in t&&!("error"in t)?(e=n.rgb2hsl(t),t.h=e.h,t.s=e.s,t.l=e.l,e=n.rgb2hsb(t),t.v=e.b):(t={hex:"none"},t.r=t.g=t.b=t.h=t.s=t.v=t.l=-1,t.error=1)),t.toString=Y,t},n.hsb2rgb=function(t,e,n,r){i(t,"object")&&"h"in t&&"s"in t&&"b"in t&&(n=t.b,e=t.s,r=t.o,t=t.h),t*=360;var o,s,a,l,c;return t=t%360/60,c=n*e,l=c*(1-M(t%2-1)),o=s=a=n-c,t=~~t,o+=[c,l,0,0,l,c][t],s+=[l,c,c,l,0,0][t],a+=[0,0,l,c,c,l][t],Z(o,s,a,r)},n.hsl2rgb=function(t,e,n,r){i(t,"object")&&"h"in t&&"s"in t&&"l"in t&&(n=t.l,e=t.s,t=t.h),(t>1||e>1||n>1)&&(t/=360,e/=100,n/=100),t*=360;var o,s,a,l,c;return t=t%360/60,c=2*e*(.5>n?n:1-n),l=c*(1-M(t%2-1)),o=s=a=n-c/2,t=~~t,o+=[c,l,0,0,l,c][t],s+=[l,c,c,l,0,0][t],a+=[0,0,l,c,c,l][t],Z(o,s,a,r)},n.rgb2hsb=function(t,e,n){n=K(t,e,n),t=n[0],e=n[1],n=n[2];var r,i,o,s;return o=P(t,e,n),s=o-F(t,e,n),r=0==s?null:o==t?(e-n)/s:o==e?(n-t)/s+2:(t-e)/s+4,r=(r+360)%6*60/360,i=0==s?0:s/o,{h:r,s:i,b:o,toString:J}},n.rgb2hsl=function(t,e,n){n=K(t,e,n),t=n[0],e=n[1],n=n[2];var r,i,o,s,a,l;return s=P(t,e,n),a=F(t,e,n),l=s-a,r=0==l?null:s==t?(e-n)/l:s==e?(n-t)/l+2:(t-e)/l+4,r=(r+360)%6*60/360,o=(s+a)/2,i=0==l?0:.5>o?l/(2*o):l/(2-2*o),{h:r,s:i,l:o,toString:X}},n.parsePathString=function(t){if(!t)return null;var e=n.path(t);if(e.arr)return n.path.clone(e.arr);var r={a:7,c:6,o:2,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,u:3,z:0},o=[];return i(t,"array")&&i(t[0],"array")&&(o=n.path.clone(t)),o.length||S(t).replace(N,function(t,e,n){var i=[],s=e.toLowerCase();if(n.replace(H,function(t,e){e&&i.push(+e)}),"m"==s&&i.length>2&&(o.push([e].concat(i.splice(0,2))),s="l",e="m"==e?"l":"L"),"o"==s&&1==i.length&&o.push([e,i[0]]),"r"==s)o.push([e].concat(i));else for(;i.length>=r[s]&&(o.push([e].concat(i.splice(0,r[s]))),r[s]););}),o.toString=n.path.toString,e.arr=n.path.clone(o),o};var tt=n.parseTransformString=function(t){if(!t)return null;var e=[];return i(t,"array")&&i(t[0],"array")&&(e=n.path.clone(t)),e.length||S(t).replace(B,function(t,n,r){var i=[];n.toLowerCase();r.replace(H,function(t,e){e&&i.push(+e)}),e.push([n].concat(i))}),e.toString=n.path.toString,e};n._.svgTransform2string=f,n._.rgTransform=/^[a-z][\s]*-?\.?\d/i,n._.transform2matrix=d,n._unit2px=v;C.doc.contains||C.doc.compareDocumentPosition?function(t,e){var n=9==t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t==r||!(!r||1!=r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e;)if(e=e.parentNode,e==t)return!0;return!1};n._.getSomeDefs=p,n._.getSomeSVG=h,n.select=function(t){return t=S(t).replace(/([^\\]):/g,"$1\\:"),x(C.doc.querySelector(t))},n.selectAll=function(t){for(var e=C.doc.querySelectorAll(t),r=(n.set||Array)(),i=0;i<e.length;i++)r.push(x(e[i]));return r},setInterval(function(){for(var t in W)if(W[$](t)){var e=W[t],n=e.node;("svg"!=e.type&&!n.ownerSVGElement||"svg"==e.type&&(!n.parentNode||"ownerSVGElement"in n.parentNode&&!n.ownerSVGElement))&&delete W[t]}},1e4),y.prototype.attr=function(t,n){var r=this,o=r.node;if(!t){if(1!=o.nodeType)return{text:o.nodeValue};for(var s=o.attributes,a={},l=0,c=s.length;c>l;l++)a[s[l].nodeName]=s[l].nodeValue;
return a}if(i(t,"string")){if(!(arguments.length>1))return e("snap.util.getattr."+t,r).firstDefined();var u={};u[t]=n,t=u}for(var f in t)t[$](f)&&e("snap.util.attr."+f,r,t[f]);return r},n.parse=function(t){var e=C.doc.createDocumentFragment(),n=!0,r=C.doc.createElement("div");if(t=S(t),t.match(/^\s*<\s*svg(?:\s|>)/)||(t="<svg>"+t+"</svg>",n=!1),r.innerHTML=t,t=r.getElementsByTagName("svg")[0])if(n)e=t;else for(;t.firstChild;)e.appendChild(t.firstChild);return new _(e)},n.fragment=function(){for(var t=Array.prototype.slice.call(arguments,0),e=C.doc.createDocumentFragment(),r=0,i=t.length;i>r;r++){var o=t[r];o.node&&o.node.nodeType&&e.appendChild(o.node),o.nodeType&&e.appendChild(o),"string"==typeof o&&e.appendChild(n.parse(o).node)}return new _(e)},n._.make=b,n._.wrap=x,j.prototype.el=function(t,e){var n=b(t,this.node);return e&&n.attr(e),n},y.prototype.children=function(){for(var t=[],e=this.node.childNodes,r=0,i=e.length;i>r;r++)t[r]=n(e[r]);return t},y.prototype.toJSON=function(){var t=[];return w([this],t),t[0]},e.on("snap.util.getattr",function(){var t=e.nt();t=t.substring(t.lastIndexOf(".")+1);var n=t.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});return et[$](n)?this.node.ownerDocument.defaultView.getComputedStyle(this.node,null).getPropertyValue(n):r(this.node,t)});var et={"alignment-baseline":0,"baseline-shift":0,clip:0,"clip-path":0,"clip-rule":0,color:0,"color-interpolation":0,"color-interpolation-filters":0,"color-profile":0,"color-rendering":0,cursor:0,direction:0,display:0,"dominant-baseline":0,"enable-background":0,fill:0,"fill-opacity":0,"fill-rule":0,filter:0,"flood-color":0,"flood-opacity":0,font:0,"font-family":0,"font-size":0,"font-size-adjust":0,"font-stretch":0,"font-style":0,"font-variant":0,"font-weight":0,"glyph-orientation-horizontal":0,"glyph-orientation-vertical":0,"image-rendering":0,kerning:0,"letter-spacing":0,"lighting-color":0,marker:0,"marker-end":0,"marker-mid":0,"marker-start":0,mask:0,opacity:0,overflow:0,"pointer-events":0,"shape-rendering":0,"stop-color":0,"stop-opacity":0,stroke:0,"stroke-dasharray":0,"stroke-dashoffset":0,"stroke-linecap":0,"stroke-linejoin":0,"stroke-miterlimit":0,"stroke-opacity":0,"stroke-width":0,"text-anchor":0,"text-decoration":0,"text-rendering":0,"unicode-bidi":0,visibility:0,"word-spacing":0,"writing-mode":0};e.on("snap.util.attr",function(t){var n=e.nt(),i={};n=n.substring(n.lastIndexOf(".")+1),i[n]=t;var o=n.replace(/-(\w)/gi,function(t,e){return e.toUpperCase()}),s=n.replace(/[A-Z]/g,function(t){return"-"+t.toLowerCase()});et[$](s)?this.node.style[o]=null==t?A:t:r(this.node,i)}),function(t){}(j.prototype),n.ajax=function(t,n,r,o){var s=new XMLHttpRequest,a=U();if(s){if(i(n,"function"))o=r,r=n,n=null;else if(i(n,"object")){var l=[];for(var c in n)n.hasOwnProperty(c)&&l.push(encodeURIComponent(c)+"="+encodeURIComponent(n[c]));n=l.join("&")}return s.open(n?"POST":"GET",t,!0),n&&(s.setRequestHeader("X-Requested-With","XMLHttpRequest"),s.setRequestHeader("Content-type","application/x-www-form-urlencoded")),r&&(e.once("snap.ajax."+a+".0",r),e.once("snap.ajax."+a+".200",r),e.once("snap.ajax."+a+".304",r)),s.onreadystatechange=function(){4==s.readyState&&e("snap.ajax."+a+"."+s.status,o,s)},4==s.readyState?s:(s.send(n),s)}},n.load=function(t,e,r){n.ajax(t,function(t){var i=n.parse(t.responseText);r?e.call(r,i):e(i)})};var nt=function(t){var e=t.getBoundingClientRect(),n=t.ownerDocument,r=n.body,i=n.documentElement,o=i.clientTop||r.clientTop||0,s=i.clientLeft||r.clientLeft||0,a=e.top+(g.win.pageYOffset||i.scrollTop||r.scrollTop)-o,l=e.left+(g.win.pageXOffset||i.scrollLeft||r.scrollLeft)-s;return{y:a,x:l}};return n.getElementByPoint=function(t,e){var n=this,r=(n.canvas,C.doc.elementFromPoint(t,e));if(C.win.opera&&"svg"==r.tagName){var i=nt(r),o=r.createSVGRect();o.x=t-i.x,o.y=e-i.y,o.width=o.height=1;var s=r.getIntersectionList(o,null);s.length&&(r=s[s.length-1])}return r?x(r):null},n.plugin=function(t){t(n,y,j,C,_)},C.win.Snap=n,n}(t||this);return r.plugin(function(r,i,o,s,a){function l(t,e){if(null==e){var n=!0;if(e="linearGradient"==t.type||"radialGradient"==t.type?t.node.getAttribute("gradientTransform"):"pattern"==t.type?t.node.getAttribute("patternTransform"):t.node.getAttribute("transform"),!e)return new r.Matrix;e=r._.svgTransform2string(e)}else e=r._.rgTransform.test(e)?h(e).replace(/\.{3}|\u2026/g,t._.transform||E):r._.svgTransform2string(e),p(e,"array")&&(e=r.path?r.path.toString.call(e):h(e)),t._.transform=e;var i=r._.transform2matrix(e,t.getBBox(1));return n?i:void(t.matrix=i)}function c(t){function e(t,e){var n=v(t.node,e);n=n&&n.match(o),n=n&&n[2],n&&"#"==n.charAt()&&(n=n.substring(1),n&&(a[n]=(a[n]||[]).concat(function(n){var r={};r[e]=URL(n),v(t.node,r)})))}function n(t){var e=v(t.node,"xlink:href");e&&"#"==e.charAt()&&(e=e.substring(1),e&&(a[e]=(a[e]||[]).concat(function(e){t.attr("xlink:href","#"+e)})))}for(var r,i=t.selectAll("*"),o=/^\s*url\(("|'|)(.*)\1\)\s*$/,s=[],a={},l=0,c=i.length;c>l;l++){r=i[l],e(r,"fill"),e(r,"stroke"),e(r,"filter"),e(r,"mask"),e(r,"clip-path"),n(r);var u=v(r.node,"id");u&&(v(r.node,{id:r.id}),s.push({old:u,id:r.id}))}for(l=0,c=s.length;c>l;l++){var f=a[s[l].old];if(f)for(var d=0,p=f.length;p>d;d++)f[d](s[l].id)}}function u(t,e,n){return function(r){var i=r.slice(t,e);return 1==i.length&&(i=i[0]),n?n(i):i}}function f(t){return function(){var e=t?"<"+this.type:"",n=this.node.attributes,r=this.node.childNodes;if(t)for(var i=0,o=n.length;o>i;i++)e+=" "+n[i].name+'="'+n[i].value.replace(/"/g,'\\"')+'"';if(r.length){for(t&&(e+=">"),i=0,o=r.length;o>i;i++)3==r[i].nodeType?e+=r[i].nodeValue:1==r[i].nodeType&&(e+=b(r[i]).toString());t&&(e+="</"+this.type+">")}else t&&(e+="/>");return e}}var d=i.prototype,p=r.is,h=String,g=r._unit2px,v=r._.$,m=r._.make,y=r._.getSomeDefs,_="hasOwnProperty",b=r._.wrap;d.getBBox=function(t){if(!r.Matrix||!r.path)return this.node.getBBox();var e=this,n=new r.Matrix;if(e.removed)return r._.box();for(;"use"==e.type;)if(t||(n=n.add(e.transform().localMatrix.translate(e.attr("x")||0,e.attr("y")||0))),e.original)e=e.original;else{var i=e.attr("xlink:href");e=e.original=e.node.ownerDocument.getElementById(i.substring(i.indexOf("#")+1))}var o=e._,s=r.path.get[e.type]||r.path.get.deflt;try{return t?(o.bboxwt=s?r.path.getBBox(e.realPath=s(e)):r._.box(e.node.getBBox()),r._.box(o.bboxwt)):(e.realPath=s(e),e.matrix=e.transform().localMatrix,o.bbox=r.path.getBBox(r.path.map(e.realPath,n.add(e.matrix))),r._.box(o.bbox))}catch(a){return r._.box()}};var j=function(){return this.string};d.transform=function(t){var e=this._;if(null==t){for(var n,i=this,o=new r.Matrix(this.node.getCTM()),s=l(this),a=[s],c=new r.Matrix,u=s.toTransformString(),f=h(s)==h(this.matrix)?h(e.transform):u;"svg"!=i.type&&(i=i.parent());)a.push(l(i));for(n=a.length;n--;)c.add(a[n]);return{string:f,globalMatrix:o,totalMatrix:c,localMatrix:s,diffMatrix:o.clone().add(s.invert()),global:o.toTransformString(),total:c.toTransformString(),local:u,toString:j}}return t instanceof r.Matrix?(this.matrix=t,this._.transform=t.toTransformString()):l(this,t),this.node&&("linearGradient"==this.type||"radialGradient"==this.type?v(this.node,{gradientTransform:this.matrix}):"pattern"==this.type?v(this.node,{patternTransform:this.matrix}):v(this.node,{transform:this.matrix})),this},d.parent=function(){return b(this.node.parentNode)},d.append=d.add=function(t){if(t){if("set"==t.type){var e=this;return t.forEach(function(t){e.add(t)}),this}t=b(t),this.node.appendChild(t.node),t.paper=this.paper}return this},d.appendTo=function(t){return t&&(t=b(t),t.append(this)),this},d.prepend=function(t){if(t){if("set"==t.type){var e,n=this;return t.forEach(function(t){e?e.after(t):n.prepend(t),e=t}),this}t=b(t);var r=t.parent();this.node.insertBefore(t.node,this.node.firstChild),this.add&&this.add(),t.paper=this.paper,this.parent()&&this.parent().add(),r&&r.add()}return this},d.prependTo=function(t){return t=b(t),t.prepend(this),this},d.before=function(t){if("set"==t.type){var e=this;return t.forEach(function(t){var n=t.parent();e.node.parentNode.insertBefore(t.node,e.node),n&&n.add()}),this.parent().add(),this}t=b(t);var n=t.parent();return this.node.parentNode.insertBefore(t.node,this.node),this.parent()&&this.parent().add(),n&&n.add(),t.paper=this.paper,this},d.after=function(t){t=b(t);var e=t.parent();return this.node.nextSibling?this.node.parentNode.insertBefore(t.node,this.node.nextSibling):this.node.parentNode.appendChild(t.node),this.parent()&&this.parent().add(),e&&e.add(),t.paper=this.paper,this},d.insertBefore=function(t){t=b(t);var e=this.parent();return t.node.parentNode.insertBefore(this.node,t.node),this.paper=t.paper,e&&e.add(),t.parent()&&t.parent().add(),this},d.insertAfter=function(t){t=b(t);var e=this.parent();return t.node.parentNode.insertBefore(this.node,t.node.nextSibling),this.paper=t.paper,e&&e.add(),t.parent()&&t.parent().add(),this},d.remove=function(){var t=this.parent();return this.node.parentNode&&this.node.parentNode.removeChild(this.node),delete this.paper,this.removed=!0,t&&t.add(),this},d.select=function(t){return t=h(t).replace(/([^\\]):/g,"$1\\:"),b(this.node.querySelector(t))},d.selectAll=function(t){for(var e=this.node.querySelectorAll(t),n=(r.set||Array)(),i=0;i<e.length;i++)n.push(b(e[i]));return n},d.asPX=function(t,e){return null==e&&(e=this.attr(t)),+g(this,t,e)},d.use=function(){var t,e=this.node.id;return e||(e=this.id,v(this.node,{id:e})),t="linearGradient"==this.type||"radialGradient"==this.type||"pattern"==this.type?m(this.type,this.node.parentNode):m("use",this.node.parentNode),v(t.node,{"xlink:href":"#"+e}),t.original=this,t},d.clone=function(){var t=b(this.node.cloneNode(!0));return v(t.node,"id")&&v(t.node,{id:t.id}),c(t),t.insertAfter(this),t},d.toDefs=function(){var t=y(this);return t.appendChild(this.node),this},d.pattern=d.toPattern=function(t,e,n,r){var i=m("pattern",y(this));return null==t&&(t=this.getBBox()),p(t,"object")&&"x"in t&&(e=t.y,n=t.width,r=t.height,t=t.x),v(i.node,{x:t,y:e,width:n,height:r,patternUnits:"userSpaceOnUse",id:i.id,viewBox:[t,e,n,r].join(" ")}),i.node.appendChild(this.node),i},d.marker=function(t,e,n,r,i,o){var s=m("marker",y(this));return null==t&&(t=this.getBBox()),p(t,"object")&&"x"in t&&(e=t.y,n=t.width,r=t.height,i=t.refX||t.cx,o=t.refY||t.cy,t=t.x),v(s.node,{viewBox:[t,e,n,r].join(" "),markerWidth:n,markerHeight:r,orient:"auto",refX:i||0,refY:o||0,id:s.id}),s.node.appendChild(this.node),s};var x=function(t,e,r,i){"function"!=typeof r||r.length||(i=r,r=n.linear),this.attr=t,this.dur=e,r&&(this.easing=r),i&&(this.callback=i)};r._.Animation=x,r.animation=function(t,e,n,r){return new x(t,e,n,r)},d.inAnim=function(){var t=this,e=[];for(var n in t.anims)t.anims[_](n)&&!function(t){e.push({anim:new x(t._attrs,t.dur,t.easing,t._callback),mina:t,curStatus:t.status(),status:function(e){return t.status(e)},stop:function(){t.stop()}})}(t.anims[n]);return e},r.animate=function(t,r,i,o,s,a){"function"!=typeof s||s.length||(a=s,s=n.linear);var l=n.time(),c=n(t,r,l,l+o,n.time,i,s);return a&&e.once("mina.finish."+c.id,a),c},d.stop=function(){for(var t=this.inAnim(),e=0,n=t.length;n>e;e++)t[e].stop();return this},d.animate=function(t,r,i,o){"function"!=typeof i||i.length||(o=i,i=n.linear),t instanceof x&&(o=t.callback,i=t.easing,r=i.dur,t=t.attr);var s,a,l,c,f=[],d=[],g={},v=this;for(var m in t)if(t[_](m)){v.equal?(c=v.equal(m,h(t[m])),s=c.from,a=c.to,l=c.f):(s=+v.attr(m),a=+t[m]);var y=p(s,"array")?s.length:1;g[m]=u(f.length,f.length+y,l),f=f.concat(s),d=d.concat(a)}var b=n.time(),j=n(f,d,b,b+r,n.time,function(t){var e={};for(var n in g)g[_](n)&&(e[n]=g[n](t));v.attr(e)},i);return v.anims[j.id]=j,j._attrs=t,j._callback=o,e("snap.animcreated."+v.id,j),e.once("mina.finish."+j.id,function(){delete v.anims[j.id],o&&o.call(v)}),e.once("mina.stop."+j.id,function(){delete v.anims[j.id]}),v};var w={};d.data=function(t,n){var i=w[this.id]=w[this.id]||{};if(0==arguments.length)return e("snap.data.get."+this.id,this,i,null),i;if(1==arguments.length){if(r.is(t,"object")){for(var o in t)t[_](o)&&this.data(o,t[o]);return this}return e("snap.data.get."+this.id,this,i[t],t),i[t]}return i[t]=n,e("snap.data.set."+this.id,this,n,t),this},d.removeData=function(t){return null==t?w[this.id]={}:w[this.id]&&delete w[this.id][t],this},d.outerSVG=d.toString=f(1),d.innerSVG=f(),d.toDataURL=function(){if(t&&t.btoa){var e=this.getBBox(),n=r.format('<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="{width}" height="{height}" viewBox="{x} {y} {width} {height}">{contents}</svg>',{x:+e.x.toFixed(3),y:+e.y.toFixed(3),width:+e.width.toFixed(3),height:+e.height.toFixed(3),contents:this.outerSVG()});return"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(n)))}},a.prototype.select=d.select,a.prototype.selectAll=d.selectAll}),r.plugin(function(t,e,n,r,i){function o(t,e,n,r,i,o){return null==e&&"[object SVGMatrix]"==s.call(t)?(this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.e=t.e,void(this.f=t.f)):void(null!=t?(this.a=+t,this.b=+e,this.c=+n,this.d=+r,this.e=+i,this.f=+o):(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0))}var s=Object.prototype.toString,a=String,l=Math,c="";!function(e){function n(t){return t[0]*t[0]+t[1]*t[1]}function r(t){var e=l.sqrt(n(t));t[0]&&(t[0]/=e),t[1]&&(t[1]/=e)}e.add=function(t,e,n,r,i,s){var a,l,c,u,f=[[],[],[]],d=[[this.a,this.c,this.e],[this.b,this.d,this.f],[0,0,1]],p=[[t,n,i],[e,r,s],[0,0,1]];for(t&&t instanceof o&&(p=[[t.a,t.c,t.e],[t.b,t.d,t.f],[0,0,1]]),a=0;3>a;a++)for(l=0;3>l;l++){for(u=0,c=0;3>c;c++)u+=d[a][c]*p[c][l];f[a][l]=u}return this.a=f[0][0],this.b=f[1][0],this.c=f[0][1],this.d=f[1][1],this.e=f[0][2],this.f=f[1][2],this},e.invert=function(){var t=this,e=t.a*t.d-t.b*t.c;return new o(t.d/e,-t.b/e,-t.c/e,t.a/e,(t.c*t.f-t.d*t.e)/e,(t.b*t.e-t.a*t.f)/e)},e.clone=function(){return new o(this.a,this.b,this.c,this.d,this.e,this.f)},e.translate=function(t,e){return this.add(1,0,0,1,t,e)},e.scale=function(t,e,n,r){return null==e&&(e=t),(n||r)&&this.add(1,0,0,1,n,r),this.add(t,0,0,e,0,0),(n||r)&&this.add(1,0,0,1,-n,-r),this},e.rotate=function(e,n,r){e=t.rad(e),n=n||0,r=r||0;var i=+l.cos(e).toFixed(9),o=+l.sin(e).toFixed(9);return this.add(i,o,-o,i,n,r),this.add(1,0,0,1,-n,-r)},e.x=function(t,e){return t*this.a+e*this.c+this.e},e.y=function(t,e){return t*this.b+e*this.d+this.f},e.get=function(t){return+this[a.fromCharCode(97+t)].toFixed(4)},e.toString=function(){return"matrix("+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)].join()+")"},e.offset=function(){return[this.e.toFixed(4),this.f.toFixed(4)]},e.determinant=function(){return this.a*this.d-this.b*this.c},e.split=function(){var e={};e.dx=this.e,e.dy=this.f;var i=[[this.a,this.c],[this.b,this.d]];e.scalex=l.sqrt(n(i[0])),r(i[0]),e.shear=i[0][0]*i[1][0]+i[0][1]*i[1][1],i[1]=[i[1][0]-i[0][0]*e.shear,i[1][1]-i[0][1]*e.shear],e.scaley=l.sqrt(n(i[1])),r(i[1]),e.shear/=e.scaley,this.determinant()<0&&(e.scalex=-e.scalex);var o=-i[0][1],s=i[1][1];return 0>s?(e.rotate=t.deg(l.acos(s)),0>o&&(e.rotate=360-e.rotate)):e.rotate=t.deg(l.asin(o)),e.isSimple=!(+e.shear.toFixed(9)||e.scalex.toFixed(9)!=e.scaley.toFixed(9)&&e.rotate),e.isSuperSimple=!+e.shear.toFixed(9)&&e.scalex.toFixed(9)==e.scaley.toFixed(9)&&!e.rotate,e.noRotation=!+e.shear.toFixed(9)&&!e.rotate,e},e.toTransformString=function(t){var e=t||this.split();return+e.shear.toFixed(9)?"m"+[this.get(0),this.get(1),this.get(2),this.get(3),this.get(4),this.get(5)]:(e.scalex=+e.scalex.toFixed(4),e.scaley=+e.scaley.toFixed(4),e.rotate=+e.rotate.toFixed(4),(e.dx||e.dy?"t"+[+e.dx.toFixed(4),+e.dy.toFixed(4)]:c)+(1!=e.scalex||1!=e.scaley?"s"+[e.scalex,e.scaley,0,0]:c)+(e.rotate?"r"+[+e.rotate.toFixed(4),0,0]:c))}}(o.prototype),t.Matrix=o,t.matrix=function(t,e,n,r,i,s){return new o(t,e,n,r,i,s)}}),r.plugin(function(t,n,r,i,o){function s(r){return function(i){if(e.stop(),i instanceof o&&1==i.node.childNodes.length&&("radialGradient"==i.node.firstChild.tagName||"linearGradient"==i.node.firstChild.tagName||"pattern"==i.node.firstChild.tagName)&&(i=i.node.firstChild,p(this).appendChild(i),i=f(i)),i instanceof n)if("radialGradient"==i.type||"linearGradient"==i.type||"pattern"==i.type){i.node.id||g(i.node,{id:i.id});var s=v(i.node.id)}else s=i.attr(r);else if(s=t.color(i),s.error){var a=t(p(this).ownerSVGElement).gradient(i);a?(a.node.id||g(a.node,{id:a.id}),s=v(a.node.id)):s=i}else s=m(s);var l={};l[r]=s,g(this.node,l),this.node.style[r]=_}}function a(t){e.stop(),t==+t&&(t+="px"),this.node.style.fontSize=t}function l(t){for(var e=[],n=t.childNodes,r=0,i=n.length;i>r;r++){var o=n[r];3==o.nodeType&&e.push(o.nodeValue),"tspan"==o.tagName&&(1==o.childNodes.length&&3==o.firstChild.nodeType?e.push(o.firstChild.nodeValue):e.push(l(o)))}return e}function c(){return e.stop(),this.node.style.fontSize}var u=t._.make,f=t._.wrap,d=t.is,p=t._.getSomeDefs,h=/^url\(#?([^)]+)\)$/,g=t._.$,v=t.url,m=String,y=t._.separator,_="";e.on("snap.util.attr.mask",function(t){if(t instanceof n||t instanceof o){if(e.stop(),t instanceof o&&1==t.node.childNodes.length&&(t=t.node.firstChild,p(this).appendChild(t),t=f(t)),"mask"==t.type)var r=t;else r=u("mask",p(this)),r.node.appendChild(t.node);!r.node.id&&g(r.node,{id:r.id}),g(this.node,{mask:v(r.id)})}}),function(t){e.on("snap.util.attr.clip",t),e.on("snap.util.attr.clip-path",t),e.on("snap.util.attr.clipPath",t)}(function(t){if(t instanceof n||t instanceof o){if(e.stop(),"clipPath"==t.type)var r=t;else r=u("clipPath",p(this)),r.node.appendChild(t.node),!r.node.id&&g(r.node,{id:r.id});g(this.node,{"clip-path":v(r.node.id||r.id)})}}),e.on("snap.util.attr.fill",s("fill")),e.on("snap.util.attr.stroke",s("stroke"));var b=/^([lr])(?:\(([^)]*)\))?(.*)$/i;e.on("snap.util.grad.parse",function(t){t=m(t);var e=t.match(b);if(!e)return null;var n=e[1],r=e[2],i=e[3];return r=r.split(/\s*,\s*/).map(function(t){return+t==t?+t:t}),1==r.length&&0==r[0]&&(r=[]),i=i.split("-"),i=i.map(function(t){t=t.split(":");var e={color:t[0]};return t[1]&&(e.offset=parseFloat(t[1])),e}),{type:n,params:r,stops:i}}),e.on("snap.util.attr.d",function(n){e.stop(),d(n,"array")&&d(n[0],"array")&&(n=t.path.toString.call(n)),n=m(n),n.match(/[ruo]/i)&&(n=t.path.toAbsolute(n)),g(this.node,{d:n})})(-1),e.on("snap.util.attr.#text",function(t){e.stop(),t=m(t);for(var n=i.doc.createTextNode(t);this.node.firstChild;)this.node.removeChild(this.node.firstChild);this.node.appendChild(n)})(-1),e.on("snap.util.attr.path",function(t){e.stop(),this.attr({d:t})})(-1),e.on("snap.util.attr.class",function(t){e.stop(),this.node.className.baseVal=t})(-1),e.on("snap.util.attr.viewBox",function(t){var n;n=d(t,"object")&&"x"in t?[t.x,t.y,t.width,t.height].join(" "):d(t,"array")?t.join(" "):t,g(this.node,{viewBox:n}),e.stop()})(-1),e.on("snap.util.attr.transform",function(t){this.transform(t),e.stop()})(-1),e.on("snap.util.attr.r",function(t){"rect"==this.type&&(e.stop(),g(this.node,{rx:t,ry:t}))})(-1),e.on("snap.util.attr.textpath",function(t){if(e.stop(),"text"==this.type){var r,i,o;if(!t&&this.textPath){for(i=this.textPath;i.node.firstChild;)this.node.appendChild(i.node.firstChild);return i.remove(),void delete this.textPath}if(d(t,"string")){var s=p(this),a=f(s.parentNode).path(t);s.appendChild(a.node),r=a.id,a.attr({id:r})}else t=f(t),t instanceof n&&(r=t.attr("id"),r||(r=t.id,t.attr({id:r})));if(r)if(i=this.textPath,o=this.node,i)i.attr({"xlink:href":"#"+r});else{for(i=g("textPath",{"xlink:href":"#"+r});o.firstChild;)i.appendChild(o.firstChild);o.appendChild(i),this.textPath=f(i)}}})(-1),e.on("snap.util.attr.text",function(t){if("text"==this.type){for(var n=this.node,r=function(t){var e=g("tspan");if(d(t,"array"))for(var n=0;n<t.length;n++)e.appendChild(r(t[n]));else e.appendChild(i.doc.createTextNode(t));return e.normalize&&e.normalize(),e};n.firstChild;)n.removeChild(n.firstChild);for(var o=r(t);o.firstChild;)n.appendChild(o.firstChild)}e.stop()})(-1),e.on("snap.util.attr.fontSize",a)(-1),e.on("snap.util.attr.font-size",a)(-1),e.on("snap.util.getattr.transform",function(){return e.stop(),this.transform()})(-1),e.on("snap.util.getattr.textpath",function(){return e.stop(),this.textPath})(-1),function(){function n(n){return function(){e.stop();var r=i.doc.defaultView.getComputedStyle(this.node,null).getPropertyValue("marker-"+n);return"none"==r?r:t(i.doc.getElementById(r.match(h)[1]))}}function r(t){return function(n){e.stop();var r="marker"+t.charAt(0).toUpperCase()+t.substring(1);if(""==n||!n)return void(this.node.style[r]="none");if("marker"==n.type){var i=n.node.id;return i||g(n.node,{id:n.id}),void(this.node.style[r]=v(i))}}}e.on("snap.util.getattr.marker-end",n("end"))(-1),e.on("snap.util.getattr.markerEnd",n("end"))(-1),e.on("snap.util.getattr.marker-start",n("start"))(-1),e.on("snap.util.getattr.markerStart",n("start"))(-1),e.on("snap.util.getattr.marker-mid",n("mid"))(-1),e.on("snap.util.getattr.markerMid",n("mid"))(-1),e.on("snap.util.attr.marker-end",r("end"))(-1),e.on("snap.util.attr.markerEnd",r("end"))(-1),e.on("snap.util.attr.marker-start",r("start"))(-1),e.on("snap.util.attr.markerStart",r("start"))(-1),e.on("snap.util.attr.marker-mid",r("mid"))(-1),e.on("snap.util.attr.markerMid",r("mid"))(-1)}(),e.on("snap.util.getattr.r",function(){return"rect"==this.type&&g(this.node,"rx")==g(this.node,"ry")?(e.stop(),g(this.node,"rx")):void 0})(-1),e.on("snap.util.getattr.text",function(){if("text"==this.type||"tspan"==this.type){e.stop();var t=l(this.node);return 1==t.length?t[0]:t}})(-1),e.on("snap.util.getattr.#text",function(){return this.node.textContent})(-1),e.on("snap.util.getattr.viewBox",function(){e.stop();var n=g(this.node,"viewBox");return n?(n=n.split(y),t._.box(+n[0],+n[1],+n[2],+n[3])):void 0})(-1),e.on("snap.util.getattr.points",function(){var t=g(this.node,"points");return e.stop(),t?t.split(y):void 0})(-1),e.on("snap.util.getattr.path",function(){var t=g(this.node,"d");return e.stop(),t})(-1),e.on("snap.util.getattr.class",function(){return this.node.className.baseVal})(-1),e.on("snap.util.getattr.fontSize",c)(-1),e.on("snap.util.getattr.font-size",c)(-1)}),r.plugin(function(t,e,n,r,i){var o=/\S+/g,s=String,a=e.prototype;a.addClass=function(t){var e,n,r,i,a=s(t||"").match(o)||[],l=this.node,c=l.className.baseVal,u=c.match(o)||[];if(a.length){for(e=0;r=a[e++];)n=u.indexOf(r),~n||u.push(r);i=u.join(" "),c!=i&&(l.className.baseVal=i)}return this},a.removeClass=function(t){var e,n,r,i,a=s(t||"").match(o)||[],l=this.node,c=l.className.baseVal,u=c.match(o)||[];if(u.length){for(e=0;r=a[e++];)n=u.indexOf(r),~n&&u.splice(n,1);i=u.join(" "),c!=i&&(l.className.baseVal=i)}return this},a.hasClass=function(t){var e=this.node,n=e.className.baseVal,r=n.match(o)||[];return!!~r.indexOf(t)},a.toggleClass=function(t,e){if(null!=e)return e?this.addClass(t):this.removeClass(t);var n,r,i,s,a=(t||"").match(o)||[],l=this.node,c=l.className.baseVal,u=c.match(o)||[];for(n=0;i=a[n++];)r=u.indexOf(i),~r?u.splice(r,1):u.push(i);return s=u.join(" "),c!=s&&(l.className.baseVal=s),this}}),r.plugin(function(t,n,r,i,o){function s(t){return t}function a(t){return function(e){return+e.toFixed(3)+t}}var l={"+":function(t,e){return t+e},"-":function(t,e){return t-e},"/":function(t,e){return t/e},"*":function(t,e){return t*e}},c=String,u=/[a-z]+$/i,f=/^\s*([+\-\/*])\s*=\s*([\d.eE+\-]+)\s*([^\d\s]+)?\s*$/;e.on("snap.util.attr",function(t){var n=c(t).match(f);if(n){var r=e.nt(),i=r.substring(r.lastIndexOf(".")+1),o=this.attr(i),s={};e.stop();var a=n[3]||"",d=o.match(u),p=l[n[1]];if(d&&d==a?t=p(parseFloat(o),+n[2]):(o=this.asPX(i),t=p(this.asPX(i),this.asPX(i,n[2]+a))),isNaN(o)||isNaN(t))return;s[i]=t,this.attr(s)}})(-10),e.on("snap.util.equal",function(t,n){var r=c(this.attr(t)||""),i=c(n).match(f);if(i){e.stop();var o=i[3]||"",d=r.match(u),p=l[i[1]];return d&&d==o?{from:parseFloat(r),to:p(parseFloat(r),+i[2]),f:a(d)}:(r=this.asPX(t),{from:r,to:p(r,this.asPX(t,i[2]+o)),f:s})}})(-10)}),r.plugin(function(n,r,i,o,s){var a=i.prototype,l=n.is;a.rect=function(t,e,n,r,i,o){var s;return null==o&&(o=i),l(t,"object")&&"[object Object]"==t?s=t:null!=t&&(s={x:t,y:e,width:n,height:r},null!=i&&(s.rx=i,s.ry=o)),this.el("rect",s)},a.circle=function(t,e,n){var r;return l(t,"object")&&"[object Object]"==t?r=t:null!=t&&(r={cx:t,cy:e,r:n}),this.el("circle",r)};var c=function(){function t(){this.parentNode.removeChild(this)}return function(e,n){var r=o.doc.createElement("img"),i=o.doc.body;r.style.cssText="position:absolute;left:-9999em;top:-9999em",r.onload=function(){n.call(r),r.onload=r.onerror=null,i.removeChild(r)},r.onerror=t,i.appendChild(r),r.src=e}}();a.image=function(t,e,r,i,o){var s=this.el("image");if(l(t,"object")&&"src"in t)s.attr(t);else if(null!=t){var a={"xlink:href":t,preserveAspectRatio:"none"};null!=e&&null!=r&&(a.x=e,a.y=r),null!=i&&null!=o?(a.width=i,a.height=o):c(t,function(){n._.$(s.node,{width:this.offsetWidth,height:this.offsetHeight})}),n._.$(s.node,a)}return s},a.ellipse=function(t,e,n,r){var i;return l(t,"object")&&"[object Object]"==t?i=t:null!=t&&(i={cx:t,cy:e,rx:n,ry:r}),this.el("ellipse",i)},a.path=function(t){var e;return l(t,"object")&&!l(t,"array")?e=t:t&&(e={d:t}),this.el("path",e)},a.group=a.g=function(t){var e=this.el("g");return 1==arguments.length&&t&&!t.type?e.attr(t):arguments.length&&e.add(Array.prototype.slice.call(arguments,0)),e},a.svg=function(t,e,n,r,i,o,s,a){var c={};return l(t,"object")&&null==e?c=t:(null!=t&&(c.x=t),null!=e&&(c.y=e),null!=n&&(c.width=n),null!=r&&(c.height=r),null!=i&&null!=o&&null!=s&&null!=a&&(c.viewBox=[i,o,s,a])),this.el("svg",c)},a.mask=function(t){var e=this.el("mask");return 1==arguments.length&&t&&!t.type?e.attr(t):arguments.length&&e.add(Array.prototype.slice.call(arguments,0)),e},a.ptrn=function(t,e,n,r,i,o,s,a){if(l(t,"object"))var c=t;else c={patternUnits:"userSpaceOnUse"},t&&(c.x=t),e&&(c.y=e),null!=n&&(c.width=n),null!=r&&(c.height=r),null!=i&&null!=o&&null!=s&&null!=a?c.viewBox=[i,o,s,a]:c.viewBox=[t||0,e||0,n||0,r||0];return this.el("pattern",c)},a.use=function(t){return null!=t?(t instanceof r&&(t.attr("id")||t.attr({id:n._.id(t)}),t=t.attr("id")),"#"==String(t).charAt()&&(t=t.substring(1)),this.el("use",{"xlink:href":"#"+t})):r.prototype.use.call(this)},a.symbol=function(t,e,n,r){var i={};return null!=t&&null!=e&&null!=n&&null!=r&&(i.viewBox=[t,e,n,r]),this.el("symbol",i)},a.text=function(t,e,n){var r={};return l(t,"object")?r=t:null!=t&&(r={x:t,y:e,text:n||""}),this.el("text",r)},a.line=function(t,e,n,r){var i={};return l(t,"object")?i=t:null!=t&&(i={x1:t,x2:n,y1:e,y2:r}),this.el("line",i)},a.polyline=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0));var e={};return l(t,"object")&&!l(t,"array")?e=t:null!=t&&(e={points:t}),this.el("polyline",e)},a.polygon=function(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments,0));var e={};return l(t,"object")&&!l(t,"array")?e=t:null!=t&&(e={points:t}),this.el("polygon",e)},function(){function r(){return this.selectAll("stop")}function i(t,e){var r=u("stop"),i={offset:+e+"%"};return t=n.color(t),i["stop-color"]=t.hex,t.opacity<1&&(i["stop-opacity"]=t.opacity),u(r,i),this.node.appendChild(r),this}function o(){if("linearGradient"==this.type){var t=u(this.node,"x1")||0,e=u(this.node,"x2")||1,r=u(this.node,"y1")||0,i=u(this.node,"y2")||0;return n._.box(t,r,math.abs(e-t),math.abs(i-r))}var o=this.node.cx||.5,s=this.node.cy||.5,a=this.node.r||0;return n._.box(o-a,s-a,2*a,2*a)}function s(t,n){function r(t,e){for(var n=(e-f)/(t-d),r=d;t>r;r++)s[r].offset=+(+f+n*(r-d)).toFixed(2);d=t,f=e}var i,o=e("snap.util.grad.parse",null,n).firstDefined();if(!o)return null;o.params.unshift(t),i="l"==o.type.toLowerCase()?l.apply(0,o.params):c.apply(0,o.params),o.type!=o.type.toLowerCase()&&u(i.node,{gradientUnits:"userSpaceOnUse"});var s=o.stops,a=s.length,f=0,d=0;a--;for(var p=0;a>p;p++)"offset"in s[p]&&r(p,s[p].offset);for(s[a].offset=s[a].offset||100,r(a,s[a].offset),p=0;a>=p;p++){var h=s[p];i.addStop(h.color,h.offset)}return i}function l(t,e,s,a,l){var c=n._.make("linearGradient",t);return c.stops=r,c.addStop=i,c.getBBox=o,null!=e&&u(c.node,{x1:e,y1:s,x2:a,y2:l}),c}function c(t,e,s,a,l,c){var f=n._.make("radialGradient",t);return f.stops=r,f.addStop=i,f.getBBox=o,null!=e&&u(f.node,{cx:e,cy:s,r:a}),null!=l&&null!=c&&u(f.node,{fx:l,fy:c}),f}var u=n._.$;a.gradient=function(t){return s(this.defs,t)},a.gradientLinear=function(t,e,n,r){return l(this.defs,t,e,n,r)},a.gradientRadial=function(t,e,n,r,i){return c(this.defs,t,e,n,r,i)},a.toString=function(){var t,e=this.node.ownerDocument,r=e.createDocumentFragment(),i=e.createElement("div"),o=this.node.cloneNode(!0);return r.appendChild(i),i.appendChild(o),n._.$(o,{xmlns:"http://www.w3.org/2000/svg"}),t=i.innerHTML,r.removeChild(r.firstChild),t},a.toDataURL=function(){return t&&t.btoa?"data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(this))):void 0},a.clear=function(){for(var t,e=this.node.firstChild;e;)t=e.nextSibling,"defs"!=e.tagName?e.parentNode.removeChild(e):a.clear.call({node:e}),e=t}}()}),r.plugin(function(t,e,n,r){function i(t){var e=i.ps=i.ps||{};return e[t]?e[t].sleep=100:e[t]={sleep:100},setTimeout(function(){for(var n in e)e[L](n)&&n!=t&&(e[n].sleep--,!e[n].sleep&&delete e[n])}),e[t]}function o(t,e,n,r){return null==t&&(t=e=n=r=0),null==e&&(e=t.y,n=t.width,r=t.height,t=t.x),{x:t,y:e,width:n,w:n,height:r,h:r,x2:t+n,y2:e+r,cx:t+n/2,cy:e+r/2,r1:H.min(n,r)/2,r2:H.max(n,r)/2,r0:H.sqrt(n*n+r*r)/2,path:C(t,e,n,r),vb:[t,e,n,r].join(" ")}}function s(){return this.join(",").replace(N,"$1")}function a(t){var e=D(t);return e.toString=s,e}function l(t,e,n,r,i,o,s,a,l){return null==l?g(t,e,n,r,i,o,s,a):u(t,e,n,r,i,o,s,a,v(t,e,n,r,i,o,s,a,l))}function c(n,r){function i(t){return+(+t).toFixed(3)}return t._.cacher(function(t,o,s){t instanceof e&&(t=t.attr("d")),t=M(t);for(var a,c,f,d,p,h="",g={},v=0,m=0,y=t.length;y>m;m++){if(f=t[m],"M"==f[0])a=+f[1],c=+f[2];else{if(d=l(a,c,f[1],f[2],f[3],f[4],f[5],f[6]),v+d>o){if(r&&!g.start){if(p=l(a,c,f[1],f[2],f[3],f[4],f[5],f[6],o-v),h+=["C"+i(p.start.x),i(p.start.y),i(p.m.x),i(p.m.y),i(p.x),i(p.y)],s)return h;g.start=h,h=["M"+i(p.x),i(p.y)+"C"+i(p.n.x),i(p.n.y),i(p.end.x),i(p.end.y),i(f[5]),i(f[6])].join(),v+=d,a=+f[5],c=+f[6];continue}if(!n&&!r)return p=l(a,c,f[1],f[2],f[3],f[4],f[5],f[6],o-v)}v+=d,a=+f[5],c=+f[6]}h+=f.shift()+f}return g.end=h,p=n?v:r?g:u(a,c,f[0],f[1],f[2],f[3],f[4],f[5],1)},null,t._.clone)}function u(t,e,n,r,i,o,s,a,l){var c=1-l,u=q(c,3),f=q(c,2),d=l*l,p=d*l,h=u*t+3*f*l*n+3*c*l*l*i+p*s,g=u*e+3*f*l*r+3*c*l*l*o+p*a,v=t+2*l*(n-t)+d*(i-2*n+t),m=e+2*l*(r-e)+d*(o-2*r+e),y=n+2*l*(i-n)+d*(s-2*i+n),_=r+2*l*(o-r)+d*(a-2*o+r),b=c*t+l*n,j=c*e+l*r,x=c*i+l*s,w=c*o+l*a,C=90-180*H.atan2(v-y,m-_)/z;return{x:h,y:g,m:{x:v,y:m},n:{x:y,y:_},start:{x:b,y:j},end:{x:x,y:w},alpha:C}}function f(e,n,r,i,s,a,l,c){t.is(e,"array")||(e=[e,n,r,i,s,a,l,c]);var u=F.apply(null,e);return o(u.min.x,u.min.y,u.max.x-u.min.x,u.max.y-u.min.y)}function d(t,e,n){return e>=t.x&&e<=t.x+t.width&&n>=t.y&&n<=t.y+t.height}function p(t,e){return t=o(t),e=o(e),d(e,t.x,t.y)||d(e,t.x2,t.y)||d(e,t.x,t.y2)||d(e,t.x2,t.y2)||d(t,e.x,e.y)||d(t,e.x2,e.y)||d(t,e.x,e.y2)||d(t,e.x2,e.y2)||(t.x<e.x2&&t.x>e.x||e.x<t.x2&&e.x>t.x)&&(t.y<e.y2&&t.y>e.y||e.y<t.y2&&e.y>t.y)}function h(t,e,n,r,i){var o=-3*e+9*n-9*r+3*i,s=t*o+6*e-12*n+6*r;return t*s-3*e+3*n}function g(t,e,n,r,i,o,s,a,l){null==l&&(l=1),l=l>1?1:0>l?0:l;for(var c=l/2,u=12,f=[-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],d=[.2491,.2491,.2335,.2335,.2032,.2032,.1601,.1601,.1069,.1069,.0472,.0472],p=0,g=0;u>g;g++){var v=c*f[g]+c,m=h(v,t,n,i,s),y=h(v,e,r,o,a),_=m*m+y*y;p+=d[g]*H.sqrt(_)}return c*p}function v(t,e,n,r,i,o,s,a,l){if(!(0>l||g(t,e,n,r,i,o,s,a)<l)){var c,u=1,f=u/2,d=u-f,p=.01;for(c=g(t,e,n,r,i,o,s,a,d);G(c-l)>p;)f/=2,d+=(l>c?1:-1)*f,c=g(t,e,n,r,i,o,s,a,d);return d}}function m(t,e,n,r,i,o,s,a){if(!(U(t,n)<V(i,s)||V(t,n)>U(i,s)||U(e,r)<V(o,a)||V(e,r)>U(o,a))){var l=(t*r-e*n)*(i-s)-(t-n)*(i*a-o*s),c=(t*r-e*n)*(o-a)-(e-r)*(i*a-o*s),u=(t-n)*(o-a)-(e-r)*(i-s);if(u){var f=l/u,d=c/u,p=+f.toFixed(2),h=+d.toFixed(2);
if(!(p<+V(t,n).toFixed(2)||p>+U(t,n).toFixed(2)||p<+V(i,s).toFixed(2)||p>+U(i,s).toFixed(2)||h<+V(e,r).toFixed(2)||h>+U(e,r).toFixed(2)||h<+V(o,a).toFixed(2)||h>+U(o,a).toFixed(2)))return{x:f,y:d}}}}function y(t,e,n){var r=f(t),i=f(e);if(!p(r,i))return n?0:[];for(var o=g.apply(0,t),s=g.apply(0,e),a=~~(o/8),l=~~(s/8),c=[],d=[],h={},v=n?0:[],y=0;a+1>y;y++){var _=u.apply(0,t.concat(y/a));c.push({x:_.x,y:_.y,t:y/a})}for(y=0;l+1>y;y++)_=u.apply(0,e.concat(y/l)),d.push({x:_.x,y:_.y,t:y/l});for(y=0;a>y;y++)for(var b=0;l>b;b++){var j=c[y],x=c[y+1],w=d[b],C=d[b+1],$=G(x.x-j.x)<.001?"y":"x",S=G(C.x-w.x)<.001?"y":"x",k=m(j.x,j.y,x.x,x.y,w.x,w.y,C.x,C.y);if(k){if(h[k.x.toFixed(4)]==k.y.toFixed(4))continue;h[k.x.toFixed(4)]=k.y.toFixed(4);var T=j.t+G((k[$]-j[$])/(x[$]-j[$]))*(x.t-j.t),E=w.t+G((k[S]-w[S])/(C[S]-w[S]))*(C.t-w.t);T>=0&&1>=T&&E>=0&&1>=E&&(n?v++:v.push({x:k.x,y:k.y,t1:T,t2:E}))}}return v}function _(t,e){return j(t,e)}function b(t,e){return j(t,e,1)}function j(t,e,n){t=M(t),e=M(e);for(var r,i,o,s,a,l,c,u,f,d,p=n?0:[],h=0,g=t.length;g>h;h++){var v=t[h];if("M"==v[0])r=a=v[1],i=l=v[2];else{"C"==v[0]?(f=[r,i].concat(v.slice(1)),r=f[6],i=f[7]):(f=[r,i,r,i,a,l,a,l],r=a,i=l);for(var m=0,_=e.length;_>m;m++){var b=e[m];if("M"==b[0])o=c=b[1],s=u=b[2];else{"C"==b[0]?(d=[o,s].concat(b.slice(1)),o=d[6],s=d[7]):(d=[o,s,o,s,c,u,c,u],o=c,s=u);var j=y(f,d,n);if(n)p+=j;else{for(var x=0,w=j.length;w>x;x++)j[x].segment1=h,j[x].segment2=m,j[x].bez1=f,j[x].bez2=d;p=p.concat(j)}}}}}return p}function x(t,e,n){var r=w(t);return d(r,e,n)&&j(t,[["M",e,n],["H",r.x2+10]],1)%2==1}function w(t){var e=i(t);if(e.bbox)return D(e.bbox);if(!t)return o();t=M(t);for(var n,r=0,s=0,a=[],l=[],c=0,u=t.length;u>c;c++)if(n=t[c],"M"==n[0])r=n[1],s=n[2],a.push(r),l.push(s);else{var f=F(r,s,n[1],n[2],n[3],n[4],n[5],n[6]);a=a.concat(f.min.x,f.max.x),l=l.concat(f.min.y,f.max.y),r=n[5],s=n[6]}var d=V.apply(0,a),p=V.apply(0,l),h=U.apply(0,a),g=U.apply(0,l),v=o(d,p,h-d,g-p);return e.bbox=D(v),v}function C(t,e,n,r,i){if(i)return[["M",+t+ +i,e],["l",n-2*i,0],["a",i,i,0,0,1,i,i],["l",0,r-2*i],["a",i,i,0,0,1,-i,i],["l",2*i-n,0],["a",i,i,0,0,1,-i,-i],["l",0,2*i-r],["a",i,i,0,0,1,i,-i],["z"]];var o=[["M",t,e],["l",n,0],["l",0,r],["l",-n,0],["z"]];return o.toString=s,o}function $(t,e,n,r,i){if(null==i&&null==r&&(r=n),t=+t,e=+e,n=+n,r=+r,null!=i)var o=Math.PI/180,a=t+n*Math.cos(-r*o),l=t+n*Math.cos(-i*o),c=e+n*Math.sin(-r*o),u=e+n*Math.sin(-i*o),f=[["M",a,c],["A",n,n,0,+(i-r>180),0,l,u]];else f=[["M",t,e],["m",0,-r],["a",n,r,0,1,1,0,2*r],["a",n,r,0,1,1,0,-2*r],["z"]];return f.toString=s,f}function S(e){var n=i(e),r=String.prototype.toLowerCase;if(n.rel)return a(n.rel);t.is(e,"array")&&t.is(e&&e[0],"array")||(e=t.parsePathString(e));var o=[],l=0,c=0,u=0,f=0,d=0;"M"==e[0][0]&&(l=e[0][1],c=e[0][2],u=l,f=c,d++,o.push(["M",l,c]));for(var p=d,h=e.length;h>p;p++){var g=o[p]=[],v=e[p];if(v[0]!=r.call(v[0]))switch(g[0]=r.call(v[0]),g[0]){case"a":g[1]=v[1],g[2]=v[2],g[3]=v[3],g[4]=v[4],g[5]=v[5],g[6]=+(v[6]-l).toFixed(3),g[7]=+(v[7]-c).toFixed(3);break;case"v":g[1]=+(v[1]-c).toFixed(3);break;case"m":u=v[1],f=v[2];default:for(var m=1,y=v.length;y>m;m++)g[m]=+(v[m]-(m%2?l:c)).toFixed(3)}else{g=o[p]=[],"m"==v[0]&&(u=v[1]+l,f=v[2]+c);for(var _=0,b=v.length;b>_;_++)o[p][_]=v[_]}var j=o[p].length;switch(o[p][0]){case"z":l=u,c=f;break;case"h":l+=+o[p][j-1];break;case"v":c+=+o[p][j-1];break;default:l+=+o[p][j-2],c+=+o[p][j-1]}}return o.toString=s,n.rel=a(o),o}function k(e){var n=i(e);if(n.abs)return a(n.abs);if(R(e,"array")&&R(e&&e[0],"array")||(e=t.parsePathString(e)),!e||!e.length)return[["M",0,0]];var r,o=[],l=0,c=0,u=0,f=0,d=0;"M"==e[0][0]&&(l=+e[0][1],c=+e[0][2],u=l,f=c,d++,o[0]=["M",l,c]);for(var p,h,g=3==e.length&&"M"==e[0][0]&&"R"==e[1][0].toUpperCase()&&"Z"==e[2][0].toUpperCase(),v=d,m=e.length;m>v;v++){if(o.push(p=[]),h=e[v],r=h[0],r!=r.toUpperCase())switch(p[0]=r.toUpperCase(),p[0]){case"A":p[1]=h[1],p[2]=h[2],p[3]=h[3],p[4]=h[4],p[5]=h[5],p[6]=+h[6]+l,p[7]=+h[7]+c;break;case"V":p[1]=+h[1]+c;break;case"H":p[1]=+h[1]+l;break;case"R":for(var y=[l,c].concat(h.slice(1)),_=2,b=y.length;b>_;_++)y[_]=+y[_]+l,y[++_]=+y[_]+c;o.pop(),o=o.concat(A(y,g));break;case"O":o.pop(),y=$(l,c,h[1],h[2]),y.push(y[0]),o=o.concat(y);break;case"U":o.pop(),o=o.concat($(l,c,h[1],h[2],h[3])),p=["U"].concat(o[o.length-1].slice(-2));break;case"M":u=+h[1]+l,f=+h[2]+c;default:for(_=1,b=h.length;b>_;_++)p[_]=+h[_]+(_%2?l:c)}else if("R"==r)y=[l,c].concat(h.slice(1)),o.pop(),o=o.concat(A(y,g)),p=["R"].concat(h.slice(-2));else if("O"==r)o.pop(),y=$(l,c,h[1],h[2]),y.push(y[0]),o=o.concat(y);else if("U"==r)o.pop(),o=o.concat($(l,c,h[1],h[2],h[3])),p=["U"].concat(o[o.length-1].slice(-2));else for(var j=0,x=h.length;x>j;j++)p[j]=h[j];if(r=r.toUpperCase(),"O"!=r)switch(p[0]){case"Z":l=+u,c=+f;break;case"H":l=p[1];break;case"V":c=p[1];break;case"M":u=p[p.length-2],f=p[p.length-1];default:l=p[p.length-2],c=p[p.length-1]}}return o.toString=s,n.abs=a(o),o}function T(t,e,n,r){return[t,e,n,r,n,r]}function E(t,e,n,r,i,o){var s=1/3,a=2/3;return[s*t+a*n,s*e+a*r,s*i+a*n,s*o+a*r,i,o]}function P(e,n,r,i,o,s,a,l,c,u){var f,d=120*z/180,p=z/180*(+o||0),h=[],g=t._.cacher(function(t,e,n){var r=t*H.cos(n)-e*H.sin(n),i=t*H.sin(n)+e*H.cos(n);return{x:r,y:i}});if(u)C=u[0],$=u[1],x=u[2],w=u[3];else{f=g(e,n,-p),e=f.x,n=f.y,f=g(l,c,-p),l=f.x,c=f.y;var v=(H.cos(z/180*o),H.sin(z/180*o),(e-l)/2),m=(n-c)/2,y=v*v/(r*r)+m*m/(i*i);y>1&&(y=H.sqrt(y),r=y*r,i=y*i);var _=r*r,b=i*i,j=(s==a?-1:1)*H.sqrt(G((_*b-_*m*m-b*v*v)/(_*m*m+b*v*v))),x=j*r*m/i+(e+l)/2,w=j*-i*v/r+(n+c)/2,C=H.asin(((n-w)/i).toFixed(9)),$=H.asin(((c-w)/i).toFixed(9));C=x>e?z-C:C,$=x>l?z-$:$,0>C&&(C=2*z+C),0>$&&($=2*z+$),a&&C>$&&(C-=2*z),!a&&$>C&&($-=2*z)}var S=$-C;if(G(S)>d){var k=$,T=l,E=c;$=C+d*(a&&$>C?1:-1),l=x+r*H.cos($),c=w+i*H.sin($),h=P(l,c,r,i,o,0,a,T,E,[$,k,x,w])}S=$-C;var F=H.cos(C),M=H.sin(C),I=H.cos($),A=H.sin($),O=H.tan(S/4),R=4/3*r*O,D=4/3*i*O,L=[e,n],N=[e+R*M,n-D*F],B=[l+R*A,c-D*I],V=[l,c];if(N[0]=2*L[0]-N[0],N[1]=2*L[1]-N[1],u)return[N,B,V].concat(h);h=[N,B,V].concat(h).join().split(",");for(var U=[],q=0,W=h.length;W>q;q++)U[q]=q%2?g(h[q-1],h[q],p).y:g(h[q],h[q+1],p).x;return U}function F(t,e,n,r,i,o,s,a){for(var l,c,u,f,d,p,h,g,v=[],m=[[],[]],y=0;2>y;++y)if(0==y?(c=6*t-12*n+6*i,l=-3*t+9*n-9*i+3*s,u=3*n-3*t):(c=6*e-12*r+6*o,l=-3*e+9*r-9*o+3*a,u=3*r-3*e),G(l)<1e-12){if(G(c)<1e-12)continue;f=-u/c,f>0&&1>f&&v.push(f)}else h=c*c-4*u*l,g=H.sqrt(h),0>h||(d=(-c+g)/(2*l),d>0&&1>d&&v.push(d),p=(-c-g)/(2*l),p>0&&1>p&&v.push(p));for(var _,b=v.length,j=b;b--;)f=v[b],_=1-f,m[0][b]=_*_*_*t+3*_*_*f*n+3*_*f*f*i+f*f*f*s,m[1][b]=_*_*_*e+3*_*_*f*r+3*_*f*f*o+f*f*f*a;return m[0][j]=t,m[1][j]=e,m[0][j+1]=s,m[1][j+1]=a,m[0].length=m[1].length=j+2,{min:{x:V.apply(0,m[0]),y:V.apply(0,m[1])},max:{x:U.apply(0,m[0]),y:U.apply(0,m[1])}}}function M(t,e){var n=!e&&i(t);if(!e&&n.curve)return a(n.curve);for(var r=k(t),o=e&&k(e),s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},c=(function(t,e,n){var r,i;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"].concat(P.apply(0,[e.x,e.y].concat(t.slice(1))));break;case"S":"C"==n||"S"==n?(r=2*e.x-e.bx,i=2*e.y-e.by):(r=e.x,i=e.y),t=["C",r,i].concat(t.slice(1));break;case"T":"Q"==n||"T"==n?(e.qx=2*e.x-e.qx,e.qy=2*e.y-e.qy):(e.qx=e.x,e.qy=e.y),t=["C"].concat(E(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"].concat(E(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"].concat(T(e.x,e.y,t[1],t[2]));break;case"H":t=["C"].concat(T(e.x,e.y,t[1],e.y));break;case"V":t=["C"].concat(T(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"].concat(T(e.x,e.y,e.X,e.Y))}return t}),u=function(t,e){if(t[e].length>7){t[e].shift();for(var n=t[e];n.length;)d[e]="A",o&&(p[e]="A"),t.splice(e++,0,["C"].concat(n.splice(0,6)));t.splice(e,1),m=U(r.length,o&&o.length||0)}},f=function(t,e,n,i,s){t&&e&&"M"==t[s][0]&&"M"!=e[s][0]&&(e.splice(s,0,["M",i.x,i.y]),n.bx=0,n.by=0,n.x=t[s][1],n.y=t[s][2],m=U(r.length,o&&o.length||0))},d=[],p=[],h="",g="",v=0,m=U(r.length,o&&o.length||0);m>v;v++){r[v]&&(h=r[v][0]),"C"!=h&&(d[v]=h,v&&(g=d[v-1])),r[v]=c(r[v],s,g),"A"!=d[v]&&"C"==h&&(d[v]="C"),u(r,v),o&&(o[v]&&(h=o[v][0]),"C"!=h&&(p[v]=h,v&&(g=p[v-1])),o[v]=c(o[v],l,g),"A"!=p[v]&&"C"==h&&(p[v]="C"),u(o,v)),f(r,o,s,l,v),f(o,r,l,s,v);var y=r[v],_=o&&o[v],b=y.length,j=o&&_.length;s.x=y[b-2],s.y=y[b-1],s.bx=B(y[b-4])||s.x,s.by=B(y[b-3])||s.y,l.bx=o&&(B(_[j-4])||l.x),l.by=o&&(B(_[j-3])||l.y),l.x=o&&_[j-2],l.y=o&&_[j-1]}return o||(n.curve=a(r)),o?[r,o]:r}function I(t,e){if(!e)return t;var n,r,i,o,s,a,l;for(t=M(t),i=0,s=t.length;s>i;i++)for(l=t[i],o=1,a=l.length;a>o;o+=2)n=e.x(l[o],l[o+1]),r=e.y(l[o],l[o+1]),l[o]=n,l[o+1]=r;return t}function A(t,e){for(var n=[],r=0,i=t.length;i-2*!e>r;r+=2){var o=[{x:+t[r-2],y:+t[r-1]},{x:+t[r],y:+t[r+1]},{x:+t[r+2],y:+t[r+3]},{x:+t[r+4],y:+t[r+5]}];e?r?i-4==r?o[3]={x:+t[0],y:+t[1]}:i-2==r&&(o[2]={x:+t[0],y:+t[1]},o[3]={x:+t[2],y:+t[3]}):o[0]={x:+t[i-2],y:+t[i-1]}:i-4==r?o[3]=o[2]:r||(o[0]={x:+t[r],y:+t[r+1]}),n.push(["C",(-o[0].x+6*o[1].x+o[2].x)/6,(-o[0].y+6*o[1].y+o[2].y)/6,(o[1].x+6*o[2].x-o[3].x)/6,(o[1].y+6*o[2].y-o[3].y)/6,o[2].x,o[2].y])}return n}var O=e.prototype,R=t.is,D=t._.clone,L="hasOwnProperty",N=/,?([a-z]),?/gi,B=parseFloat,H=Math,z=H.PI,V=H.min,U=H.max,q=H.pow,G=H.abs,W=c(1),Q=c(),J=c(0,1),X=t._unit2px,Y={path:function(t){return t.attr("path")},circle:function(t){var e=X(t);return $(e.cx,e.cy,e.r)},ellipse:function(t){var e=X(t);return $(e.cx||0,e.cy||0,e.rx,e.ry)},rect:function(t){var e=X(t);return C(e.x||0,e.y||0,e.width,e.height,e.rx,e.ry)},image:function(t){var e=X(t);return C(e.x||0,e.y||0,e.width,e.height)},line:function(t){return"M"+[t.attr("x1")||0,t.attr("y1")||0,t.attr("x2"),t.attr("y2")]},polyline:function(t){return"M"+t.attr("points")},polygon:function(t){return"M"+t.attr("points")+"z"},deflt:function(t){var e=t.node.getBBox();return C(e.x,e.y,e.width,e.height)}};t.path=i,t.path.getTotalLength=W,t.path.getPointAtLength=Q,t.path.getSubpath=function(t,e,n){if(this.getTotalLength(t)-n<1e-6)return J(t,e).end;var r=J(t,n,1);return e?J(r,e).end:r},O.getTotalLength=function(){return this.node.getTotalLength?this.node.getTotalLength():void 0},O.getPointAtLength=function(t){return Q(this.attr("d"),t)},O.getSubpath=function(e,n){return t.path.getSubpath(this.attr("d"),e,n)},t._.box=o,t.path.findDotsAtSegment=u,t.path.bezierBBox=f,t.path.isPointInsideBBox=d,t.closest=function(e,n,r,i){for(var s=100,a=o(e-s/2,n-s/2,s,s),l=[],c=r[0].hasOwnProperty("x")?function(t){return{x:r[t].x,y:r[t].y}}:function(t){return{x:r[t],y:i[t]}},u=0;1e6>=s&&!u;){for(var f=0,p=r.length;p>f;f++){var h=c(f);if(d(a,h.x,h.y)){u++,l.push(h);break}}u||(s*=2,a=o(e-s/2,n-s/2,s,s))}if(1e6!=s){var g,v=1/0;for(f=0,p=l.length;p>f;f++){var m=t.len(e,n,l[f].x,l[f].y);v>m&&(v=m,l[f].len=m,g=l[f])}return g}},t.path.isBBoxIntersect=p,t.path.intersection=_,t.path.intersectionNumber=b,t.path.isPointInside=x,t.path.getBBox=w,t.path.get=Y,t.path.toRelative=S,t.path.toAbsolute=k,t.path.toCubic=M,t.path.map=I,t.path.toString=s,t.path.clone=a}),r.plugin(function(t,r,i,o){var s=Math.max,a=Math.min,l=function(t){if(this.items=[],this.bindings={},this.length=0,this.type="set",t)for(var e=0,n=t.length;n>e;e++)t[e]&&(this[this.items.length]=this.items[this.items.length]=t[e],this.length++)},c=l.prototype;c.push=function(){for(var t,e,n=0,r=arguments.length;r>n;n++)t=arguments[n],t&&(e=this.items.length,this[e]=this.items[e]=t,this.length++);return this},c.pop=function(){return this.length&&delete this[this.length--],this.items.pop()},c.forEach=function(t,e){for(var n=0,r=this.items.length;r>n;n++)if(t.call(e,this.items[n],n)===!1)return this;return this},c.animate=function(r,i,o,s){"function"!=typeof o||o.length||(s=o,o=n.linear),r instanceof t._.Animation&&(s=r.callback,o=r.easing,i=o.dur,r=r.attr);var a=arguments;if(t.is(r,"array")&&t.is(a[a.length-1],"array"))var l=!0;var c,u=function(){c?this.b=c:c=this.b},f=0,d=this,p=s&&function(){++f==d.length&&s.call(this)};return this.forEach(function(t,n){e.once("snap.animcreated."+t.id,u),l?a[n]&&t.animate.apply(t,a[n]):t.animate(r,i,o,p)})},c.remove=function(){for(;this.length;)this.pop().remove();return this},c.bind=function(t,e,n){var r={};if("function"==typeof e)this.bindings[t]=e;else{var i=n||t;this.bindings[t]=function(t){r[i]=t,e.attr(r)}}return this},c.attr=function(t){var e={};for(var n in t)this.bindings[n]?this.bindings[n](t[n]):e[n]=t[n];for(var r=0,i=this.items.length;i>r;r++)this.items[r].attr(e);return this},c.clear=function(){for(;this.length;)this.pop()},c.splice=function(t,e,n){t=0>t?s(this.length+t,0):t,e=s(0,a(this.length-t,e));var r,i=[],o=[],c=[];for(r=2;r<arguments.length;r++)c.push(arguments[r]);for(r=0;e>r;r++)o.push(this[t+r]);for(;r<this.length-t;r++)i.push(this[t+r]);var u=c.length;for(r=0;r<u+i.length;r++)this.items[t+r]=this[t+r]=u>r?c[r]:i[r-u];for(r=this.items.length=this.length-=e-u;this[r];)delete this[r++];return new l(o)},c.exclude=function(t){for(var e=0,n=this.length;n>e;e++)if(this[e]==t)return this.splice(e,1),!0;return!1},c.insertAfter=function(t){for(var e=this.items.length;e--;)this.items[e].insertAfter(t);return this},c.getBBox=function(){for(var t=[],e=[],n=[],r=[],i=this.items.length;i--;)if(!this.items[i].removed){var o=this.items[i].getBBox();t.push(o.x),e.push(o.y),n.push(o.x+o.width),r.push(o.y+o.height)}return t=a.apply(0,t),e=a.apply(0,e),n=s.apply(0,n),r=s.apply(0,r),{x:t,y:e,x2:n,y2:r,width:n-t,height:r-e,cx:t+(n-t)/2,cy:e+(r-e)/2}},c.clone=function(t){t=new l;for(var e=0,n=this.items.length;n>e;e++)t.push(this.items[e].clone());return t},c.toString=function(){return"Snap‘s set"},c.type="set",t.Set=l,t.set=function(){var t=new l;return arguments.length&&t.push.apply(t,Array.prototype.slice.call(arguments,0)),t}}),r.plugin(function(t,n,r,i){function o(t){var e=t[0];switch(e.toLowerCase()){case"t":return[e,0,0];case"m":return[e,1,0,0,1,0,0];case"r":return 4==t.length?[e,0,t[2],t[3]]:[e,0];case"s":return 5==t.length?[e,1,1,t[3],t[4]]:3==t.length?[e,1,1]:[e,1]}}function s(e,n,r){n=m(n).replace(/\.{3}|\u2026/g,e),e=t.parseTransformString(e)||[],n=t.parseTransformString(n)||[];for(var i,s,a,l,c=Math.max(e.length,n.length),u=[],p=[],h=0;c>h;h++){if(a=e[h]||o(n[h]),l=n[h]||o(a),a[0]!=l[0]||"r"==a[0].toLowerCase()&&(a[2]!=l[2]||a[3]!=l[3])||"s"==a[0].toLowerCase()&&(a[3]!=l[3]||a[4]!=l[4])){e=t._.transform2matrix(e,r()),n=t._.transform2matrix(n,r()),u=[["m",e.a,e.b,e.c,e.d,e.e,e.f]],p=[["m",n.a,n.b,n.c,n.d,n.e,n.f]];break}for(u[h]=[],p[h]=[],i=0,s=Math.max(a.length,l.length);s>i;i++)i in a&&(u[h][i]=a[i]),i in l&&(p[h][i]=l[i])}return{from:d(u),to:d(p),f:f(u)}}function a(t){return t}function l(t){return function(e){return+e.toFixed(3)+t}}function c(t){return t.join(" ")}function u(e){return t.rgb(e[0],e[1],e[2])}function f(t){var e,n,r,i,o,s,a=0,l=[];for(e=0,n=t.length;n>e;e++){for(o="[",s=['"'+t[e][0]+'"'],r=1,i=t[e].length;i>r;r++)s[r]="val["+a++ +"]";o+=s+"]",l[e]=o}return Function("val","return Snap.path.toString.call(["+l+"])")}function d(t){for(var e=[],n=0,r=t.length;r>n;n++)for(var i=1,o=t[n].length;o>i;i++)e.push(t[n][i]);return e}function p(t){return isFinite(parseFloat(t))}function h(e,n){return t.is(e,"array")&&t.is(n,"array")?e.toString()==n.toString():!1}var g={},v=/[a-z]+$/i,m=String;g.stroke=g.fill="colour",n.prototype.equal=function(t,n){return e("snap.util.equal",this,t,n).firstDefined()},e.on("snap.util.equal",function(e,n){var r,i,o=m(this.attr(e)||""),y=this;if(p(o)&&p(n))return{from:parseFloat(o),to:parseFloat(n),f:a};if("colour"==g[e])return r=t.color(o),i=t.color(n),{from:[r.r,r.g,r.b,r.opacity],to:[i.r,i.g,i.b,i.opacity],f:u};if("viewBox"==e)return r=this.attr(e).vb.split(" ").map(Number),i=n.split(" ").map(Number),{from:r,to:i,f:c};if("transform"==e||"gradientTransform"==e||"patternTransform"==e)return n instanceof t.Matrix&&(n=n.toTransformString()),t._.rgTransform.test(n)||(n=t._.svgTransform2string(n)),s(o,n,function(){return y.getBBox(1)});if("d"==e||"path"==e)return r=t.path.toCubic(o,n),{from:d(r[0]),to:d(r[1]),f:f(r[0])};if("points"==e)return r=m(o).split(t._.separator),i=m(n).split(t._.separator),{from:r,to:i,f:function(t){return t}};var _=o.match(v),b=m(n).match(v);return _&&h(_,b)?{from:parseFloat(o),to:parseFloat(n),f:l(_)}:{from:this.asPX(e),to:this.asPX(e,n),f:a}})}),r.plugin(function(t,n,r,i){for(var o=n.prototype,s="hasOwnProperty",a=("createTouch"in i.doc),l=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","touchstart","touchmove","touchend","touchcancel"],c={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},u=(function(t,e){var n="y"==t?"scrollTop":"scrollLeft",r=e&&e.node?e.node.ownerDocument:i.doc;return r[n in r.documentElement?"documentElement":"body"][n]}),f=function(){return this.originalEvent.preventDefault()},d=function(){return this.originalEvent.stopPropagation()},p=function(t,e,n,r){var i=a&&c[e]?c[e]:e,o=function(i){var o=u("y",r),l=u("x",r);if(a&&c[s](e))for(var p=0,h=i.targetTouches&&i.targetTouches.length;h>p;p++)if(i.targetTouches[p].target==t||t.contains(i.targetTouches[p].target)){var g=i;i=i.targetTouches[p],i.originalEvent=g,i.preventDefault=f,i.stopPropagation=d;break}var v=i.clientX+l,m=i.clientY+o;return n.call(r,i,v,m)};return e!==i&&t.addEventListener(e,o,!1),t.addEventListener(i,o,!1),function(){return e!==i&&t.removeEventListener(e,o,!1),t.removeEventListener(i,o,!1),!0}},h=[],g=function(t){for(var n,r=t.clientX,i=t.clientY,o=u("y"),s=u("x"),l=h.length;l--;){if(n=h[l],a){for(var c,f=t.touches&&t.touches.length;f--;)if(c=t.touches[f],c.identifier==n.el._drag.id||n.el.node.contains(c.target)){r=c.clientX,i=c.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();var d=n.el.node;d.nextSibling,d.parentNode,d.style.display;r+=s,i+=o,e("snap.drag.move."+n.el.id,n.move_scope||n.el,r-n.el._drag.x,i-n.el._drag.y,r,i,t)}},v=function(n){t.unmousemove(g).unmouseup(v);for(var r,i=h.length;i--;)r=h[i],r.el._drag={},e("snap.drag.end."+r.el.id,r.end_scope||r.start_scope||r.move_scope||r.el,n),e.off("snap.drag.*."+r.el.id);h=[]},m=l.length;m--;)!function(e){t[e]=o[e]=function(n,r){if(t.is(n,"function"))this.events=this.events||[],this.events.push({name:e,f:n,unbind:p(this.node||document,e,n,r||this)});else for(var i=0,o=this.events.length;o>i;i++)if(this.events[i].name==e)try{this.events[i].f.call(this)}catch(s){}return this},t["un"+e]=o["un"+e]=function(t){for(var n=this.events||[],r=n.length;r--;)if(n[r].name==e&&(n[r].f==t||!t))return n[r].unbind(),n.splice(r,1),!n.length&&delete this.events,this;return this}}(l[m]);o.hover=function(t,e,n,r){return this.mouseover(t,n).mouseout(e,r||n)},o.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)};var y=[];o.drag=function(n,r,i,o,s,a){function l(l,c,f){(l.originalEvent||l).preventDefault(),u._drag.x=c,u._drag.y=f,u._drag.id=l.identifier,!h.length&&t.mousemove(g).mouseup(v),h.push({el:u,move_scope:o,start_scope:s,end_scope:a}),r&&e.on("snap.drag.start."+u.id,r),n&&e.on("snap.drag.move."+u.id,n),i&&e.on("snap.drag.end."+u.id,i),e("snap.drag.start."+u.id,s||o||u,c,f,l)}function c(t,n,r){e("snap.draginit."+u.id,u,t,n,r)}var u=this;if(!arguments.length){var f;return u.drag(function(t,e){this.attr({transform:f+(f?"T":"t")+[t,e]})},function(){f=this.transform().local})}return e.on("snap.draginit."+u.id,l),u._drag={},y.push({el:u,start:l,init:c}),u.mousedown(c),u},o.undrag=function(){for(var n=y.length;n--;)y[n].el==this&&(this.unmousedown(y[n].init),y.splice(n,1),e.unbind("snap.drag.*."+this.id),e.unbind("snap.draginit."+this.id));return!y.length&&t.unmousemove(g).unmouseup(v),this}}),r.plugin(function(t,n,r,i){var o=(n.prototype,r.prototype),s=/^\s*url\((.+)\)/,a=String,l=t._.$;t.filter={},o.filter=function(e){var r=this;"svg"!=r.type&&(r=r.paper);var i=t.parse(a(e)),o=t._.id(),s=(r.node.offsetWidth,r.node.offsetHeight,l("filter"));return l(s,{id:o,filterUnits:"userSpaceOnUse"}),s.appendChild(i.node),r.defs.appendChild(s),new n(s)},e.on("snap.util.getattr.filter",function(){e.stop();var n=l(this.node,"filter");if(n){var r=a(n).match(s);return r&&t.select(r[1])}}),e.on("snap.util.attr.filter",function(r){if(r instanceof n&&"filter"==r.type){e.stop();var i=r.node.id;i||(l(r.node,{id:r.id}),i=r.id),l(this.node,{filter:t.url(i)})}r&&"none"!=r||(e.stop(),this.node.removeAttribute("filter"))}),t.filter.blur=function(e,n){null==e&&(e=2);var r=null==n?e:[e,n];return t.format('<feGaussianBlur stdDeviation="{def}"/>',{def:r})},t.filter.blur.toString=function(){return this()},t.filter.shadow=function(e,n,r,i,o){return"string"==typeof r&&(i=r,o=i,r=4),"string"!=typeof i&&(o=i,i="#000"),i=i||"#000",null==r&&(r=4),null==o&&(o=1),null==e&&(e=0,n=2),null==n&&(n=e),i=t.color(i),t.format('<feGaussianBlur in="SourceAlpha" stdDeviation="{blur}"/><feOffset dx="{dx}" dy="{dy}" result="offsetblur"/><feFlood flood-color="{color}"/><feComposite in2="offsetblur" operator="in"/><feComponentTransfer><feFuncA type="linear" slope="{opacity}"/></feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/></feMerge>',{color:i,dx:e,dy:n,blur:r,opacity:o})},t.filter.shadow.toString=function(){return this()},t.filter.grayscale=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {b} {h} 0 0 0 0 0 1 0"/>',{a:.2126+.7874*(1-e),b:.7152-.7152*(1-e),c:.0722-.0722*(1-e),d:.2126-.2126*(1-e),e:.7152+.2848*(1-e),f:.0722-.0722*(1-e),g:.2126-.2126*(1-e),h:.0722+.9278*(1-e)})},t.filter.grayscale.toString=function(){return this()},t.filter.sepia=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="matrix" values="{a} {b} {c} 0 0 {d} {e} {f} 0 0 {g} {h} {i} 0 0 0 0 0 1 0"/>',{a:.393+.607*(1-e),b:.769-.769*(1-e),c:.189-.189*(1-e),d:.349-.349*(1-e),e:.686+.314*(1-e),f:.168-.168*(1-e),g:.272-.272*(1-e),h:.534-.534*(1-e),i:.131+.869*(1-e)})},t.filter.sepia.toString=function(){return this()},t.filter.saturate=function(e){return null==e&&(e=1),t.format('<feColorMatrix type="saturate" values="{amount}"/>',{amount:1-e})},t.filter.saturate.toString=function(){return this()},t.filter.hueRotate=function(e){return e=e||0,t.format('<feColorMatrix type="hueRotate" values="{angle}"/>',{angle:e})},t.filter.hueRotate.toString=function(){return this()},t.filter.invert=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="table" tableValues="{amount} {amount2}"/><feFuncG type="table" tableValues="{amount} {amount2}"/><feFuncB type="table" tableValues="{amount} {amount2}"/></feComponentTransfer>',{amount:e,amount2:1-e})},t.filter.invert.toString=function(){return this()},t.filter.brightness=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}"/><feFuncG type="linear" slope="{amount}"/><feFuncB type="linear" slope="{amount}"/></feComponentTransfer>',{amount:e})},t.filter.brightness.toString=function(){return this()},t.filter.contrast=function(e){return null==e&&(e=1),t.format('<feComponentTransfer><feFuncR type="linear" slope="{amount}" intercept="{amount2}"/><feFuncG type="linear" slope="{amount}" intercept="{amount2}"/><feFuncB type="linear" slope="{amount}" intercept="{amount2}"/></feComponentTransfer>',{amount:e,amount2:.5-e/2})},t.filter.contrast.toString=function(){return this()}}),r.plugin(function(t,e,n,r,i){var o=t._.box,s=t.is,a=/^[^a-z]*([tbmlrc])/i,l=function(){return"T"+this.dx+","+this.dy};e.prototype.getAlign=function(t,e){null==e&&s(t,"string")&&(e=t,t=null),t=t||this.paper;var n=t.getBBox?t.getBBox():o(t),r=this.getBBox(),i={};switch(e=e&&e.match(a),e=e?e[1].toLowerCase():"c"){case"t":i.dx=0,i.dy=n.y-r.y;break;case"b":i.dx=0,i.dy=n.y2-r.y2;break;case"m":i.dx=0,i.dy=n.cy-r.cy;break;case"l":i.dx=n.x-r.x,i.dy=0;break;case"r":i.dx=n.x2-r.x2,i.dy=0;break;default:i.dx=n.cx-r.cx,i.dy=0}return i.toString=l,i},e.prototype.align=function(t,e){return this.transform("..."+this.getAlign(t,e))}}),r})},{eve:26}],26:[function(e,n,r){!function(e){var r,i,o="0.4.2",s="hasOwnProperty",a=/[\.\/]/,l=/\s*,\s*/,c="*",u=function(t,e){return t-e},f={n:{}},d=function(){for(var t=0,e=this.length;e>t;t++)if("undefined"!=typeof this[t])return this[t]},p=function(){for(var t=this.length;--t;)if("undefined"!=typeof this[t])return this[t]},h=function(t,e){t=String(t);var n,o=i,s=Array.prototype.slice.call(arguments,2),a=h.listeners(t),l=0,c=[],f={},g=[],v=r;g.firstDefined=d,g.lastDefined=p,r=t,i=0;for(var m=0,y=a.length;y>m;m++)"zIndex"in a[m]&&(c.push(a[m].zIndex),a[m].zIndex<0&&(f[a[m].zIndex]=a[m]));for(c.sort(u);c[l]<0;)if(n=f[c[l++]],g.push(n.apply(e,s)),i)return i=o,g;for(m=0;y>m;m++)if(n=a[m],"zIndex"in n)if(n.zIndex==c[l]){if(g.push(n.apply(e,s)),i)break;do if(l++,n=f[c[l]],n&&g.push(n.apply(e,s)),i)break;while(n)}else f[n.zIndex]=n;else if(g.push(n.apply(e,s)),i)break;return i=o,r=v,g};h._events=f,h.listeners=function(t){var e,n,r,i,o,s,l,u,d=t.split(a),p=f,h=[p],g=[];for(i=0,o=d.length;o>i;i++){for(u=[],s=0,l=h.length;l>s;s++)for(p=h[s].n,n=[p[d[i]],p[c]],r=2;r--;)e=n[r],e&&(u.push(e),g=g.concat(e.f||[]));h=u}return g},h.on=function(t,e){if(t=String(t),"function"!=typeof e)return function(){};for(var n=t.split(l),r=0,i=n.length;i>r;r++)!function(t){for(var n,r=t.split(a),i=f,o=0,s=r.length;s>o;o++)i=i.n,i=i.hasOwnProperty(r[o])&&i[r[o]]||(i[r[o]]={n:{}});for(i.f=i.f||[],o=0,s=i.f.length;s>o;o++)if(i.f[o]==e){n=!0;break}!n&&i.f.push(e)}(n[r]);return function(t){+t==+t&&(e.zIndex=+t)}},h.f=function(t){var e=[].slice.call(arguments,1);return function(){h.apply(null,[t,null].concat(e).concat([].slice.call(arguments,0)))}},h.stop=function(){i=1},h.nt=function(t){return t?new RegExp("(?:\\.|\\/|^)"+t+"(?:\\.|\\/|$)").test(r):r},h.nts=function(){return r.split(a)},h.off=h.unbind=function(t,e){if(!t)return void(h._events=f={n:{}});var n=t.split(l);if(n.length>1)for(var r=0,i=n.length;i>r;r++)h.off(n[r],e);else{n=t.split(a);var o,u,d,r,i,p,g,v=[f];for(r=0,i=n.length;i>r;r++)for(p=0;p<v.length;p+=d.length-2){if(d=[p,1],o=v[p].n,n[r]!=c)o[n[r]]&&d.push(o[n[r]]);else for(u in o)o[s](u)&&d.push(o[u]);v.splice.apply(v,d)}for(r=0,i=v.length;i>r;r++)for(o=v[r];o.n;){if(e){if(o.f){for(p=0,g=o.f.length;g>p;p++)if(o.f[p]==e){o.f.splice(p,1);break}!o.f.length&&delete o.f}for(u in o.n)if(o.n[s](u)&&o.n[u].f){var m=o.n[u].f;for(p=0,g=m.length;g>p;p++)if(m[p]==e){m.splice(p,1);break}!m.length&&delete o.n[u].f}}else{delete o.f;for(u in o.n)o.n[s](u)&&o.n[u].f&&delete o.n[u].f}o=o.n}}},h.once=function(t,e){var n=function(){return h.unbind(t,n),e.apply(this,arguments)};return h.on(t,n)},h.version=o,h.toString=function(){return"You are running Eve "+o},"undefined"!=typeof n&&n.exports?n.exports=h:"function"==typeof t&&t.amd?t("eve",[],function(){return h}):e.eve=h}(this)},{}],27:[function(t,e,n){e.exports.mediator=t("./uncharted.mediator"),e.exports.mousehold=t("./uncharted.mousehold"),e.exports.scrollable=t("./uncharted.scrollable"),e.exports.pan=t("./uncharted.pan"),e.exports.zoom=t("./uncharted.zoom"),e.exports.InfiniteScroll=t("./uncharted.infiniteScroll"),e.exports.Keyboard=t("./uncharted.keyboard")},{"./uncharted.infiniteScroll":28,"./uncharted.keyboard":29,"./uncharted.mediator":30,"./uncharted.mousehold":31,"./uncharted.pan":32,"./uncharted.scrollable":33,"./uncharted.zoom":34}],28:[function(t,e,n){(function(t){"use strict";function n(t,e){this._$viewport=r(t),this._distance=e,this._isLoading=!1,this._disabled=!1,this._timeoutDelay=50}var r="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null;n.prototype.onInfinite=function(t){var e,n=this,r=n._$viewport;r.on("scroll",function(){e=setTimeout(function(){if(clearTimeout(e),!n._disabled&&!n._isLoading){var i=r.scrollTop(),o=r.height(),s=r[0].scrollHeight-o;return s-n._distance<=i?(n._isLoading=!0,t()):void 0}},n._timeoutDelay)})},n.prototype.infiniteScrollDone=function(){this._isLoading=!1},n.prototype.disable=function(){this._disabled=!0},n.prototype.enable=function(){this._disabled=!1},e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],29:[function(t,e,n){(function(t){"use strict";var n="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null,r=function(t,e){var r,i,o=e||{},s=o.repeatDelay||100;this.isHolding=function(t){return r[t]},this.bindKeydown=function(e){r||(r={}),n(t).keydown(function(t){i||(r[t.which]=!0,i=setTimeout(function(){e(t.which),i=void 0},s))}),n(t).keyup(function(t){delete r[t.which]})}};e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],30:[function(t,e,n){(function(n){"use strict";var r=t("mediator-js"),i=null,o=function(t){var e,n=this,r=function(t){e=new t};return n.publish=function(){return e.publish.apply(e,arguments)},n.subscribe=function(t,n,r,i){return e.subscribe(t,n,r,i)},n.remove=function(t,n){return e.remove(t,n)},r(t),n};e.exports=function(){return i||(i=new o(r.Mediator)),i}(),e.exports.registerGlobal=function(){n._uncharted||(n._uncharted={}),n._uncharted.Mediator=e.exports}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"mediator-js":22}],31:[function(t,e,n){(function(t){"use strict";var n="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null,r=function(t){var e=this;e.$e=t,e._resolution=5,e._isMouseDown=!1,e._intervalId=null,e._whileMouseDown=null,e._duration=null;var n=function(t){if("function"!=typeof t)throw new Error("whileMouseDown must a function");return e._whileMouseDown=t,e.$e.on("mousedown",function(){e._isMouseDown||(e._isMouseDown=!0,e._duration=0,e._intervalId=setInterval(function(){e._duration+=e._resolution,e._isMouseDown?e._whileMouseDown(e._duration):clearInterval(e._intervalId)},e._resolution))}),e.$e.on("mouseup mouseoff",function(){e._isMouseDown=!1,e._duration=null,clearInterval(e._intervalId)}),e},r=function(){e.$e.off("mousedown"),e.$e.off("mouseup mouseoff"),e._whileMouseDown=null};return e.bind=n,e.unbind=r,e};e.exports=r,e.exports.asJQueryPlugin=function(){n.fn.mousehold=function(){return this._mousehold||(this._mousehold=new r(this)),this._mousehold}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(t,e,n){(function(t){"use strict";function n(t,e){var n=null,r=0,i=0;t.drag(function(t,o){n.e=r+t,n.f=i+o,e.transform(n)},function(){n=e.transform().localMatrix.clone(),r=n.e,i=n.f},null)}var r="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null;e.exports=n,e.exports.AsJQueryPlugin=function(){r.fn.pan=function(t){return new n(this,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(t,e,n){(function(t){"use strict";var n="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null,r=function(t,e){var r=this,i={sliderSelector:null,viewportSelector:null};if(r.options=n.extend({},i,e),r._slideStart=null,r._initialScrollPosition=null,r._isScrolling=!1,r._scrollEnabled=!0,r.$container=t,!r.options.sliderSelector)throw new Error("A Slider Selector must be specified.");if(r.$slider=n(r.options.sliderSelector),!r.options.viewportSelector)throw new Error("A Viewport Selector must be specified.");r.$target=n(r.options.viewportSelector);var o=function(t){var e=r.$target.children().outerHeight(!0)-r.$target.height(),n=r.$container.height()-r.$slider.height(),i=t/n,o=e*i;r.$target.scrollTop(o)},s=function(t){r._isScrolling=!0,r._slideStart=t.pageY,r._initialScrollPosition=r.$slider.position().top},a=function(t){if(r._isScrolling&&1===t.buttons){var e=t.pageY-r._slideStart,n=r.$container.height()-r.$slider.height(),i=(r._initialScrollPosition||0)+e;0>i?i=0:i>n&&(i=n),o(i)}},l=function(){r._isScrolling=!1,r._slideStart=null,r._initialScrollPosition=null},c=function(){var t=r.$target.height()/r.$target.children().outerHeight(!0),e=r.$target.children().outerHeight(!0)-r.$target.height(),n=r.$target.scrollTop()/e,i=(1-t)*r.$container.height(),o=i*n;
r.$slider.css({top:o})},u=function(){r.$container.off("mousedown",r.options.sliderSelector,s).off("mousemove",a).off("mouseup",r.options.sliderSelector,l)},f=function(){r._scrollEnabled=r.$target.height()<r.$target.children().outerHeight(!0),r._scrollEnabled?(r.$container.on("mousedown",r.options.sliderSelector,s).on("mousemove",a).on("mouseup",r.options.sliderSelector,l),r.$target.scroll(n.proxy(c,r))):r.$slider.hide()};return r.Dispose=u,f(),r.$container};e.exports=r,e.exports.asJQueryPlugin=function(){n.fn.scrollable=function(t){return new r(this,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],34:[function(t,e,n){(function(n){"use strict";function r(t,e,n){var r=i(t.node),a=i.extend(s,n),l=a.minScale,c=a.maxScale,u=a.step,f=r.offset().left,d=r.offset().top;t.node.addEventListener("wheel",function(t){if(t.ctrlKey&&0!==t.deltaY){var n=e.transform().localMatrix,r=Math.sqrt(n.a*n.a+n.c*n.c),i=o.matrix(),s=u*t.deltaY,a=t.pageX-f,p=t.pageY-d,h=(a-n.e)/r,g=(p-n.f)/r,v=r+s;v>c?v=c:l>v&&(v=l),i.translate(a,p),i.scale(v),i.translate(-h,-g),e.transform(i)}})}var i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("snapsvg"),s={minScale:.5,maxScale:2,step:.001};e.exports=r,e.exports.AsJQueryPlugin=function(){i.fn.zoom=function(t){return new r(this,t)}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{snapsvg:25}],35:[function(t,e,n){"use strict";e.exports=t("./strippets"),e.exports.asJQueryPlugin=t("./strippets").asJQueryPlugin,e.exports.Outline=t("./strippets.outline.js")},{"./strippets":39,"./strippets.outline.js":41}],36:[function(t,e,n){(function(t){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof t?t._:null,r=function(){};r.getCSSRule=function(t){var e=t.toLowerCase(),n=[];if(document.styleSheets)for(var r=document.styleSheets,i=0,o=r.length;o>i;++i){var s=r[i].cssRules||r[i].rules||null;if(s)for(var a=null,l=null,c=0,u=s.length;u>c;++c)a=s[c],a.type===CSSRule.STYLE_RULE&&(l=a.selectorText.split("."),l&&l.length&&l[l.length-1].toLowerCase()===e&&n.push(a))}return n.length?n:null},r.retrieveStyles=function(){var t={},e=r.styleRules;return n.each(e,function(e){t[e]={},n.each(r.getCSSRule(e),function(n){r.readingStyleRegex.test(n.selectorText)?t[e].reading||(t[e].reading=n.style):t[e].normal||(t[e].normal=n.style)})}),t},r.readingStyleRegex=/.*[. ]read[. ].*/,r.styleRules=["entity","outlineItem","sourceIcon","outlineHeader"],r.prototype.styles=r.retrieveStyles(),r.prototype.attrs={entity:"data-entity",minimizedWidth:"_mw"},r.prototype.events={container:null,outline:{ReOrderEntity:"[Outline::ReOrderEntity]",Minimize:"[Outline::Minimize]",ReadingMode:"[Outline::ReadingMode]",CenterElement:"[OutlineContainer::CenterElement]",EntityClicked:"[OutlineContent::EntityClicked]",EnableSidebar:"[Outline::EnableSidebar]"}},r.prototype.classes={container:{container:"_stories",viewport:"_vp",leftButton:"_lb",rightButton:"_rb",autoCenter:"auto-center"},outline:{outlinecontainer:"_sc",outline:"_si",minimizedmode:"minimized",readmode:"read",hiddenmode:"hidden",sourceIcon:"_ss",sourceText:"sourceText",highlightedText:"highlightedText"},maincontent:{outlinemaincontent:"_smc",outlineentitycontainer:"_sec",slider:"_rs"},sidebar:{sidebarContainer:"sidebar",sidebarentitycontainer:"_sbec"},reader:{readerContent:"_rc"},entity:{outlineentity:"_se",title:"_t",details:"_ed",name:"_en"}},r.prototype.templates={container:{strippetsTemplate:'<div class="strippets"></div>',viewportTemplate:'<div class="viewport"></div>',containerTemplate:'<div class="outlineContainer"></div>',scrollLeftControlTemplate:'<div class="hoverpad left noselect"></div>',scrollRightControlTemplate:'<div class="hoverpad right noselect"></div>',scrollLeftButtonTemplate:'<div class="button"><i class="fa fa-left fa-chevron-left"></i></div>',scrollRightButtonTemplate:'<div class="button"><i class="fa fa-left fa-chevron-right"></i></div>'},outline:{outlineContainerTemplate:'<li class="outlineItemContainer"></li>',outlineHeaderTemplate:'<div class="outlineHeader"></div>',outlineItemTemplate:'<div class="outlineItem noselect"></div>',outlineSourceIconTemplate:'<div class="sourceIcon noselect"></div>',outlineSourceTemplate:'<div class="noselect"><a href="<%= src_url %>" target="_blank"><%= src_title %></a></div>'},maincontent:{outlineMainTemplate:'<div class="mainOutlineContent"></div>',titleTemplate:'<div class="title" title="<%=title %>"><p class="centering-container"><%= title %></p></div>',entityContainerTemplate:'<div class="entityContainer noselect"></div>',sliderTemplate:'<div class="readingSlider"></div>'},sidebar:{sidebarTemplate:'<div class="sidebar"></div>',entityContainerTemplate:'<div class="entityContainer noselect"></div>'},reader:{readerTemplate:'<div class="reader"></div>',readerContentTemplate:'<div class="readerContent"><div class="readerContentBody"><% if (data.title) { %> <h1 class="title"><%= data.title %></h1> <% } %><ul class="meta-line"><% if (data.author) { %> <li class="author"><%= data.author %></li> <% } %><% if (data.lastupdatedon) { %> <li> <time class="updated"><%= data.lastupdatedon %></time></li> <% } %></ul><% if (data.figureImgUrl) { %><div class="figure"><div class="figure-content"><a href="" class="image"><img src="<%= data.figureImgUrl %>"></a><% if (data.figureCaption) { %><div class="figcaption"> <%= data.figureCaption %></div> <% } %></div></div><% } %><% if (data.content) { %> <div class="content"><%= data.content %></div> <% } %></div></div>',readerContentErrorTemplate:'<div class="readerContentError"><div class="reader-broken"><span class="emoticon"><i class="fa fa-meh-o"></i></span><br><span class="err-info"><%= data.errorCode %> <%= data.message %></span><p>Reader view is currently unavailable for this document.</p></div></div>',readerContentLoadingTemplate:'<div class="readerContentLoading"><div class="loader">Loading...</div></div>'},entity:{entityTemplate:'<div class="entity noselect" title="<%= name %>"><div class="icon <%= entityIcon.class %>" style="color:<%= entityIcon.color %>"></div></div>',entityDetailsTemplate:'<div class="details"></div>',entityNameTemplate:'<div class="name"><%= name %></div>'}},e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,n){"use strict";e.exports={debugMode:!1,container:{width:"100%",height:"100%"},centerAfterFilter:!1,outline:{centerOutlinePosition:.5,sidebarEnabled:!0,maincontent:{minimizedWidth:24,entitiesRepositionDelay:500,entitiesRepositionInterval:300},sidebar:{minimizedWidth:24,entitiesRepositionDelay:500,entitiesRepositionInterval:300},entity:{entityDescriptionLength:15},reader:{readerWidth:500,readerHeight:"100%",onLoadUrl:null,disableAnimation:!1}},autoGenerateIconMap:!0,autoGenerateIconMappings:{person:[{"class":"fa fa-male",color:"#400000"},{"class":"fa fa-male",color:"#d26502"},{"class":"fa fa-male",color:"#f0ab21"},{"class":"fa fa-male",color:"#9ab3ca"},{"class":"fa fa-male",color:"#35364e"},{"class":"fa fa-male",isDefault:!0}],place:[{"class":"fa fa-globe",color:"#1b2c3f"},{"class":"fa fa-globe",color:"#3d697a"},{"class":"fa fa-globe",color:"#a68900"},{"class":"fa fa-globe",color:"#f4651a"},{"class":"fa fa-globe",color:"#fca771"},{"class":"fa fa-globe",isDefault:!0}],thing:[{"class":"fa fa-certificate",color:"#f9bac4"},{"class":"fa fa-certificate",color:"#d2e5eb"},{"class":"fa fa-certificate",color:"#91d4d1"},{"class":"fa fa-certificate",color:"#e5ab6a"},{"class":"fa fa-certificate",color:"#58373e"},{"class":"fa fa-certificate",isDefault:!0}]}}},{}],38:[function(t,e,n){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("bluebird"),s=t("./strippets.base"),a=t("stories.common").mediator,l=t("./strippets.config.js"),c=function(t,e,n,r,i,o){var s=this;return s.defaults=l.outline.entity,s.data=r,s._parentId=t,s._contentType=e,s.init(n,r,i,o),s.verticalPosition=0,s};c.prototype=Object.create(s.prototype),c.prototype.constructor=c,c.prototype.init=function(t,e,n,i){this.Settings=r.extend({},this.defaults,i),this.construct(t,e,n),this.registerEvents()},c.prototype.construct=function(t,e,n){var o=this,s=i.template(o.templates.entity.entityTemplate);this.$entity=r(s({entityIcon:o.getEntityIcon(e,n),name:e.name})).css("position","absolute").attr(o.attrs.entity,JSON.stringify({name:e.name,type:e.type})).addClass(o.classes.entity.outlineentity).appendTo(t);var a=i.template(o.templates.entity.entityNameTemplate);this.$name=r(a({name:e.name})).addClass(o.classes.entity.name),this.$details=r(o.templates.entity.entityDetailsTemplate).addClass(o.classes.entity.details).css("margin-left",o.Settings.minimizedWidth).text(e.description.substring(0,o.Settings.entityDescriptionLength)).hide().append(this.$name).appendTo(this.$entity)},c.prototype.registerEvents=function(){var t=this;t.$entity.on("click",t,function(e){var n=JSON.parse(r(e.target).closest("["+t.attrs.entity+"]").attr(t.attrs.entity));a.publish(t.events.outline.EntityClicked,{OutlineId:t._parentId,ContentType:t._contentType,EntityData:n}),e.stopPropagation()})},c.prototype.setPosition=function(t){this.verticalPosition=t;var e=.01*parseFloat(t),n=this.$entity.parent().height()*e-.5*this.$entity.height();return this.styles.entity.normal&&(n+=.5*parseFloat(this.styles.entity.normal.getPropertyValue("height"))),this.$entity.css("top",n+"px").promise()},c.prototype.getHeight=function(){return this.$entity.height()},c.prototype.getEntityIcon=function(t,e){var n=i.find(e,function(e){return e.type===t.type&&e.name===t.name});if(n)return{"class":n["class"],color:n.color};var r=i.find(e,function(e){return e.type===t.type&&e.isDefault});return r?{"class":r["class"],color:r.color}:{"class":"",color:""}},c.prototype.hideDetails=function(){return o.all([this.$details.hide().promise(),this.$name.hide().promise()])},c.prototype.showDetails=function(){return o.all([this.$details.show().promise(),this.$name.show().promise()])},e.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./strippets.base":36,"./strippets.config.js":37,bluebird:1,"stories.common":27}],39:[function(t,e,n){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("./strippets.base"),s=t("stories.common").mediator,a=t("./strippets.outline.js"),l=t("./strippets.config.js"),c=t("stories.common").mousehold,u=t("./uncharted.keyboard"),f=function(t,e){var n=this;return n.elem=t,n.$elem=r(t),n.options=e,n._data=[],n._items=[],n._iconMaps=[],n._airspace=0,n.init(),n.loadData=this.loadData,n.enableSidebar=this.enableSidebar,n};f.prototype=Object.create(o.prototype),f.prototype.constructor=f,f.prototype.init=function(){this.config=r.extend(!0,l,this.options,this.metadata),r.Velocity&&(r.Velocity.defaults.display=""),this.initializeContainer(),this.initializeIconMap(),this.registerEvents(),this.registerKeyboardHandler()},f.prototype.initializeContainer=function(){var t=this;t.$strippets=r(t.templates.container.strippetsTemplate).height(t.config.container.height).width(t.config.container.width).appendTo(t.$elem),t.$viewport=r(t.templates.container.viewportTemplate).height(t.config.container.height).width(t.config.container.width).addClass(t.classes.container.viewport).appendTo(t.$strippets),t.$chartContainer=r(t.templates.container.containerTemplate).addClass(t.classes.container.container).appendTo(t.$viewport);var e=r(t.templates.container.scrollLeftControlTemplate).addClass(t.classes.container.leftButton).appendTo(t.$strippets);t.$leftButton=r(t.templates.container.scrollLeftButtonTemplate).appendTo(e);var n=r(t.templates.container.scrollRightControlTemplate).addClass(t.classes.container.rightButton).appendTo(t.$strippets);t.$rightButton=r(t.templates.container.scrollRightButtonTemplate).appendTo(n),t.$elem.css("overflow","hidden"),t._airspace=t.$chartContainer.outerWidth(),t.$chartContainer.css("min-width",t.$viewport.width())},f.prototype.initializeIconMap=function(){var t=this;t.config.autoGenerateIconMap?i.each(t.config.autoGenerateIconMappings,function(e,n){var r=i.map(e,function(t){return{type:n,"class":t["class"],color:t.color||null,isDefault:t.isDefault}});t._iconMaps=i.union(t._iconMaps,r)}):t._iconMaps=t.config.entityIcons},f.prototype.registerEvents=function(){var t=this;c.asJQueryPlugin(),t.$viewport.on("click",function(e){var n=e.target===e.currentTarget,i=e.target===t.$chartContainer[0],o=r(e.target).hasClass(t.classes.outline.outlinecontainer);(n||i||o)&&(s.publish(t.events.outline.Minimize),s.publish(t.events.outline.ReOrderEntity))});var e=function(e){return function(n){var r=1500,i=n>r?r:n,o=(i/300*2+1)*e;t.$viewport.stop(!0,!0).animate({scrollLeft:"+="+o})}};t.$leftButton.mousehold().bind(e(-1)),t.$rightButton.mousehold().bind(e(1)),s.subscribe(t.events.outline.CenterElement,t.centerElement,{},t)},f.prototype.registerKeyboardHandler=function(){var t=this,e=function(t,e){return i.find(e,function(e){return e.getToState()===t})},n=function(n){var r,o=i.findIndex(t._items,function(t){return"readingmode"===t.getToState()}),s=t._items[o];s&&(r=n?e("minimal",t._items.slice(0,o).reverse()):e("minimal",t._items.slice(o+1)),r&&(s.transitionState("minimal"),r.transitionState("readingmode")))},r=new u(document);r.bindKeydown(function(t){switch(t){case 37:n(!0);break;case 39:n();break;default:return}})},f.prototype.loadData=function(t,e){t&&(this.config.entityIcons||this.mapEntitiesToIconMap(t,this._iconMaps),this._data=e?this._data.concat(t):t,this.render(t))},f.prototype.mapEntitiesToIconMap=function(t,e){var n=function(t,e){return t.concat(e.entities)},r=function(t){return t.name+"&"+t.type},o=function(t){return{type:t[0].type,name:t[0].name,count:t.length}},s=i.chain(t).reduce(n,[]).groupBy(r).map(o).sortBy(function(t){return-t.count}).value();s.forEach(function(t){var n=i.some(e,function(e){return e.type===t.type&&void 0!==t.name&&e.name===t.name});if(!n){var r=i.find(e,function(e){return e.type===t.type&&void 0===e.name&&!e.isDefault});r&&(r.name=t.name)}})},f.prototype.render=function(t){var e=this;i.each(t,function(t){var n=e.config.outline;n.debugMode=e.config.debugMode;var r=new a(e.$chartContainer,t,e._iconMaps,n);e._items.push(r)})},f.prototype.centerElement=function(t){var e=this,n=0;t.$element&&(n=-.5*(e.$viewport.width()-t.expectedWidth));var r=i.reduce(e._items.slice(0,i.findIndex(e._items,function(e){return e._id===t.id})),function(t,e){return e.isInTransition()?t-e.getTransitionSizes().current.width:t},0);return t.$element.velocity("scroll",{axis:"x",container:e.$viewport,offset:n+r}).promise()},f.prototype.enableSidebar=function(t){s.publish(this.events.outline.EnableSidebar,t)},f.prototype.applyFilter=function(t){s.publish(this.events.outline.ReOrderEntity,{entity:t}),this.config.centerAfterFilter&&this.startAutoCentering()},f.prototype.startAutoCentering=function(){var t=this;if(!t.$viewport.hasClass(t.classes.container.autoCenter)){t.$viewport.addClass(t.classes.container.autoCenter);var e,n=t.$viewport.width(),r=t.$viewport[0].scrollWidth-n,i=setInterval(function(){var o=t.$viewport[0].scrollLeft,s=t.$viewport[0].scrollWidth-n,a=s/2,l=.5*Math.abs(r-s);r!==s&&(a>o?t.$viewport[0].scrollLeft+=l:o>a&&(t.$viewport[0].scrollLeft-=l),r=s,clearTimeout(e),e=setTimeout(function(){clearInterval(i),t.$viewport.removeClass(t.classes.container.autoCenter)},100))},0)}},e.exports=f,e.exports.asJQueryPlugin=function(){r.fn.strippets=function(t){var e=this,n={initialize:function(t){this._strippets=new f(this,t)},loaddata:function(t,e){this._strippets.loadData(t,e)},enablesidebar:function(t){this._strippets.enableSidebar(t)},applyfilter:function(t){this._strippets.applyFilter(t)},dispose:function(){e.each(function(t,e){e._strippets=null,e.remove()})}},i=arguments;return e.each(function(e,o){void 0===t?n.initialize.apply(o,null):n[t]?n[t].apply(o,Array.prototype.slice.call(i,1)):"object"!=typeof t&&t?r.error("Command: "+t+"does not exist."):n.initialize.apply(o,i)})}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./strippets.base":36,"./strippets.config.js":37,"./strippets.outline.js":41,"./uncharted.keyboard":44,"stories.common":27}],40:[function(t,e,n){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("bluebird"),s=t("./strippets.entity.js"),a=t("./strippets.base"),l=t("stories.common").scrollable,c=t("./strippets.config.js"),u=function(t,e,n,r,i){var o=this;return o.defaults=c.outline.maincontent,o._parentId=t,o.entities=[],o.contentType="Feature",o.init(e,n,r,i),o};u.prototype=Object.create(a.prototype),u.prototype.constructor=u,u.prototype.init=function(t,e,n,i){this.Settings=r.extend({},this.defaults,i),this.constructLayout(t,e.title),this.constructEntities(e,n),this.registerEvents()},u.prototype.constructLayout=function(t,e){var n=this;n.$mainOutlineContent=r(n.templates.maincontent.outlineMainTemplate).addClass(n.classes.maincontent.outlinemaincontent).width(n.Settings.minimizedWidth).appendTo(t);var o=i.template(n.templates.maincontent.titleTemplate);n.$title=r(o({title:e})).addClass(n.classes.maincontent.title).hide().appendTo(n.$mainOutlineContent),n.$outlineEntityContainer=r(n.templates.maincontent.entityContainerTemplate).addClass(n.classes.maincontent.outlineentitycontainer).appendTo(n.$mainOutlineContent)},u.prototype.constructEntities=function(t,e){var n=0,r=this,o=r.Settings.entity;i.chain(t.entities).sortBy(function(t){return t.firstPosition}).each(function(t){var i=parseFloat(t.firstPosition);n>i?(t.firstPositionOffset=n-i,i=n):t.firstPositionOffset=0;var a=new s(r._parentId,r.contentType,r.$outlineEntityContainer,t,e,o);a.setPosition((100*i).toString()+"%"),n=i+a.getHeight()/r.$outlineEntityContainer.height(),r.entities.push(a)})},u.prototype.rePositionEntities=function(){var t=this,e=0;t.entities.forEach(function(n){var r=n.data,i=parseFloat(r.firstPosition);e>i?(r.firstPositionOffset=e-i,i=e):r.firstPositionOffset=0,n.setPosition((100*i).toString()+"%"),e=i+n.getHeight()/t.$outlineEntityContainer.height()})},u.prototype.registerEvents=function(){var t,e=this;l.asJQueryPlugin(),r(window).resize(function(){clearTimeout(t),t=setTimeout(e.rePositionEntities.bind(e),e.Settings.entitiesRepositionDelay)});var n;r(window).resize(function(){e.$mainOutlineContent[0].offsetParent||n||(n=setInterval(function(){e.$mainOutlineContent[0].offsetParent&&(e.rePositionEntities(),window.clearInterval(n),n=void 0)},e.Settings.entitiesRepositionInterval))})},u.prototype.hide=function(){var t=this;return t.$outlineEntityContainer.hide(),t.$mainOutlineContent.velocity({width:0},{display:"none"}).promise()},u.prototype.minimize=function(){var t=this;return t.$title.hide(),o.all(t.entities.map(function(t){return t.hideDetails()})).then(function(){return t.$mainOutlineContent.velocity({width:t.Settings.minimizedWidth}).promise().then(function(){t.$outlineEntityContainer.show()})})},u.prototype.enableScroll=function(t){var e=this,n=r(t),i=e.$mainOutlineContent.height()-(e.$title.is(":visible")?e.$title.height():0)-e.$outlineEntityContainer.height(),o=n.height()/n.children().outerHeight(!0);e.$slider=r(e.templates.maincontent.sliderTemplate).addClass(e.classes.maincontent.slider).css("height","calc("+100*o+"% + "+i+"px)").appendTo(e.$outlineEntityContainer),e.$outlineEntityContainer.scrollable({sliderSelector:"."+e.classes.maincontent.slider,viewportSelector:t}),r(window).resize(function(){o=n.height()/n.children().outerHeight(!0),e.$slider.css("height","calc("+100*o+"% + "+i+"px)")})},u.prototype.getEntityContainerHeight=function(){var t=this;return t.$outlineEntityContainer.height()},e.exports=u}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./strippets.base":36,"./strippets.config.js":37,"./strippets.entity.js":38,bluebird:1,"stories.common":27}],41:[function(t,e,n){(function(n){"use strict";function r(t,e,n,r){var i=this;return i.defaults=d.outline,i.data=e,i.feature=null,i.sidebar=null,i.stateIndex=-1,i.toStateIndex=-1,i.iconMap=n,i.layoutValues={},i.changeStateTo=[],i.readerData=null,i.readerText=null,i.readerTextHTML=null,i.init(t,r),i}var i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,s=t("bluebird"),a=t("./strippets.base"),l=t("stories.common").mediator,c=t("./strippets.outline.feature.js"),u=t("./strippets.outline.sidebar.js"),f=t("./strippets.outline.reader.js"),d=t("./strippets.config.js");r.prototype=Object.create(a.prototype),r.prototype.constructor=r,r._states=["hidden","minimal","readingmode"],r.prototype.init=function(t,e){this.Settings=i.extend({},this.defaults,e),this._id=this.generateId(),this.constructLayout(t),this.initializeReader(),this.initializeMainContent(),this.initializeSidebar(),this.registerEvents(),this.registerStateMachine(),this._currentOutlinePosition=this.Settings.centerOutlinePosition,this.toStateIndex=r._states.indexOf("minimal"),this.stateIndex=r._states.indexOf("minimal"),this.transitionPromise=s.resolve()},r.prototype.generateId=function(){return"_"+Math.random().toString(36).substr(2,9)},r.prototype.getCurrentState=function(){return r._states[this.stateIndex]},r.prototype.getToState=function(){return r._states[this.toStateIndex]},r.prototype.constructLayout=function(t){this.$outlineContainer=i(this.templates.outline.outlineContainerTemplate).addClass(this.classes.outline.outlinecontainer).addClass(this.classes.outline.minimizedmode).appendTo(t),this.$outline=i(this.templates.outline.outlineItemTemplate).addClass(this.classes.outline.outline).appendTo(this.$outlineContainer),this.$outlineHeader=i(this.templates.outline.outlineHeaderTemplate).appendTo(this.$outline),this.$outlineSourceIcon=i(this.templates.outline.outlineSourceIconTemplate).addClass(this.classes.outline.sourceIcon).appendTo(this.$outlineHeader),this.data.sourceimage&&this.$outlineSourceIcon.css("background-image","url('"+this.data.sourceimage+"')");var e=o.template(this.templates.outline.outlineSourceTemplate);this.$outlineSource=i(e({src_url:this.data.sourceUrl,src_title:this.data.source})).addClass(this.classes.outline.sourceText).appendTo(this.$outlineSourceIcon)},r.prototype.initializeReader=function(){var t=this,e=t.Settings.reader;t.reader=new f(t._id,t.$outline,e)},r.prototype.initializeMainContent=function(){var t=this,e=t.Settings.maincontent;e.entity=t.Settings.entity,t.feature=new c(t._id,t.$outline,t.data,t.iconMap,e)},r.prototype.initializeSidebar=function(){var t=this;if(t.data.sidebars&&t.data.sidebars.length>0){var e=t.Settings.sidebar;e.entity=t.Settings.entity,e.events=t.events.outline,e.headerSpace=0,t.sidebar=new u(t._id,t.$outline,t.data.sidebars,t.iconMap,e)}},r.prototype.registerEvents=function(){var t=this;l.subscribe(t.events.outline.EntityClicked,t.handleEntityClicked.bind(t),{predicate:function(e){return e.OutlineId===t._id&&"Feature"===e.ContentType}}),t.$outline.on("click",t,function(t){var e=t.data;if("hidden"!==e.getCurrentState())return"expanded"===e.getCurrentState()?e.transitionState("readingmode"):void("readingmode"!==e.getCurrentState()&&(e.transitionState("readingmode"),t.shiftKey||l.publish(e.events.outline.Minimize,e._id)))}),l.subscribe(t.events.outline.ReOrderEntity,function(e){t.sortAndFilter(e?e.entity:null)},{predicate:function(e){return!e||e.sourceOutlineId!==t._id}}),l.subscribe(t.events.outline.Minimize,function(){t.transitionState("minimal")},{predicate:function(e){return e!==t._id?t.toStateIndex>r._states.indexOf("minimal"):void 0}},t),l.subscribe(t.events.outline.EnableSidebar,function(e){t.Settings.sidebarEnabled!==e&&(t.Settings.sidebarEnabled=e,t.sidebar&&"hidden"!==t.getCurrentState()&&t.sidebar.toggle(e))},{predicate:function(){return t.sidebar}})},r.prototype.handleEntityClicked=function(t){var e=this;if("minimal"===e.getCurrentState())l.publish(e.events.outline.Minimize,e._id),e.transitionState("readingmode");else if("readingmode"===e.getCurrentState()&&e.readerText){var n=t.EntityData.name.replace(/\s+/g,"_");e.scrollToFirstInstanceOfEntity(n)}},r.prototype.highlightInstances=function(t,e,n){var r,i,o=this,s=[];for(r=0,i=t.length;i>r;++r){var a,l=t[r],c=new RegExp("(^|[\\s\"'>])("+l+")($|[\\s,.!?\"'<])","gim");for(a=c.exec(e);a;a=c.exec(e))s.push(a)}if(s.length){s.sort(function(t,e){return t.index-e.index});var u="",f=0;for(r=0,i=s.length;i>r;++r){var d=s[r];u+=e.substring(f,d.index),u+=d[1],u+='<span id="'+n+"_"+r+'" class="'+o.classes.outline.highlightedText+'">',u+=d[2],u+="</span>",u+=d[3],f=d.index+d[0].length}f<e.length&&(u+=e.substring(f,e.length)),o.readerText.html(u)}},r.prototype.scrollToFirstInstanceOfEntity=function(t){var e=this,n=e.readerText.find("#"+t+"_0");if(n.length){var r=e.reader.$readerContent.scrollTop()+n.offset().top-e.reader.$readerContent.offset().top;e.reader.$readerContent.animate({scrollTop:r+"px"},"fast")}},r.prototype.hideOutlineItem=function(){var t=this,e=[t.feature.hide()];return t.$outline.css({"border-left-width":"0","border-right-width":"0"}),t.sidebar&&e.push(t.sidebar.hide()),s.all(e)},r.prototype.minimizeOutlineItem=function(){var t=this,e=[t.feature.minimize()];return t.$outline.css({"border-left-width":"0.5px","border-right-width":"0.5px"}),t.sidebar&&t.Settings.sidebarEnabled&&e.push(t.sidebar.minimize()),s.all(e)},r.prototype.sortAndFilter=function(t){var e=this,n=t instanceof Array?t:[t],r="hidden"===e.getToState(),i=[];if(t){var a=!1;o.each(n,function(t){var n=t instanceof Array?t:[t];if(!a){var r=o.find(e.data.entities,function(t){return o.some(n,function(e){return t.type===e.type&&t.name===e.name})});a=!r}}),a?i.push(e.transitionState("hidden")):r&&i.push(e.transitionState("minimal"))}else r&&i.push(e.transitionState("minimal"));return s.all(i)},r.prototype.openReadingMode=function(){var t=this,e=[];return e.push(t.reader.open().then(function(){t.readerData||t.loadReadingModeContent()})),t.styles.outlineItem.reading&&e.push(t.$outline.velocity({"margin-right":t.styles.outlineItem.reading.getPropertyValue("margin-right"),"margin-left":t.styles.outlineItem.reading.getPropertyValue("margin-left")})),e.push(l.publish(t.events.outline.CenterElement,{$element:t.$outlineContainer,expectedWidth:t.getTransitionSizes("readingmode").anticipated.width,id:t._id})),s.all(e)},r.prototype.loadReadingModeContent=function(){var t=this;return t.reader.load(t.data.readerUrl).then(function(e){if(t.readerData=e,t.reader.$readerContent){t.readerText=t.reader.$readerContent.find("div.content"),t.readerTextHTML=t.readerText.html();for(var n=t.feature.entities,r=t.readerTextHTML,i=0,o=n.length;o>i;++i){var s=n[i].data,a=s.name.replace(/\s+/g,"_");t.highlightInstances([s.name],r,a,!1),r=t.readerText.html()}}t.feature.enableScroll(t.reader.getReaderContentSelector())})},r.prototype.closeReadingMode=function(){var t=this,e=[];return t.reader.destroy(),t.styles.outlineItem.normal&&e.push(t.$outline.velocity({"margin-right":t.styles.outlineItem.normal.getPropertyValue("margin-right"),"margin-left":t.styles.outlineItem.normal.getPropertyValue("margin-left")})),e.push(t.reader.hide()),s.all(e)},r.prototype.toggleClassesForState=function(t){var e=this;e.$outlineContainer.toggleClass(e.classes.outline.hiddenmode,"hidden"===t),e.$outlineContainer.toggleClass(e.classes.outline.minimizedmode,"minimal"===t),e.$outlineContainer.toggleClass(e.classes.outline.readmode,"readingmode"===t)},r.prototype.registerStateMachine=function(){var t=this;t.changeStateTo=[];var e=function(e){return function(){t.stateIndex=r._states.indexOf(e),t.toggleClassesForState(e)}};t.changeStateTo[0]=function(){return t.hideOutlineItem().then(e("hidden"))},t.changeStateTo[1]=function(){return"readingmode"===t.getCurrentState()?t.closeReadingMode().then(e("minimal")):t.minimizeOutlineItem().then(e("minimal"))},t.changeStateTo[2]=function(){return t.openReadingMode().then(e("readingmode"))}},r.prototype.changeStatesSequentially=function(t,e){var n=this,r=[];return e>t?r=n.changeStateTo.slice(t+1,e+1):t>e&&(r=n.changeStateTo.slice(e,t).reverse()),r.reduce(function(t,e){return t.then(e)},s.resolve())},r.prototype.transitionState=function(t){var e=this;return e.toStateIndex=r._states.indexOf(t),e.transitionPromise=e.transitionPromise.then(function(){return e.changeStatesSequentially(e.stateIndex,e.toStateIndex)}),e.transitionPromise},r.prototype.isInTransition=function(){return this.stateIndex!==this.toStateIndex},r.prototype.getTransitionSizes=function(t){var e=this,n={height:this.$outline.height(),width:this.$outline.width()},r={height:n.height,width:n.width};if(t||e.isInTransition()){var i=t||e.getToState();r="readingmode"===i?{height:e.$outline.height(),width:e.Settings.reader.readerWidth+e.Settings.maincontent.minimizedWidth+(e.Settings.sidebarEnabled&&e.sidebar?e.Settings.sidebar.minimizedWidth:0)}:{height:e.$outline.height(),width:e.Settings.maincontent.minimizedWidth+(e.Settings.sidebarEnabled&&e.sidebar?e.Settings.sidebar.minimizedWidth:0)}}return{current:n,anticipated:r}},e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./strippets.base":36,"./strippets.config.js":37,"./strippets.outline.feature.js":40,"./strippets.outline.reader.js":42,"./strippets.outline.sidebar.js":43,bluebird:1,"stories.common":27}],42:[function(t,e,n){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("bluebird"),s=t("./strippets.base"),a=t("./strippets.config.js"),l=function(t,e,n){var r=this;return r.defaults=a.outline.reader,r._id=t,r.init(e,n),r.readerContext={rootUrl:void 0},r};l.prototype=Object.create(s.prototype),l.prototype.constructor=l,l.prototype.init=function(t,e){this.Settings=r.extend({},this.defaults,e),this.compiledReaderContentTemplate=i.template(this.templates.reader.readerContentTemplate),this.compiledReaderContentErrorTemplate=i.template(this.templates.reader.readerContentErrorTemplate),this.construct(t),this.registerEvents()},l.prototype.construct=function(t){this.$readingPane=r(this.templates.reader.readerTemplate).width("0").appendTo(t)},l.prototype.registerEvents=function(){var t=this;t.$readingPane.on("click","a",function(e){e.preventDefault();var n=r(e.target).closest("a"),i=n.attr("href");i&&("/"===i[0]&&t.readerContext.rootUrl&&(i=t.readerContext.rootUrl+i),window.open(i,"_blank"))})},l.prototype.open=function(){var t=this,e={duration:t.Settings.disableAnimation?0:void 0};return t.$readingPane.velocity({width:t.Settings.readerWidth},e).promise()},l.prototype.load=function(t){var e=this,n=function(t){return function(n){return new o(function(i){e.$readerContent=r(t({data:n})).addClass(e.classes.reader.readerContent).width(e.Settings.readerWidth).height(e.Settings.readerHeight),e.$readingPane.html(e.$readerContent),i(n)})}},i=function(t){var n,r=t.sourceUrl,i=document.createElement("a");return i.href=r,n=r.substring(0,r.indexOf(i.pathname)),e.readerContext.rootUrl=n,o.resolve(t)};return e.$readingPane.html(e.templates.reader.readerContentLoadingTemplate),o.resolve(e.Settings.onLoadUrl(t)).then(n(e.compiledReaderContentTemplate)).then(i)["catch"](n(e.compiledReaderContentErrorTemplate))},l.prototype.destroy=function(){this.$readingPane.html("")},l.prototype.getReaderHeight=function(){return this.$readingPane.height()-20},l.prototype.hide=function(){var t={duration:this.Settings.disableAnimation?0:void 0,display:"none"};return this.$readingPane.velocity({width:0,"border-width":0},t).promise();
},l.prototype.getReaderContentSelector=function(){return"."+this.classes.reader.readerContent},e.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./strippets.base":36,"./strippets.config.js":37,bluebird:1}],43:[function(t,e,n){(function(n){"use strict";var r="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,i="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,o=t("bluebird"),s=t("./strippets.base"),a=t("./strippets.config.js"),l=t("./strippets.entity.js"),c=function(t,e,n,r,i){var o=this;return o.defaults=a.outline.sidebar,o._parentId=t,o.entities=[],o.contentType="Sidebar",o.init(e,n,r,i),o};c.prototype=Object.create(s.prototype),c.prototype.constructor=c,c.prototype.init=function(t,e,n,i){this.Settings=r.extend({},this.defaults,i),this.constructLayout(t),this.constructEntities(e,n),this.registerEvents()},c.prototype.constructLayout=function(t){var e=this;e.$sidebarContent=r(e.templates.sidebar.sidebarTemplate).addClass(e.classes.sidebar.sidebarContainer).data(e.attrs.minimizedWidth,e.Settings.minimizedWidth).appendTo(t),e.$sidebarEntityContainer=r(e.templates.sidebar.entityContainerTemplate).addClass(e.classes.sidebar.sidebarentitycontainer).appendTo(e.$sidebarContent)},c.prototype.constructEntities=function(t,e){var n=0,r=this,o=r.Settings.entity;i.chain(t).sortBy(function(t){return t.firstPosition}).each(function(t){var i=parseFloat(t.firstPosition);n>i?(t.firstPositionOffset=n-i,i=n):t.firstPositionOffset=0;var s=new l(r._parentId,r.contentType,r.$sidebarEntityContainer,t,e,o);s.setPosition((100*i).toString()+"%"),n=i+s.getHeight()/r.$sidebarEntityContainer.height(),r.entities.push(s)})},c.prototype.rePositionEntities=function(){var t=this,e=0;t.entities.forEach(function(n){var r=n.data,i=parseFloat(r.firstPosition);e>i?(r.firstPositionOffset=e-i,i=e):r.firstPositionOffset=0,n.setPosition((100*i).toString()+"%"),e=i+n.getHeight()/t.$sidebarEntityContainer.height()})},c.prototype.registerEvents=function(){var t,e=this;r(window).resize(function(){clearTimeout(t),t=setTimeout(e.rePositionEntities.bind(e),e.Settings.entitiesRepositionDelay)});var n;r(window).resize(function(){e.$sidebarContent[0].offsetParent||n||(n=setInterval(function(){e.$sidebarContent[0].offsetParent&&(e.rePositionEntities(),window.clearInterval(n),n=void 0)},e.Settings.entitiesRepositionInterval))})},c.prototype.hide=function(){var t=this;return t.$sidebarEntityContainer.hide(),t.$sidebarContent.velocity({width:0},{display:"none"}).promise()},c.prototype.minimize=function(){var t=this;return o.all(t.entities.map(function(t){return t.hideDetails()})).then(function(){return t.$sidebarContent.velocity({width:t.Settings.minimizedWidth}).promise().then(function(){t.$sidebarEntityContainer.show()})})},c.prototype.toggle=function(t){t?this.minimize():this.hide()},e.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./strippets.base":36,"./strippets.config.js":37,"./strippets.entity.js":38,bluebird:1}],44:[function(t,e,n){(function(t){"use strict";var n="undefined"!=typeof window?window.$:"undefined"!=typeof t?t.$:null,r=function(t){var e,r;this.isHolding=function(t){return e[t]},this.bindKeydown=function(i){e||(e={}),n(t).keydown(function(t){r||(e[t.which]=!0,r=setTimeout(function(){i(t.which),r=void 0},300))}),n(t).keyup(function(t){delete e[t.which]})}};e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],45:[function(t,e,n){"use strict";e.exports.config={thumbnails:{entityIcons:null,autoGenerateIconMappings:{person:[{"class":"fa fa-male",color:"#400000"},{"class":"fa fa-male",color:"#d26502"},{"class":"fa fa-male",color:"#f0ab21"},{"class":"fa fa-male",color:"#9ab3ca"},{"class":"fa fa-male",color:"#35364e"},{"class":"fa fa-male",isDefault:!0}],place:[{"class":"fa fa-globe",color:"#1b2c3f"},{"class":"fa fa-globe",color:"#3d697a"},{"class":"fa fa-globe",color:"#a68900"},{"class":"fa fa-globe",color:"#f4651a"},{"class":"fa fa-globe",color:"#fca771"},{"class":"fa fa-globe",isDefault:!0}],thing:[{"class":"fa fa-certificate",color:"#f9bac4"},{"class":"fa fa-certificate",color:"#d2e5eb"},{"class":"fa fa-certificate",color:"#91d4d1"},{"class":"fa fa-certificate",color:"#e5ab6a"},{"class":"fa fa-certificate",color:"#58373e"},{"class":"fa fa-certificate",isDefault:!0}]},infiniteScrollDistance:10},thumbnail:{height:400},readerview:{readerWidth:500,entityBarWidth:24,onLoadUrl:null}},e.exports.classes={thumbnails:{thumbnailsContainer:".thumbnails-container"},thumbnail:{cardImage:".card-image",title:".title"},readerview:{readerContainer:".reader-container",buttonContainer:".button-container",readerNextButton:".reader-next-button",readerPrevButton:".reader-prev-button"}},e.exports.events={thumbnailClicked:"[Thumbnail::ThumbnailClicked]"}},{}],46:[function(t,e,n){(function(n){"use strict";function r(t){var e=this;e.iconMap=null,e._config=i.extend({},a.config.thumbnails,t.config),e._$parent=i(t.container),e._$element=null,e._readerview=null,e._thumbnailItems=[],e._init()}var i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("./thumbnails.thumbnail"),s=t("./thumbnails.readerview"),a=t("./thumbnails.defaults"),l=t("./thumbnails.util"),c=t("stories.common").InfiniteScroll,u=t("../templates/thumbnails.handlebars"),f=t("../templates/dummythumbnail.handlebars");r.prototype._init=function(){var t=this;t.iconMap=t._config.entityIcons||l.flattenIconMap(t._config.autoGenerateIconMappings),t._readerview=new s({$parent:t._$parent,config:t._config.readerview}),t._$element=i(u()).appendTo(t._$parent),t._$thumbnailsContainer=t._$element.find(a.classes.thumbnails.thumbnailsContainer),t._infiniteScroll=new c(t._$element,t._config.infiniteScrollDistance);for(var e=0;20>e;++e)t._$thumbnailsContainer.append(i(f()))},r.prototype._render=function(t){var e=this;t.forEach(function(t){var n=new o({$parent:e._$thumbnailsContainer,data:t,config:e._config.thumbnail});e._thumbnailItems.push(n)}),e._$thumbnailsContainer.find(".dummyThumbnail").appendTo(e._$thumbnailsContainer)},r.prototype._resetThumbnailsContainer=function(){var t=this;t._thumbnailItems=[],t._$thumbnailsContainer.empty();for(var e=0;20>e;++e)t._$thumbnailsContainer.append(i(f()))},r.prototype.loadData=function(t,e){var n=this;e||n._resetThumbnailsContainer(),n._config.entityIcons||(n.iconMap=l.mapEntitiesToIconMap(t,n.iconMap)),n._render(t),n._readerview.updateThumbnailItems(n._thumbnailItems,n.iconMap)},r.prototype.onInfinite=function(t){var e=this;e._infiniteScroll.onInfinite(function(){t().then(function(t){e.loadData(t,!0),e._infiniteScroll.infiniteScrollDone()})})},e.exports=r,e.exports.asJQueryPlugin=function(){i.fn.thumbnails=function(t){var e=this,n={initialize:function(t){this._thumbnails=new r({container:this,config:t})},loaddata:function(t,e){this._thumbnails.loadData(t,e)},onInfinite:function(t){this._thumbnails.onInfinite(t)},dispose:function(){e.each(function(t,e){e._thumbnails=null,e.remove()})}},o=arguments;return e.each(function(e,r){void 0===t?n.initialize.apply(r,null):n[t]?n[t].apply(r,Array.prototype.slice.call(o,1)):"object"!=typeof t&&t?i.error("Command: "+t+"does not exist."):n.initialize.apply(r,o)})}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../templates/dummythumbnail.handlebars":50,"../templates/thumbnails.handlebars":53,"./thumbnails.defaults":45,"./thumbnails.readerview":47,"./thumbnails.thumbnail":48,"./thumbnails.util":49,"stories.common":27}],47:[function(t,e,n){(function(n){"use strict";function r(t){var e=this;e.thumbnailItems=[],e.iconMap=[],e._config=i.extend({},a.config.readerview,t.config),e._$parent=t.$parent,e._$element=null,e._init()}var i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o="undefined"!=typeof window?window._:"undefined"!=typeof n?n._:null,s=t("../templates/readerview.handlebars"),a=t("./thumbnails.defaults.js"),l=t("strippets").Outline,c=t("stories.common").mediator,u=t("stories.common").Keyboard;r.prototype._init=function(){var t=this;t._$element=i(s()).appendTo(t._$parent),t._$readerContainer=t._$element.find(a.classes.readerview.readerContainer),t._$buttonContainer=t._$element.find(a.classes.readerview.buttonContainer),t._$nextButton=t._$element.find(a.classes.readerview.readerNextButton),t._$prevButton=t._$element.find(a.classes.readerview.readerPrevButton),t._$readerContainer.width(t._config.readerWidth),t._$buttonContainer.width(t._config.readerWidth),t._registerEvents()},r.prototype._registerEvents=function(){var t=this,e=new u(t._$element);e.bindKeydown(function(e){var n=37,r=39;e===n&&t._navigate(-1),e===r&&t._navigate(1)}),t._$element.on("click",function(e){e.target===t._$element[0]&&t.close()}),t._$nextButton.on("click",function(){t._navigate(1)}),t._$prevButton.on("click",function(){t._navigate(-1)}),c.subscribe(a.events.thumbnailClicked,function(e){t.loadOutline(e),t.open()})},r.prototype._navigate=function(t){var e=this,n=o.findIndex(e.thumbnailItems,function(t){return t.data.id===e._currentLoadedThumbnailData.id}),r=n+t;r>=0&&r<e.thumbnailItems.length&&e.loadOutline(e.thumbnailItems[r].data)},r.prototype.open=function(){var t=this;t._$element.addClass("open"),t._$element.focus()},r.prototype.close=function(){var t=this;t._$element.removeClass("open")},r.prototype.updateThumbnailItems=function(t,e){this.thumbnailItems=t,this.iconMap=e},r.prototype.loadOutline=function(t){var e,n=this,r=n._config.entityBarWidth,i={reader:{disableAnimation:!0,readerWidth:n._config.readerWidth-r,onLoadUrl:function(t){return Promise.resolve(n._config.onLoadUrl(t)).then(function(t){return e.$outlineContainer.addClass("outline-loaded"),t})}},maincontent:{minimizedWidth:r}};n._$readerContainer.html(""),n._currentLoadedThumbnailData=t,e=new l(n._$readerContainer,t,n.iconMap,i),e.transitionState("readingmode")},e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../templates/readerview.handlebars":51,"./thumbnails.defaults.js":45,"stories.common":27,strippets:35}],48:[function(t,e,n){(function(n){"use strict";function r(t){var e=this;e.data=t.data,e._$parent=t.$parent,e._config=t.config,e._$element=null,e._init()}var i="undefined"!=typeof window?window.$:"undefined"!=typeof n?n.$:null,o=t("../templates/thumbnail.handlebars"),s=t("./thumbnails.defaults.js"),a=t("stories.common").mediator;r.prototype._init=function(){var t=this;t.data.formattedDate=t._formatDate(t.data.articledate),t._$element=i(o(t.data)).height(t._config.height).appendTo(t._$parent),t.data.imageUrl&&t._loadImages(t.data.imageUrl,t._$element.find(".card-image")),t._registerEvents()},r.prototype._registerEvents=function(){var t=this;t._$element.on("click",s.classes.thumbnail.cardImage,function(){a.publish(s.events.thumbnailClicked,t.data)}),t._$element.on("click",s.classes.thumbnail.title,function(){a.publish(s.events.thumbnailClicked,t.data)})},r.prototype._formatDate=function(t){var e=new Date(t),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return n[e.getUTCMonth()]+". "+e.getUTCDate()+", "+e.getUTCFullYear()},r.prototype._loadImages=function(t,e){var n,r,o,s=this,a=[];for(o=t instanceof Array?t:[t],n=0,r=o.length;r>n;++n)a.push(s._loadImage(o[n]));return Promise.all(a).then(function(t){var s,a=e.width(),l=e.height(),c=a/o.length,u=1/o.length*100+"%",f=l;for(n=0,r=t.length;r>n;++n){s=t[n];var d=t[n].height;s.width>a&&(d*=a/s.width),f=Math.max(f,d)}f>l&&f>.5*e.parent().height()&&(f=.5*e.parent().height()),f!==l&&e.css("height",f);var p=o.length>1;for(n=0,r=o.length;r>n;++n){s=t[n];var h,g=i("<div></div>"),v=Math.max(c/s.width,f/s.height),m=Math.round(s.width*v);h=p&&c>m||!p&&m>c?"contain":v>1?"auto":"cover",g.css("background-image",'url("'+o[n]+'")'),g.css("background-size",h),g.css("width",u),g.css("height",e.height()),e.append(g)}return Promise.resolve(t)},function(t){throw t})},r.prototype._loadImage=function(t){return new Promise(function(e){var n=i("<img />").on("load",function(){e(n[0])}).attr("src",t)})},e.exports=r}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../templates/thumbnail.handlebars":52,"./thumbnails.defaults.js":45,"stories.common":27}],49:[function(t,e,n){(function(t){"use strict";var n="undefined"!=typeof window?window._:"undefined"!=typeof t?t._:null;e.exports.flattenIconMap=function(t){var e=[];return n.each(t,function(t,r){var i=n.map(t,function(t){return{type:r,"class":t["class"],color:t.color||null,isDefault:t.isDefault}});e=n.union(e,i)}),e},e.exports.mapEntitiesToIconMap=function(t,e){var r=function(t,e){return t.concat(e.entities)},i=function(t){return t.name+"&"+t.type},o=function(t){return{type:t[0].type,name:t[0].name,count:t.length,reverseCount:-t.length}},s=n.chain(t).reduce(r,[]).groupBy(i).map(o).sortBy("reverseCount").value();return s.forEach(function(t){var r=n.some(e,function(e){return e.type===t.type&&void 0!==t.name&&e.name===t.name});if(!r){var i=n.find(e,function(e){return e.type===t.type&&void 0===e.name&&!e.isDefault});i&&(i.name=t.name)}}),e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],50:[function(t,e,n){var r=t("handlebars/runtime")["default"].template;e.exports=r({compiler:[7,">= 4.0.0"],main:function(t,e,n,r,i){return'<div class="dummyRecord">\n</div>'},useData:!0})},{"handlebars/runtime":21}],51:[function(t,e,n){var r=t("handlebars/runtime")["default"].template;e.exports=r({compiler:[7,">= 4.0.0"],main:function(t,e,n,r,i){return'<div class="readerview" tabindex="1">\n    <div class="reader-container center-item-container">\n    </div>\n    <div class="button-container center-item-container">\n        <div class="reader-page-button reader-prev-button">\n            <i class="fa fa-left fa-chevron-left"></i>\n        </div>\n        <div class="reader-page-button reader-next-button">\n            <i class="fa fa-left fa-chevron-right"></i>\n        </div>\n    </div>\n</div>\n'},useData:!0})},{"handlebars/runtime":21}],52:[function(t,e,n){var r=t("handlebars/runtime")["default"].template;e.exports=r({1:function(t,e,n,r,i){return'            <div class="card-image">\n            </div>\n'},3:function(t,e,n,r,i){return'            <div class="card-header">\n            </div>\n'},5:function(t,e,n,r,i){var o,s=null!=e?e:{},a=n.helperMissing,l="function",c=t.escapeExpression;return'                    <li>\n                        <time class="updated" datetime="'+c((o=null!=(o=n.articledate||(null!=e?e.articledate:e))?o:a,typeof o===l?o.call(s,{name:"articledate",hash:{},data:i}):o))+'" pubdate="">'+c((o=null!=(o=n.formattedDate||(null!=e?e.formattedDate:e))?o:a,typeof o===l?o.call(s,{name:"formattedDate",hash:{},data:i}):o))+"</time>\n                    </li>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,n,r,i){var o,s,a=null!=e?e:{},l=n.helperMissing,c="function",u=t.escapeExpression;return'<div class="thumbnail">\n    <div class="card">\n'+(null!=(o=n["if"].call(a,null!=e?e.imageUrl:e,{name:"if",hash:{},fn:t.program(1,i,0),inverse:t.program(3,i,0),data:i}))?o:"")+'        <div class="card-body">\n            <h1 class="title">'+u((s=null!=(s=n.title||(null!=e?e.title:e))?s:l,typeof s===c?s.call(a,{name:"title",hash:{},data:i}):s))+'</h1>\n            <ul class="meta-line">\n                <li class="author">'+u((s=null!=(s=n.author||(null!=e?e.author:e))?s:l,typeof s===c?s.call(a,{name:"author",hash:{},data:i}):s))+"</li>\n"+(null!=(o=n["if"].call(a,null!=e?e.articledate:e,{name:"if",hash:{},fn:t.program(5,i,0),inverse:t.noop,data:i}))?o:"")+"            </ul>\n            <p>"+(null!=(s=null!=(s=n.summary||(null!=e?e.summary:e))?s:l,o=typeof s===c?s.call(a,{name:"summary",hash:{},data:i}):s)?o:"")+'</p>\n        </div>\n        <div class="card-icon">\n            <img src="'+u((s=null!=(s=n.sourceimage||(null!=e?e.sourceimage:e))?s:l,typeof s===c?s.call(a,{name:"sourceimage",hash:{},data:i}):s))+'"></img>\n        </div>\n    </div>\n</div>'},useData:!0})},{"handlebars/runtime":21}],53:[function(t,e,n){var r=t("handlebars/runtime")["default"].template;e.exports=r({compiler:[7,">= 4.0.0"],main:function(t,e,n,r,i){return'<div class="thumbnails viewport">\n    <div class="thumbnails-container"></div>\n</div>\n'},useData:!0})},{"handlebars/runtime":21}]},{},[46])(46)});